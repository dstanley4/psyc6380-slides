<!DOCTYPE html>
<html lang="en"><head>
<script src="reg-cat-part2_files/libs/clipboard/clipboard.min.js"></script>
<script src="reg-cat-part2_files/libs/quarto-html/tabby.min.js"></script>
<script src="reg-cat-part2_files/libs/quarto-html/popper.min.js"></script>
<script src="reg-cat-part2_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="reg-cat-part2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="reg-cat-part2_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="reg-cat-part2_files/libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <title>reg-cat-part2</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reg-cat-part2_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="reg-cat-part2_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="reg-cat-part2_files/libs/revealjs/dist/theme/quarto-a816a3489efb184b8c611a5d7787864b.css">
  <link href="reg-cat-part2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="reg-cat-part2_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="reg-cat-part2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="reg-cat-part2_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="reg-cat-part2_files/libs/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
  <script src="reg-cat-part2_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
  <script src="reg-cat-part2_files/libs/plotly-binding-4.11.0/plotly.js"></script>
  <script src="reg-cat-part2_files/libs/typedarray-0.1/typedarray.min.js"></script>
  <script src="reg-cat-part2_files/libs/jquery-3.5.1/jquery.min.js"></script>
  <link href="reg-cat-part2_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
  <script src="reg-cat-part2_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
  <link href="reg-cat-part2_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
  <script src="reg-cat-part2_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
  <script src="reg-cat-part2_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="reg-cat-part2_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">


<section id="section" class="slide level2" data-background-image="images/ai-image-boardroom-decision-v3.webp" data-background-size="cover">
<h2></h2>
<div class="overlay-text-bottom">
<p><strong>The board meets next week.</strong> Should they approve the new onboarding program?</p>
</div>
</section>
<section id="a-quick-result-to-consider" class="slide level2">
<h2>A Quick Result to Consider</h2>
<p>A company tested a new onboarding program. The CEO is ready to:</p>
<ul>
<li>Roll out the new program to 5,000 employees</li>
<li>Discontinue the old program entirely</li>
<li>Announce the decision at next week‚Äôs board meeting</li>
</ul>
<p>The evidence:</p>
<blockquote>
<p><strong>New program employees scored 13.72 points higher than old program employees.</strong></p>
<p><em>p</em> &lt; .001 (highly significant!)</p>
</blockquote>
<p>Should the board approve this decision? What would you ask before voting yes?</p>
</section>
<section id="section-1" class="slide level2 formula-large">
<h2></h2>
<p><strong>But wait‚Ä¶</strong> Should we trust this result? What questions should we ask before making this decision?</p>
</section>
<section id="part-4-combining-categorical-and-continuous-predictors" class="slide level2 section-header" data-background="linear-gradient(135deg, #880041 0%, #A31753 50%, #B53A66 100%)">
<h2>Part 4: Combining Categorical and Continuous Predictors</h2>
</section>
<section id="overview-categorical-continuous-predictors" class="slide level2">
<h2>Overview: Categorical + Continuous Predictors</h2>
<p><strong>Building on our regression foundation:</strong> We now combine what we‚Äôve learned about categorical predictors with continuous predictors in the same model.</p>
<p>This approach is traditionally called <strong>ANCOVA</strong> (Analysis of Covariance)‚Äîbut it‚Äôs just multiple regression with both predictor types.</p>
<p><strong>When to use this approach:</strong></p>
<ul>
<li>Comparing groups while <strong>controlling for a covariate</strong> (e.g., comparing treatment effects while adjusting for baseline scores)</li>
<li>Evaluating an intervention when groups differ on a <strong>confounding variable</strong> (e.g., program effects adjusted for prior experience)</li>
<li>Testing whether group differences remain after <strong>accounting for individual differences</strong> (e.g., therapy outcomes adjusted for symptom severity)</li>
</ul>
</section>
<section id="section-2" class="slide level2" data-background-image="images/ai-image-4.png" data-background-size="cover">
<h2></h2>
<div class="overlay-text-bottom">
<p><strong>Scenario:</strong> Does the new onboarding program actually work?</p>
</div>
</section>
<section id="the-onboarding-problem" class="slide level2">
<h2>The Onboarding Problem</h2>
<p>A company wants to know if their new onboarding program improves performance.</p>
<p><strong>The complication:</strong> Employees in the new program also have more education.</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Group</th>
<th>Performance</th>
<th>Education</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>New program</td>
<td>Higher</td>
<td>Higher</td>
</tr>
<tr class="even">
<td>Old program</td>
<td>Lower</td>
<td>Lower</td>
</tr>
</tbody>
</table>
<p><strong>The question we need to answer:</strong></p>
<blockquote>
<p>Is performance higher because of the <em>program</em>‚Ä¶ or because of <em>education</em>?</p>
</blockquote>
<blockquote>
<p><strong>What is the effect of the program <em>holding education constant</em>?</strong></p>
</blockquote>
</section>
<section id="we-begin-with-just-program-an-unadjusted-analysis" class="slide level2 content-light">
<h2>We Begin with Just Program: An Unadjusted Analysis</h2>
<p>We will begin by using regression to examine the difference between the programs (old vs new).</p>
<p>After assessing the result of this analysis, we will move on to including education in the analysis (i.e., conducting an Adjusted Analysis).</p>
</section>
<section id="the-onboarding-data" class="slide level2">
<h2>The Onboarding Data</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>onboard_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/onboard_data.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">employee_id</th>
<th style="text-align: left;">program</th>
<th style="text-align: right;">education</th>
<th style="text-align: right;">performance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ivy</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">54.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jack</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">67.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kate</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">65.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ian</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">64.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Julia</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">64.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Keith</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">63.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Laura</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">75.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Miles</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">66.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nadia</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">74.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oliver</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">69.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Luna</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">67.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Max</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">84.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nina</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">78.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Liam</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">90.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Megan</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">70.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Noah</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">81.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leah</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">88.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marcus</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">73.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nora</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">88.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Logan</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">80.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="differences-in-programs" class="slide level2">
<h2>Differences in Programs</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>onboard_data <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href=""></a>  <span class="fu">group_by</span>(program) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href=""></a>  <span class="fu">summarize</span>(</span>
<span id="cb2-4"><a href=""></a>    <span class="at">mean_perf =</span> <span class="fu">mean</span>(performance)</span>
<span id="cb2-5"><a href=""></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">program</th>
<th style="text-align: right;">mean_perf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">new</td>
<td style="text-align: right;">80.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: right;">66.56</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The programs (old vs new) differ by 13.72. We can find this difference using regression.</p>
</section>
<section id="program-only-model-unadjusted" class="slide level2">
<h2>Program-Only Model (Unadjusted)</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>onboard_data <span class="ot">&lt;-</span> onboard_data <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">program =</span> <span class="fu">as.factor</span>(program)) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">program =</span> <span class="fu">fct_relevel</span>(program, <span class="st">"old"</span>))</span>
<span id="cb3-4"><a href=""></a></span>
<span id="cb3-5"><a href=""></a>lm_program_only <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> program, <span class="at">data =</span> onboard_data)</span>
<span id="cb3-6"><a href=""></a><span class="fu">tidy</span>(lm_program_only)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">2.186956</td>
<td style="text-align: right;">30.434993</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">programnew</td>
<td style="text-align: right;">13.72</td>
<td style="text-align: right;">3.092823</td>
<td style="text-align: right;">4.436076</td>
<td style="text-align: right;">0.000319</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <strong>intercept</strong> (66.56) represents the mean performance for employees in the <strong>old program</strong> (the reference group).</p>
<p>The coefficient for <strong>programnew</strong> (13.72) indicates that employees in the new program scored 13.72 points higher than those in the old program. The mean for the new program is 80.28 (66.56 + 13.72)</p>
<p><strong>Based on this unadjusted analysis</strong>, the new program appears very effective!</p>
</section>
<section id="augment-the-unadjusted-onboarding-model" class="slide level2">
<h2>Augment the Unadjusted Onboarding Model</h2>
<p>Make predicted scores for each person/group</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="co"># Create augmented data with predictions and residuals</span></span>
<span id="cb4-2"><a href=""></a>onboard_unadj_augmented <span class="ot">&lt;-</span> <span class="fu">augment</span>(lm_program_only, <span class="at">data =</span> onboard_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell augment">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">employee_id</th>
<th style="text-align: left;">program</th>
<th style="text-align: right;">education</th>
<th style="text-align: right;">performance</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ivy</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">-11.96</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">6.425889</td>
<td style="text-align: right;">0.1846151</td>
<td style="text-align: right;">-1.8229293</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jack</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.112203</td>
<td style="text-align: right;">0.0011404</td>
<td style="text-align: right;">0.1432737</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kate</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">65.7</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">-0.86</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.112864</td>
<td style="text-align: right;">0.0009546</td>
<td style="text-align: right;">-0.1310802</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ian</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">64.4</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">-2.16</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.094803</td>
<td style="text-align: right;">0.0060216</td>
<td style="text-align: right;">-0.3292247</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Julia</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">64.6</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">-1.96</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.098598</td>
<td style="text-align: right;">0.0049581</td>
<td style="text-align: right;">-0.2987409</td>
</tr>
<tr class="even">
<td style="text-align: left;">Keith</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">63.7</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">-2.86</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.078599</td>
<td style="text-align: right;">0.0105569</td>
<td style="text-align: right;">-0.4359179</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Laura</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">75.3</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">8.74</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">6.756369</td>
<td style="text-align: right;">0.0985888</td>
<td style="text-align: right;">1.3321406</td>
</tr>
<tr class="even">
<td style="text-align: left;">Miles</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">66.0</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.114821</td>
<td style="text-align: right;">0.0004047</td>
<td style="text-align: right;">-0.0853545</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nadia</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">74.0</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">7.44</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">6.857353</td>
<td style="text-align: right;">0.0714415</td>
<td style="text-align: right;">1.1339961</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oliver</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">69.8</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.067889</td>
<td style="text-align: right;">0.0135486</td>
<td style="text-align: right;">0.4938370</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Luna</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">67.8</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">-12.48</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">6.360928</td>
<td style="text-align: right;">0.2010175</td>
<td style="text-align: right;">-1.9021871</td>
</tr>
<tr class="even">
<td style="text-align: left;">Max</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">84.2</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.045342</td>
<td style="text-align: right;">0.0198325</td>
<td style="text-align: right;">0.5974818</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nina</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">78.0</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">-2.28</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.092349</td>
<td style="text-align: right;">0.0067093</td>
<td style="text-align: right;">-0.3475149</td>
</tr>
<tr class="even">
<td style="text-align: left;">Liam</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">90.6</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">10.32</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">6.609102</td>
<td style="text-align: right;">0.1374562</td>
<td style="text-align: right;">1.5729624</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Megan</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">70.7</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">-9.58</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">6.681521</td>
<td style="text-align: right;">0.1184502</td>
<td style="text-align: right;">-1.4601725</td>
</tr>
<tr class="even">
<td style="text-align: left;">Noah</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">81.8</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.105644</td>
<td style="text-align: right;">0.0029819</td>
<td style="text-align: right;">0.2316766</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leah</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">88.4</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">8.12</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">6.806742</td>
<td style="text-align: right;">0.0850975</td>
<td style="text-align: right;">1.2376410</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marcus</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">73.0</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">-7.28</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">6.868568</td>
<td style="text-align: right;">0.0684018</td>
<td style="text-align: right;">-1.1096091</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nora</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">88.1</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">7.82</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">6.829662</td>
<td style="text-align: right;">0.0789257</td>
<td style="text-align: right;">1.1919153</td>
</tr>
<tr class="even">
<td style="text-align: left;">Logan</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">80.2</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">7.116232</td>
<td style="text-align: right;">0.0000083</td>
<td style="text-align: right;">-0.0121935</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="visualizing-the-unadjusted-onboarding-model-code" class="slide level2" data-transition="none">
<h2>Visualizing the Unadjusted Onboarding Model: Code</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="co"># Plot data points and predicted values</span></span>
<span id="cb5-2"><a href=""></a><span class="fu">ggplot</span>(onboard_unadj_augmented, <span class="fu">aes</span>(<span class="at">x =</span> program,</span>
<span id="cb5-3"><a href=""></a>                                     <span class="at">y =</span> performance,</span>
<span id="cb5-4"><a href=""></a>                                     <span class="at">color =</span> program,</span>
<span id="cb5-5"><a href=""></a>                                     <span class="at">shape =</span> program)) <span class="sc">+</span></span>
<span id="cb5-6"><a href=""></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href=""></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .fitted, <span class="at">ymax =</span> .fitted),</span>
<span id="cb5-8"><a href=""></a>                <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href=""></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Program"</span>, <span class="at">y =</span> <span class="st">"Performance Rating"</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href=""></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="plot-unadjusted-onboarding-model" class="slide level2" data-transition="none">
<h2>Plot Unadjusted Onboarding Model</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/unadjusted-augment-plot-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Notice the regression line jumps when we move from one group to another - there is a discontinuity.</p></li>
<li><p>The lines show ≈∑ for each group‚Äîthe <strong>programnew</strong> coefficient (13.72) is the difference between them.</p></li>
</ul>
</section>
<section id="need-for-an-adjusted-analysis" class="slide level2">
<h2>Need for an Adjusted Analysis</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>onboard_data <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href=""></a>  <span class="fu">group_by</span>(program) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href=""></a>  <span class="fu">summarize</span>(</span>
<span id="cb6-4"><a href=""></a>    <span class="at">mean_edu =</span> <span class="fu">mean</span>(education),</span>
<span id="cb6-5"><a href=""></a>    <span class="at">mean_perf =</span> <span class="fu">mean</span>(performance)</span>
<span id="cb6-6"><a href=""></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">program</th>
<th style="text-align: right;">mean_edu</th>
<th style="text-align: right;">mean_perf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: right;">14.6</td>
<td style="text-align: right;">66.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">new</td>
<td style="text-align: right;">17.0</td>
<td style="text-align: right;">80.28</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>New-program employees have more education AND higher performance.</li>
<li>Is it the program or the education?</li>
<li>We want to control for education in a new analysis (an <strong>adjusted</strong> analysis).</li>
</ul>
</section>
<section id="prediction-question" class="slide level2 content-minimal">
<h2>Prediction Question</h2>
<p>We just saw the unadjusted effect: 13.72 points.</p>
<blockquote>
<p>‚ÄúWhat do you THINK will happen to the program coefficient when we add education to the model? Will it get bigger, smaller, or stay the same? Why?‚Äù</p>
</blockquote>
<p>üí¨ <strong>Make a prediction in the chat:</strong> Will the coefficient get bigger, smaller, or stay the same? Include your reasoning.</p>
</section>
<section id="design-matrix-visualization" class="slide level2" data-transition="none">
<h2>Design Matrix Visualization</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/matrix-algebra-combined.png" class="quarto-figure quarto-figure-center" style="width:80.0%;height:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>We have a categorical predictor with 2 levels (1 contrast column for program) and a continuous predictor (education). This is an ANCOVA.</p>
</section>
<section id="running-the-combined-model" class="slide level2 size-85">
<h2>Running the Combined Model</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a>lm_combined <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> program <span class="sc">+</span> education, <span class="at">data =</span> onboard_data)</span>
<span id="cb7-2"><a href=""></a><span class="fu">tidy</span>(lm_combined, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">15.541810</td>
<td style="text-align: right;">9.014763</td>
<td style="text-align: right;">1.724040</td>
<td style="text-align: right;">0.1028359</td>
<td style="text-align: right;">-3.4776764</td>
<td style="text-align: right;">34.56130</td>
</tr>
<tr class="even">
<td style="text-align: left;">programnew</td>
<td style="text-align: right;">5.333448</td>
<td style="text-align: right;">2.368914</td>
<td style="text-align: right;">2.251432</td>
<td style="text-align: right;">0.0378754</td>
<td style="text-align: right;">0.3354768</td>
<td style="text-align: right;">10.33142</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education</td>
<td style="text-align: right;">3.494397</td>
<td style="text-align: right;">0.610837</td>
<td style="text-align: right;">5.720669</td>
<td style="text-align: right;">0.0000250</td>
<td style="text-align: right;">2.2056431</td>
<td style="text-align: right;">4.78315</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <strong>intercept</strong> (15.54) represents the predicted performance for employees in the <strong>old program</strong> (the reference group) who have zero years of education.</p>
<p>The coefficient for <strong>education</strong> (3.49) indicates that each additional year of <strong>education</strong> was associated with a 3.49-point increase in performance, <em>holding program constant</em>. That is, for two people in the same program, a one-year difference in education corresponds to a 3.49-point difference in predicted performance.</p>
<p>The coefficient for <strong>programnew</strong> (5.33) indicates that employees in the <strong>new program</strong> scored 5.33 points higher than those in the old program, <em>holding education constant</em>. That is, for two people with the same education level, the difference in predicted performance across the two programs is 5.33.</p>
<div class="fragment">
<p><strong>Notably, the adjusted program effect (5.33) is substantially smaller than the unadjusted effect (13.72) we observed earlier‚Äîmuch of the apparent program benefit was actually due to education differences between groups.</strong></p>
</div>
</section>
<section id="comparing-unadjusted-and-adjusted-models" class="slide level2">
<h2>Comparing Unadjusted and Adjusted Models</h2>
<p><strong>Unadjusted</strong> (program only)</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">2.186956</td>
<td style="text-align: right;">30.434993</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">programnew</td>
<td style="text-align: right;">13.72</td>
<td style="text-align: right;">3.092823</td>
<td style="text-align: right;">4.436076</td>
<td style="text-align: right;">0.000319</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Adjusted</strong> (program + education)</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">15.541810</td>
<td style="text-align: right;">9.014763</td>
<td style="text-align: right;">1.724040</td>
<td style="text-align: right;">0.1028359</td>
</tr>
<tr class="even">
<td style="text-align: left;">programnew</td>
<td style="text-align: right;">5.333448</td>
<td style="text-align: right;">2.368914</td>
<td style="text-align: right;">2.251432</td>
<td style="text-align: right;">0.0378754</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education</td>
<td style="text-align: right;">3.494397</td>
<td style="text-align: right;">0.610837</td>
<td style="text-align: right;">5.720669</td>
<td style="text-align: right;">0.0000250</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="augment-the-adjusted-onboarding-model" class="slide level2">
<h2>Augment the Adjusted Onboarding Model</h2>
<p>Make predicted scores for each person</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="co"># Create augmented data with predictions and residuals</span></span>
<span id="cb8-2"><a href=""></a>onboard_augmented <span class="ot">&lt;-</span> <span class="fu">augment</span>(lm_combined, <span class="at">data =</span> onboard_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell augment">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">employee_id</th>
<th style="text-align: left;">program</th>
<th style="text-align: right;">education</th>
<th style="text-align: right;">performance</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ivy</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">57.47457</td>
<td style="text-align: right;">-2.8745690</td>
<td style="text-align: right;">0.2456897</td>
<td style="text-align: right;">4.208355</td>
<td style="text-align: right;">0.0686977</td>
<td style="text-align: right;">-0.7954508</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jack</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">64.46336</td>
<td style="text-align: right;">3.0366379</td>
<td style="text-align: right;">0.1077586</td>
<td style="text-align: right;">4.212954</td>
<td style="text-align: right;">0.0240316</td>
<td style="text-align: right;">0.7726227</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kate</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">65.7</td>
<td style="text-align: right;">60.96897</td>
<td style="text-align: right;">4.7310345</td>
<td style="text-align: right;">0.1551724</td>
<td style="text-align: right;">4.091338</td>
<td style="text-align: right;">0.0936916</td>
<td style="text-align: right;">1.2370513</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ian</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">64.4</td>
<td style="text-align: right;">71.45216</td>
<td style="text-align: right;">-7.0521552</td>
<td style="text-align: right;">0.1422414</td>
<td style="text-align: right;">3.843326</td>
<td style="text-align: right;">0.1851184</td>
<td style="text-align: right;">-1.8300163</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Julia</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">64.6</td>
<td style="text-align: right;">67.95776</td>
<td style="text-align: right;">-3.3577586</td>
<td style="text-align: right;">0.1034483</td>
<td style="text-align: right;">4.196301</td>
<td style="text-align: right;">0.0279371</td>
<td style="text-align: right;">-0.8522705</td>
</tr>
<tr class="even">
<td style="text-align: left;">Keith</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">63.7</td>
<td style="text-align: right;">64.46336</td>
<td style="text-align: right;">-0.7633621</td>
<td style="text-align: right;">0.1077586</td>
<td style="text-align: right;">4.284167</td>
<td style="text-align: right;">0.0015187</td>
<td style="text-align: right;">-0.1942250</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Laura</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">75.3</td>
<td style="text-align: right;">74.94655</td>
<td style="text-align: right;">0.3534483</td>
<td style="text-align: right;">0.2241379</td>
<td style="text-align: right;">4.287755</td>
<td style="text-align: right;">0.0008956</td>
<td style="text-align: right;">0.0964382</td>
</tr>
<tr class="even">
<td style="text-align: left;">Miles</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">66.0</td>
<td style="text-align: right;">64.46336</td>
<td style="text-align: right;">1.5366379</td>
<td style="text-align: right;">0.1077586</td>
<td style="text-align: right;">4.269603</td>
<td style="text-align: right;">0.0061538</td>
<td style="text-align: right;">0.3909723</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nadia</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">74.0</td>
<td style="text-align: right;">71.45216</td>
<td style="text-align: right;">2.5478448</td>
<td style="text-align: right;">0.1422414</td>
<td style="text-align: right;">4.233428</td>
<td style="text-align: right;">0.0241631</td>
<td style="text-align: right;">0.6611592</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oliver</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">old</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">69.8</td>
<td style="text-align: right;">67.95776</td>
<td style="text-align: right;">1.8422414</td>
<td style="text-align: right;">0.1034483</td>
<td style="text-align: right;">4.261258</td>
<td style="text-align: right;">0.0084096</td>
<td style="text-align: right;">0.4676000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Luna</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">67.8</td>
<td style="text-align: right;">73.29121</td>
<td style="text-align: right;">-5.4912069</td>
<td style="text-align: right;">0.1862069</td>
<td style="text-align: right;">4.009876</td>
<td style="text-align: right;">0.1632350</td>
<td style="text-align: right;">-1.4629398</td>
</tr>
<tr class="even">
<td style="text-align: left;">Max</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">84.2</td>
<td style="text-align: right;">83.77440</td>
<td style="text-align: right;">0.4256034</td>
<td style="text-align: right;">0.1215517</td>
<td style="text-align: right;">4.287426</td>
<td style="text-align: right;">0.0005493</td>
<td style="text-align: right;">0.1091347</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nina</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">78.0</td>
<td style="text-align: right;">76.78560</td>
<td style="text-align: right;">1.2143966</td>
<td style="text-align: right;">0.1215517</td>
<td style="text-align: right;">4.276679</td>
<td style="text-align: right;">0.0044726</td>
<td style="text-align: right;">0.3113996</td>
</tr>
<tr class="even">
<td style="text-align: left;">Liam</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">90.6</td>
<td style="text-align: right;">90.76319</td>
<td style="text-align: right;">-0.1631897</td>
<td style="text-align: right;">0.2939655</td>
<td style="text-align: right;">4.288654</td>
<td style="text-align: right;">0.0003024</td>
<td style="text-align: right;">-0.0466762</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Megan</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">70.7</td>
<td style="text-align: right;">80.28000</td>
<td style="text-align: right;">-9.5800000</td>
<td style="text-align: right;">0.1000000</td>
<td style="text-align: right;">3.467210</td>
<td style="text-align: right;">0.2181504</td>
<td style="text-align: right;">-2.4269448</td>
</tr>
<tr class="even">
<td style="text-align: left;">Noah</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">81.8</td>
<td style="text-align: right;">76.78560</td>
<td style="text-align: right;">5.0143966</td>
<td style="text-align: right;">0.1215517</td>
<td style="text-align: right;">4.075039</td>
<td style="text-align: right;">0.0762564</td>
<td style="text-align: right;">1.2858083</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leah</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">88.4</td>
<td style="text-align: right;">87.26879</td>
<td style="text-align: right;">1.1312069</td>
<td style="text-align: right;">0.1862069</td>
<td style="text-align: right;">4.277456</td>
<td style="text-align: right;">0.0069273</td>
<td style="text-align: right;">0.3013705</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marcus</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">73.0</td>
<td style="text-align: right;">73.29121</td>
<td style="text-align: right;">-0.2912069</td>
<td style="text-align: right;">0.1862069</td>
<td style="text-align: right;">4.288169</td>
<td style="text-align: right;">0.0004591</td>
<td style="text-align: right;">-0.0775819</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nora</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">88.1</td>
<td style="text-align: right;">83.77440</td>
<td style="text-align: right;">4.3256034</td>
<td style="text-align: right;">0.1215517</td>
<td style="text-align: right;">4.130819</td>
<td style="text-align: right;">0.0567456</td>
<td style="text-align: right;">1.1091857</td>
</tr>
<tr class="even">
<td style="text-align: left;">Logan</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">new</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">80.2</td>
<td style="text-align: right;">76.78560</td>
<td style="text-align: right;">3.4143966</td>
<td style="text-align: right;">0.1215517</td>
<td style="text-align: right;">4.191116</td>
<td style="text-align: right;">0.0353563</td>
<td style="text-align: right;">0.8755310</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="visualizing-the-adjusted-onboarding-model-code" class="slide level2" data-transition="none">
<h2>Visualizing the Adjusted Onboarding Model: Code</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="co"># Plot data points and predicted values (parallel lines)</span></span>
<span id="cb9-2"><a href=""></a><span class="fu">ggplot</span>(onboard_augmented, <span class="fu">aes</span>(<span class="at">x =</span> education,</span>
<span id="cb9-3"><a href=""></a>                               <span class="at">y =</span> performance,</span>
<span id="cb9-4"><a href=""></a>                               <span class="at">color =</span> program,</span>
<span id="cb9-5"><a href=""></a>                               <span class="at">shape =</span> program)) <span class="sc">+</span></span>
<span id="cb9-6"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href=""></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Performance Rating"</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href=""></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="plot-adjusted-onboarding-model" class="slide level2" data-transition="none">
<h2>Plot Adjusted Onboarding Model</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/combined-augment-plot-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The parallel lines show ≈∑ for each program‚Äîthe <strong>programnew</strong> coefficient (5.33) is the vertical gap between them.</p></li>
<li><p>When we compare the height difference between the two lines we are comparing predicted performance at a <strong>common level of education</strong> (e.g., two ‚Äúpeople‚Äù with same education). <strong>This is a critical point.</strong></p></li>
</ul>
</section>
<section id="plot-adjusted-onboarding-model-3d" class="slide level2" data-transition="none">
<h2>Plot Adjusted Onboarding Model (3D)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-08e9a741825a8ddde2a0" style="width:768px;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-08e9a741825a8ddde2a0">{"x":{"visdat":{"85c13239923":["function () ","plotlyVisDat"],"85c1161aca71":["function () ","data"],"85c138e0cc0d":["function () ","data"],"85c12e7486a7":["function () ","data"],"85c1643455c4":["function () ","data"]},"cur_data":"85c1643455c4","attrs":{"85c1161aca71":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","marker":{"size":6,"color":"#F8766D"},"name":"old","inherit":true},"85c138e0cc0d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"lines","line":{"width":4,"color":"#F8766D"},"showlegend":false,"inherit":true},"85c12e7486a7":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","marker":{"size":6,"color":"#00BFC4","symbol":"diamond"},"name":"new","inherit":true},"85c1643455c4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"lines","line":{"width":4,"color":"#00BFC4"},"showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Education"},"yaxis":{"title":"Program","tickvals":[0,1],"ticktext":["old","new"]},"zaxis":{"title":"Performance"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[12,13,14,14,14,15,15,16,16,17],"y":[0,0,0,0,0,0,0,0,0,0],"z":[54.600000000000001,65.700000000000003,67.5,63.700000000000003,66,64.599999999999994,69.799999999999997,64.400000000000006,74,75.299999999999997],"type":"scatter3d","mode":"markers","marker":{"color":"#F8766D","size":6,"line":{"color":"rgba(31,119,180,1)"}},"name":"old","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[12,13,14,14,14,15,15,16,16,17],"y":[0,0,0,0,0,0,0,0,0,0],"z":[57.47456896551725,60.968965517241386,64.463362068965523,64.463362068965523,64.463362068965523,67.95775862068966,67.95775862068966,71.452155172413796,71.452155172413796,74.946551724137933],"type":"scatter3d","mode":"lines","line":{"color":"#F8766D","width":4},"showlegend":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[15,15,16,16,16,17,18,18,19,20],"y":[1,1,1,1,1,1,1,1,1,1],"z":[67.799999999999997,73,78,81.799999999999997,80.200000000000003,70.700000000000003,84.200000000000003,88.099999999999994,88.400000000000006,90.599999999999994],"type":"scatter3d","mode":"markers","marker":{"color":"#00BFC4","size":6,"symbol":"diamond","line":{"color":"rgba(44,160,44,1)"}},"name":"new","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[15,15,16,16,16,17,18,18,19,20],"y":[1,1,1,1,1,1,1,1,1,1],"z":[73.291206896551728,73.291206896551728,76.785603448275864,76.785603448275864,76.785603448275864,80.280000000000001,83.774396551724138,83.774396551724138,87.268793103448274,90.763189655172411],"type":"scatter3d","mode":"lines","line":{"color":"#00BFC4","width":4},"showlegend":false,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The two parallel lines from the 2D plot are now shown in 3D space, where the y-axis represents the categorical program variable.</p>
</section>
<section id="compare-the-two-models" class="slide level2 content-light">
<h2>Compare the Two Models</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Program Coefficient</th>
<th style="text-align: left;">What it means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Program only</td>
<td style="text-align: right;">13.72</td>
<td style="text-align: left;">Raw difference in group means</td>
</tr>
<tr class="even">
<td style="text-align: left;">Program + Education</td>
<td style="text-align: right;">5.33</td>
<td style="text-align: left;">Difference holding education constant</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="the-coefficient-dropped" class="slide level2" data-transition="none">
<h2>The Coefficient Dropped!</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/coefficient-change-visual-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Most of the apparent program effect may have been due to education differences between the groups.</p>
<p><strong>Why did it drop?</strong> The unadjusted coefficient (13.72) included BOTH the program effect AND the education difference between groups. When we account for education (by including it as a predictor), we‚Äôre left with ONLY the program effect (5.33). The ‚Äúmissing‚Äù 8.39 points were confounded with education differences between the groups‚Äîwe can‚Äôt attribute them to the program alone.</p>
</section>
<section id="quick-check-the-coefficient-drop" class="slide level2 content-light">
<h2>Quick Check: The Coefficient Drop</h2>
<p>We just saw the program coefficient drop from 13.72 to 5.33.</p>
<p><strong>Zoom reactions:</strong> - üëç if this result surprises you - ü§î if you predicted something like this would happen</p>
<p>üí¨ <strong>Chat:</strong> In ONE sentence, explain to a friend why the coefficient got smaller when we added education.</p>
</section>
<section id="why-coefficients-change-summary" class="slide level2 content-light">
<h2>‚úì Why Coefficients Change: Summary</h2>
<table class="caption-top">
<colgroup>
<col style="width: 20%">
<col style="width: 42%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Analysis</th>
<th>Program Coefficient</th>
<th>What It Captures</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Unadjusted</strong> (program only)</td>
<td>13.72</td>
<td>Program effect + Education effect (mixed together)</td>
</tr>
<tr class="even">
<td><strong>Adjusted</strong> (program + education)</td>
<td>5.33</td>
<td>Program effect ONLY (education removed)</td>
</tr>
</tbody>
</table>
<p>The difference (13.72 ‚àí 5.33 = 8.39 points) was due to education, not the program.</p>
</section>
<section id="where-did-the-8.39-points-go" class="slide level2 content-light" data-transition="none">
<h2>Where Did the 8.39 Points Go?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/coefficient-decomposition-1.png" class="quarto-figure quarto-figure-center" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="prediction-what-do-you-expect-to-see" class="slide level2 content-light">
<h2>Prediction: What Do You Expect to See?</h2>
<p>We‚Äôre about to see a Venn diagram showing how Program, Education, and Performance relate to each other.</p>
<blockquote>
<p><strong>Make a prediction:</strong> Given what we‚Äôve learned about confounding, what do you expect the diagram to show about the relationship between Program and Education?</p>
</blockquote>
<p>üí¨ <strong>Chat:</strong> Do you think Program and Education will:</p>
<ul>
<li><ol type="A">
<li>Have a lot of overlap (highly related)</li>
</ol></li>
<li><ol start="2" type="A">
<li>Have some overlap (moderately related)</li>
</ol></li>
<li><ol start="3" type="A">
<li>Have no overlap (unrelated)</li>
</ol></li>
</ul>
<p><em>Think about WHY before you answer!</em></p>
</section>
<section id="the-venn-diagram-intuition" class="slide level2" data-transition="none">
<h2>The Venn Diagram Intuition</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/venn-diagram-intuition-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="smaller" style="font-size: 0.75em;">
<p><strong>Key insight:</strong> Program and Education OVERLAP in what they explain about Performance.</p>
<ul>
<li><strong>Unique regions:</strong> Each predictor‚Äôs adjusted coefficient reflects only the variance it explains that the other predictor cannot.</li>
<li><strong>Ambiguous region:</strong> The overlap is variance that <em>either</em> predictor could explain‚Äîwe cannot attribute it to one or the other.</li>
<li><strong>The unadjusted coefficient was inflated:</strong> When education was omitted from the model, program‚Äôs coefficient captured both its unique effect AND variance from the ambiguous region. Adding education removes that confounded portion from program‚Äôs coefficient.</li>
</ul>
</div>
</section>
<section id="limitations-of-the-venn-diagram-metaphor" class="slide level2">
<h2>Limitations of the Venn Diagram Metaphor</h2>
<p>The Venn diagram is a useful teaching tool, but it oversimplifies variance partitioning.</p>
<p><strong>The ‚Äúshared‚Äù variance can be negative</strong></p>
<p>If we calculate the overlap as:</p>
<p><span class="math display">\[\text{Shared} = R^2 - sr_1^2 - sr_2^2\]</span></p>
<p>This value becomes negative when <strong>suppressor effects</strong> occur‚Äîwhen the unique contributions sum to <em>more</em> than <span class="math inline">\(R^2\)</span>. This happens when predictors enhance each other‚Äôs predictive power rather than redundantly explaining the same variance.</p>
<p>A negative area makes no sense in a Venn diagram!</p>
<p><strong>Even when positive, ‚Äúshared‚Äù is a misnomer</strong></p>
<p>The overlap doesn‚Äôt truly ‚Äúbelong‚Äù to both predictors. It‚Äôs better described as <strong>ambiguous variance</strong>‚Äîvariance we simply cannot attribute to either predictor uniquely.</p>
<p>The Venn diagram implies the overlap is a real, identifiable quantity. In reality, it‚Äôs just the leftover from a mathematical decomposition.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Bottom Line</strong></p>
</div>
<div class="callout-content">
<p>Venn diagrams illustrate <em>unique</em> variance well, but treat the ‚Äúshared‚Äù region with caution‚Äîit‚Äôs not a meaningful quantity we can interpret or assign.</p>
</div>
</div>
</div>
</section>
<section id="key-interpretation-skill" class="slide level2 content-minimal">
<h2>üéØ Key Interpretation Skill</h2>
<p>Correctly interpreting regression coefficients is <strong>the single most important interpretation skill</strong> in multiple regression.</p>
<p>If someone asks ‚ÄúWhat does this coefficient mean?‚Äù‚Äîyou need to be able to answer it.</p>
<p>On the regression output slide you saw previously ‚ÄúRunning the Combined Model‚Äù we provided correct interpretations.</p>
</section>
<section id="the-critical-interpretation-change" class="slide level2 content-light">
<h2>The Critical Interpretation Change</h2>
<p>When we have multiple predictors, each coefficient has a new meaning:</p>
<blockquote>
<p>‚ÄúThe expected change in Y for a one-unit increase in X, <strong>holding all other predictors constant</strong>‚Äù</p>
</blockquote>
<p>When we have a continuous variable, the one-unit increase in X is fairly easy to understand.</p>
<p>When we have categorical predictors (i.e., contrast columns) it is the same principle. Each contrast column has 0 or 1 so a one-unit increase refers to moving from the reference group to the contrast group.</p>
</section>
<section id="the-critical-interpretation-change-example" class="slide level2 content-light">
<h2>The Critical Interpretation Change: Example</h2>
<p>The coefficient for <strong>education</strong> (3.49) indicates that each additional year of <strong>education</strong> was associated with a 3.49-point increase in performance, <em>holding program constant</em>. That is, for two people in the same program, a one-year difference in education corresponds to a 3.49-point difference in predicted performance.</p>
<p>The coefficient for <strong>programnew</strong> (5.33) indicates that employees in the <strong>new program</strong> scored 5.33 points higher than those in the old program, <em>holding education constant</em>. That is, for two people with the same education level, the difference in predicted performance across the two programs is 5.33.</p>
</section>
<section id="what-the-adjusted-coefficient-means" class="slide level2 content-light">
<h2>What the Adjusted Coefficient Means</h2>
<blockquote>
<p>‚ÄúThe adjusted coefficient answers: <strong>If we compare two employees with the SAME education level, how much higher would we expect the new-program employee‚Äôs performance to be?</strong>‚Äù</p>
</blockquote>
<p>Alternative phrasings:</p>
<ul>
<li>‚ÄúComparing employees with identical education‚Ä¶‚Äù</li>
<li>‚ÄúAmong people with equal educational backgrounds‚Ä¶‚Äù</li>
<li>‚ÄúAfter accounting for education differences‚Ä¶‚Äù</li>
</ul>
</section>
<section id="coefficient-interpretation-cheat-sheet" class="slide level2">
<h2>Coefficient Interpretation Cheat Sheet</h2>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 54%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Analysis Type</th>
<th>What the Coefficient Represents</th>
<th>Key Phrase</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Unadjusted</strong> (one predictor)</td>
<td>Raw difference between group means</td>
<td>‚ÄúThe difference in means‚Ä¶‚Äù</td>
</tr>
<tr class="even">
<td><strong>Adjusted</strong> (multiple predictors)</td>
<td>Difference between groups <strong>at the same level of the covariate</strong></td>
<td>‚ÄúHolding X constant‚Ä¶‚Äù or ‚ÄúFor people with the same X‚Ä¶‚Äù</td>
</tr>
</tbody>
</table>
<p><strong>Decision Guide:</strong></p>
<pre><code>Do groups differ on another variable that predicts the outcome?
    ‚îÇ
    ‚îú‚îÄ‚ñ∫ YES ‚Üí Report BOTH unadjusted AND adjusted
    ‚îÇ         (adjusted is usually more meaningful)
    ‚îÇ
    ‚îî‚îÄ‚ñ∫ NO ‚Üí Unadjusted comparison is appropriate
             (but consider what you might be missing!)</code></pre>
</section>
<section id="quick-check" class="slide level2 content-light">
<h2>Quick Check</h2>
<blockquote>
<p><strong>Before moving on:</strong> Why might comparing ‚Äúraw‚Äù group means be misleading when groups differ on another variable?</p>
</blockquote>
<p>üí¨ <strong>Chat:</strong> Give an example from everyday life where comparing raw averages would be misleading.</p>
<p>This is the heart of why ‚Äúholding constant‚Äù matters.</p>
</section>
<section id="everyday-analogy-holding-constant" class="slide level2 content-light">
<h2>Everyday Analogy: Holding Constant</h2>
<p><strong>‚ÄúHolding constant‚Äù is like making a fair comparison.</strong></p>
<p>Imagine comparing two cars‚Äô fuel efficiency. If Car A drives at 60 mph and Car B drives at 30 mph, any difference in fuel use might be about speed, not the cars themselves.</p>
<p>To make a fair comparison, we‚Äôd test both cars <strong>at the same speed</strong>‚Äîwe ‚Äúhold speed constant.‚Äù</p>
<p>That‚Äôs exactly what we do with education: compare employees <strong>at the same education level</strong> to isolate the program effect.</p>
</section>
<section id="more-holding-constant-examples" class="slide level2 content-light">
<h2>More ‚ÄúHolding Constant‚Äù Examples</h2>
<p><strong>You already think this way in everyday life:</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="header">
<th>Unfair comparison</th>
<th>Fair comparison (‚Äúholding constant‚Äù)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>‚ÄúPrivate schools have better test scores‚Äù</td>
<td>‚ÄúPrivate schools have better scores <em>among students with similar family income</em>‚Äù</td>
</tr>
<tr class="even">
<td>‚ÄúDrug A works better than Drug B‚Äù</td>
<td>‚ÄúDrug A works better <em>for patients with the same severity</em>‚Äù</td>
</tr>
</tbody>
</table>
<p>The phrase ‚Äúholding constant‚Äù just means: <strong>‚Äúcomparing apples to apples.‚Äù</strong></p>
</section>
<section id="common-misconception-are-we-comparing-identical-people" class="slide level2 content-light">
<h2>Common Misconception: Are We Comparing Identical People?</h2>
<blockquote>
<p><strong>Student question:</strong> ‚ÄúWhen we ‚Äòhold education constant,‚Äô are we literally comparing people with exactly the same education?‚Äù</p>
</blockquote>
<p><strong>Answer:</strong> Not exactly. We‚Äôre using statistics to <em>estimate</em> what the comparison would look like if we could compare people with the same education.</p>
</section>
<section id="common-misconception-are-we-comparing-identical-people-continued" class="slide level2 content-light">
<h2>Common Misconception: Are We Comparing Identical People? (continued)</h2>
<p>Think of it this way:</p>
<ul>
<li>We don‚Äôt have two employees with <em>identical</em> backgrounds</li>
<li>It‚Äôs a mathematical adjustment, not a literal matching</li>
<li>But the regression <em>estimates</em> the program difference as if we did</li>
<li>We are reporting the difference in the elevation of the two parts of the regression line (new vs old program). That is, the difference in the regression estimates.</li>
</ul>
<p><strong>Analogy:</strong> Weather forecasters don‚Äôt actually travel to the future‚Äîthey use models to <em>estimate</em> tomorrow‚Äôs temperature. Similarly, we use regression to <em>estimate</em> fair comparisons.</p>
</section>
<section id="comparing-ian-and-nina" class="slide level2 content-minimal">
<h2>Comparing Ian and Nina</h2>
<p>To see what ‚Äúholding education constant‚Äù means, let‚Äôs compare two employees with the <strong>same education</strong> (16 years): <strong>Ian</strong> (old program) and <strong>Nina</strong> (new program).</p>
<div title="These Are Real Data Points">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>These Are Real Data Points</strong></p>
</div>
<div class="callout-content">
<p>Ian and Nina are actual employees from our dataset‚Äînot hypothetical examples. Ian really has 16 years of education with a performance score of 64.4. Nina really has 16 years of education with a performance score of 78. This makes their comparison concrete: two real people with identical education levels but different programs.</p>
</div>
</div>
</div>
</div>
</section>
<section id="ians-calculation-old-program" class="slide level2 content-light">
<h2>Ian‚Äôs Calculation (Old Program)</h2>
<p>Ian‚Äôs row: Int = 1, program = 0, education = 16</p>
<table class="caption-top">
<colgroup>
<col style="width: 24%">
<col style="width: 44%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>What we do</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Write the equation</td>
<td>≈∑ = 15.54(Int) + 5.33(program) + 3.49(education)</td>
</tr>
<tr class="even">
<td>2</td>
<td>Plug in Ian‚Äôs values</td>
<td>≈∑ = 15.54(1) + 5.33(0) + 3.49(16)</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Calculate</td>
<td>15.54 + 0 + 55.84 = 71.38</td>
</tr>
</tbody>
</table>
<p><strong>Ian‚Äôs predicted performance is 71.38</strong></p>
</section>
<section id="ninas-calculation-new-program" class="slide level2 content-light">
<h2>Nina‚Äôs Calculation (New Program)</h2>
<p>Nina‚Äôs row: Int = 1, program = 1, education = 16</p>
<table class="caption-top">
<colgroup>
<col style="width: 24%">
<col style="width: 44%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>What we do</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Write the equation</td>
<td>≈∑ = 15.54(Int) + 5.33(program) + 3.49(education)</td>
</tr>
<tr class="even">
<td>2</td>
<td>Plug in Nina‚Äôs values</td>
<td>≈∑ = 15.54(1) + 5.33(1) + 3.49(16)</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Calculate</td>
<td>15.54 + 5.33 + 55.84 = 76.71</td>
</tr>
</tbody>
</table>
<p><strong>Nina‚Äôs predicted performance is 76.71</strong></p>
</section>
<section id="the-key-comparison" class="slide level2 content-light">
<h2>The Key Comparison</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Person</th>
<th>Program</th>
<th>Education</th>
<th>≈∑</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ian</td>
<td>old (0)</td>
<td>16</td>
<td>71.38</td>
</tr>
<tr class="even">
<td>Nina</td>
<td>new (1)</td>
<td>16</td>
<td>76.71</td>
</tr>
<tr class="odd">
<td><strong>Difference</strong></td>
<td></td>
<td></td>
<td><strong>5.33</strong></td>
</tr>
</tbody>
</table>
<p>Ian and Nina have the <strong>SAME education</strong> (16 years). The difference in their predictions (76.71 - 71.38 = <strong>5.33</strong>) is exactly the program coefficient!</p>
<p><strong>This is what ‚Äúholding education constant‚Äù means.</strong></p>
</section>
<section id="what-holding-constant-means-summary" class="slide level2 content-light">
<h2>‚úì What ‚ÄúHolding Constant‚Äù Means: Summary</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Concept</th>
<th>Example from Ian &amp; Nina</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Same covariate value</td>
<td>Both have 16 years education</td>
</tr>
<tr class="even">
<td>Different group</td>
<td>Ian = old program, Nina = new program</td>
</tr>
<tr class="odd">
<td>Predicted difference</td>
<td>76.71 - 71.38 = 5.33 points</td>
</tr>
<tr class="even">
<td>This equals‚Ä¶</td>
<td>The program coefficient!</td>
</tr>
</tbody>
</table>
<p><strong>Key insight:</strong> The coefficient answers ‚Äúwhat if we could compare people who are identical except for group membership?‚Äù</p>
<p><strong>We typically won‚Äôt have two people like Ian and Nina where we can make this comparison. We need to base the comparison on the difference in the regression lines as reflected in the regression coefficient.</strong></p>
</section>
<section id="polling-question-4-holding-constant" class="slide level2 content-light">
<h2>Polling Question 4: Holding Constant</h2>
<p>This is the key concept. Take your time.</p>
<blockquote>
<p>The unadjusted program coefficient was 13.72. After adding education, it dropped to 5.33. What does 5.33 represent?</p>
</blockquote>
<ul>
<li><ol type="A">
<li>The difference between program means, ignoring education</li>
</ol></li>
<li><ol start="2" type="A">
<li>The expected program difference for employees with the SAME education level</li>
</ol></li>
<li><ol start="3" type="A">
<li>The average education difference between groups</li>
</ol></li>
<li><ol start="4" type="A">
<li>The correlation between program and education</li>
</ol></li>
</ul>
</section>
<section id="polling-question-4-answer" class="slide level2 content-light">
<h2>Polling Question 4: Answer</h2>
<p><strong>Correct answer: B) The expected program difference for employees with the SAME education level</strong></p>
<p>This is ‚Äúholding constant‚Äù in action:</p>
<ul>
<li><strong>A is wrong:</strong> That‚Äôs what the <em>unadjusted</em> coefficient (13.72) represents</li>
<li><strong>B is correct:</strong> The adjusted coefficient (5.33) compares employees with equal education</li>
<li><strong>C is wrong:</strong> That‚Äôs a descriptive statistic, not a regression coefficient</li>
<li><strong>D is wrong:</strong> Correlation is a separate statistic (and would be between 0 and 1)</li>
</ul>
</section>
<section id="additional-statistics-onboarding-models-1" class="slide level2">
<h2>Additional Statistics: Onboarding Models 1</h2>
<p><strong>R¬≤ from glance() for both models:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="fu">glance</span>(lm_program_only)  <span class="co"># Unadjusted model</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5222774</td>
<td style="text-align: right;">0.4957373</td>
<td style="text-align: right;">6.915763</td>
<td style="text-align: right;">19.67877</td>
<td style="text-align: right;">0.000319</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-66.00123</td>
<td style="text-align: right;">138.0025</td>
<td style="text-align: right;">140.9897</td>
<td style="text-align: right;">860.9</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">glance</span>(lm_combined)      <span class="co"># Adjusted model</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.8366795</td>
<td style="text-align: right;">0.8174653</td>
<td style="text-align: right;">4.160872</td>
<td style="text-align: right;">43.54491</td>
<td style="text-align: right;">0.0000002</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-55.26807</td>
<td style="text-align: right;">118.5361</td>
<td style="text-align: right;">122.5191</td>
<td style="text-align: right;">294.3185</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="additional-statistics-onboarding-models-2" class="slide level2">
<h2>Additional Statistics: Onboarding Models 2</h2>
<p><strong>95% Confidence Intervals for R¬≤ using MBESS Unadjusted:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">library</span>(MBESS)</span>
<span id="cb13-2"><a href=""></a></span>
<span id="cb13-3"><a href=""></a><span class="co"># For unadjusted model: df.1 = number of predictors, df.2 = residual df</span></span>
<span id="cb13-4"><a href=""></a><span class="fu">ci.R2</span>(<span class="at">R2 =</span> <span class="fu">glance</span>(lm_program_only)<span class="sc">$</span>r.squared,</span>
<span id="cb13-5"><a href=""></a>      <span class="at">df.1 =</span> <span class="dv">1</span>,   <span class="co"># 1 predictor (program)</span></span>
<span id="cb13-6"><a href=""></a>      <span class="at">df.2 =</span> <span class="fu">glance</span>(lm_program_only)<span class="sc">$</span>df.residual,</span>
<span id="cb13-7"><a href=""></a>      <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb13-8"><a href=""></a>      <span class="at">Random.Predictors =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Lower.Conf.Limit.R2
[1] 0.1617987

$Prob.Less.Lower
[1] 0.025

$Upper.Conf.Limit.R2
[1] 0.6997411

$Prob.Greater.Upper
[1] 0.025</code></pre>
</div>
</div>
</section>
<section id="additional-statistics-onboarding-models-3" class="slide level2">
<h2>Additional Statistics: Onboarding Models 3</h2>
<p><strong>95% Confidence Intervals for R¬≤ using MBESS Combined:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="co"># For adjusted model: 2 predictors (program + education)</span></span>
<span id="cb15-2"><a href=""></a><span class="fu">ci.R2</span>(<span class="at">R2 =</span> <span class="fu">glance</span>(lm_combined)<span class="sc">$</span>r.squared,</span>
<span id="cb15-3"><a href=""></a>      <span class="at">df.1 =</span> <span class="dv">2</span>,   <span class="co"># 2 predictors</span></span>
<span id="cb15-4"><a href=""></a>      <span class="at">df.2 =</span> <span class="fu">glance</span>(lm_combined)<span class="sc">$</span>df.residual,</span>
<span id="cb15-5"><a href=""></a>      <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb15-6"><a href=""></a>      <span class="at">Random.Predictors =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Lower.Conf.Limit.R2
[1] 0.604957

$Prob.Less.Lower
[1] 0.025

$Upper.Conf.Limit.R2
[1] 0.893118

$Prob.Greater.Upper
[1] 0.025</code></pre>
</div>
</div>
</section>
<section id="additional-statistics-onboarding-models-4" class="slide level2">
<h2>Additional Statistics: Onboarding Models 4</h2>
<p><strong>Cohen‚Äôs d for unadjusted comparison:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="fu">library</span>(effsize)</span>
<span id="cb17-2"><a href=""></a><span class="fu">cohen.d</span>(performance <span class="sc">~</span> program, <span class="at">data =</span> onboard_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cohen's d

d estimate: -1.983874 (large)
95 percent confidence interval:
     lower      upper 
-3.1315116 -0.8362358 </code></pre>
</div>
</div>
</section>
<section id="additional-statistics-onboarding-models-5" class="slide level2 smaller">
<h2>Additional Statistics: Onboarding Models 5</h2>
<p><strong>Partial Eta Squared for both models:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="fu">library</span>(effectsize)</span>
<span id="cb19-2"><a href=""></a><span class="co"># Unadjusted model (program only)</span></span>
<span id="cb19-3"><a href=""></a><span class="fu">eta_squared</span>(lm_program_only, <span class="at">partial =</span> <span class="cn">TRUE</span>, <span class="at">ci =</span> <span class="fl">0.90</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Eta2 |       90% CI
-------------------------------
program   | 0.52 | [0.30, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="co"># Adjusted model (program + education)</span></span>
<span id="cb21-2"><a href=""></a><span class="fu">eta_squared</span>(lm_combined, <span class="at">partial =</span> <span class="cn">TRUE</span>, <span class="at">ci =</span> <span class="fl">0.90</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter | Eta2 (partial) |       90% CI
-----------------------------------------
program   |           0.76 | [0.62, 1.00]
education |           0.66 | [0.47, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<div title="Warning: Effect Sizes in Adjusted Models">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning: Effect Sizes in Adjusted Models</strong></p>
</div>
<div class="callout-content">
<p><strong>Be careful:</strong> The Cohen‚Äôs <em>d</em> calculated here is based on <strong>raw</strong> group means. It reflects the <strong>unadjusted</strong> difference.</p>
<p>You cannot simply report this <em>d</em> alongside your adjusted coefficient (<span class="math inline">\(b\)</span>) because they answer different questions. For adjusted analyses, you should report <strong>Partial Eta Squared</strong> (<span class="math inline">\(\eta^2_p\)</span>) or explicitly state that the <span class="math inline">\(d\)</span> applies only to the raw difference.</p>
</div>
</div>
</div>
</div>
</section>
<section id="additional-statistics-onboarding-models-6" class="slide level2 smaller">
<h2>Additional Statistics: Onboarding Models 6</h2>
<p><strong>Descriptive Statistics by Program:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a>onboard_data <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href=""></a>  <span class="fu">group_by</span>(program) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href=""></a>  <span class="fu">summarize</span>(<span class="at">mean_performance =</span> <span class="fu">mean</span>(performance),</span>
<span id="cb23-4"><a href=""></a>            <span class="at">sd_performance =</span> <span class="fu">sd</span>(performance),</span>
<span id="cb23-5"><a href=""></a>            <span class="at">mean_education =</span> <span class="fu">mean</span>(education),</span>
<span id="cb23-6"><a href=""></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">program</th>
<th style="text-align: right;">mean_performance</th>
<th style="text-align: right;">sd_performance</th>
<th style="text-align: right;">mean_education</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: right;">66.56</td>
<td style="text-align: right;">5.810948</td>
<td style="text-align: right;">14.6</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">new</td>
<td style="text-align: right;">80.28</td>
<td style="text-align: right;">7.866921</td>
<td style="text-align: right;">17.0</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="results-paragraph-onboarding-1" class="slide level2 results-paragraph">
<h2>Results Paragraph: Onboarding 1</h2>
<p>We examined whether the new onboarding program improved performance ratings compared to the old program (<em>N</em> = 20; old program <em>n</em> = 10, new program <em>n</em> = 10). We conducted two analyses: an unadjusted analysis comparing programs directly, and an adjusted analysis accounting for employees‚Äô education levels.</p>
</section>
<section id="results-paragraph-onboarding-2" class="slide level2 results-paragraph">
<h2>Results Paragraph: Onboarding 2</h2>
<p><strong>The Confound: Education</strong></p>
<p>Before interpreting the program comparison, we must consider a potential confound. New-program employees had substantially more education (<em>M</em> = 17 years) compared to old-program employees (<em>M</em> = 14.6 years). Because education likely improves job performance‚Äîand more educated employees were concentrated in the new program‚Äîany direct comparison of performance would be biased in favor of the new program.</p>
</section>
<section id="results-paragraph-onboarding-3" class="slide level2 results-paragraph">
<h2>Results Paragraph: Onboarding 3</h2>
<p><strong>Unadjusted Analysis</strong></p>
<p>We first compared programs without controlling for education. The regression coefficient (<em>b</em>) represents the difference in mean performance between new-program and old-program employees (the reference group). Old-program employees had a mean performance of 66.56 (<em>SD</em> = 5.81), while new-program employees had a mean of 80.28 (<em>SD</em> = 7.87).</p>
<p>The coefficient for program was <em>b</em> = 13.72, 95% CI [7.22, 20.22], <em>p</em> &lt; .001, indicating that new-program employees scored 13.72 points higher than old-program employees, <em>d</em> = 1.98, <span class="math inline">\(\eta^2_p\)</span> = 0.52, 90% CI [0.9, 0.3]; see Table 1. The model explained 52.2% of variance in performance, <em>R</em>¬≤ = 0.52, 95% CI [0.16, 0.7].</p>
<p>Based on this unadjusted analysis alone, we would conclude that the new program substantially improves performance.</p>
</section>
<section id="results-paragraph-onboarding-4" class="slide level2 results-paragraph">
<h2>Results Paragraph: Onboarding 4</h2>
<p><strong>Adjusted Analysis</strong></p>
<p>To account for the confound, we added education to the model. In this adjusted analysis, the coefficient for program represents the difference in mean performance between new-program and old-program employees <em>who have the same education level</em>.</p>
<p>After controlling for education, the coefficient for program was <em>b</em> = 5.33, 95% CI [0.34, 10.33], <em>p</em> = .038, <span class="math inline">\(\eta^2_p\)</span> = 0.76, 90% CI [0.9, 0.62]; see Table 2. This indicates that new-program employees scored only 5.33 points higher than old-program employees <em>who had the same education level</em>. The adjusted model explained 83.7% of variance, <em>R</em>¬≤ = 0.84, 95% CI [0.6, 0.89].</p>
</section>
<section id="results-paragraph-onboarding-5" class="slide level2 results-paragraph">
<h2>Results Paragraph: Onboarding 5</h2>
<p><strong>Comparing Unadjusted and Adjusted Analyses</strong></p>
<p>The unadjusted and adjusted analyses tell different stories about the magnitude of the program effect. In the unadjusted analysis, the program coefficient was <em>b</em> = 13.72, 95% CI [7.22, 20.22], suggesting a substantial performance advantage. After adjusting for education, the coefficient dropped to <em>b</em> = 5.33, 95% CI [0.34, 10.33]‚Äîa reduction of 8.39 points.</p>
<p>This reduction occurred because new-program employees had substantially more education (17 vs.&nbsp;14.6 years). The unadjusted comparison confounded the program effect with the education effect. When we statistically held education constant, the estimated program effect was considerably smaller. In terms of effect size, the program accounted for <span class="math inline">\(\eta^2_p\)</span> = 0.76, 90% CI [0.9, 0.62], of the variance in performance after controlling for education.</p>
</section>
<section id="results-paragraph-onboarding-6" class="slide level2 results-paragraph">
<h2>Results Paragraph: Onboarding 6</h2>
<p><strong>Conclusion.</strong> After controlling for education, the new program was still associated with higher performance (<em>b</em> = 5.33 points), but much of its apparent advantage in the unadjusted analysis can be accounted for by education differences between groups. Because employees were not randomly assigned to programs, other unmeasured differences between groups may also influence these estimates.</p>
</section>
<section id="polling-question-5" class="slide level2 content-light">
<h2>Polling Question 5</h2>
<p>This tests whether you understand ‚Äúholding constant.‚Äù</p>
<blockquote>
<p>In the model <code>performance ~ program + education</code>, the education coefficient is 3.49. What does this mean?</p>
</blockquote>
<ul>
<li><ol type="A">
<li>Education has no effect on performance</li>
</ol></li>
<li><ol start="2" type="A">
<li>For each additional year of education, performance is expected to increase by 3.49 points, holding program constant</li>
</ol></li>
<li><ol start="3" type="A">
<li>The mean education is 3.49 years</li>
</ol></li>
<li><ol start="4" type="A">
<li>Program explains 3.49% of the variance</li>
</ol></li>
</ul>
</section>
<section id="polling-question-5-answer" class="slide level2 content-light">
<h2>Polling Question 5: Answer</h2>
<p><strong>Correct answer: B) For each additional year of education, performance is expected to increase by 3.49 points, holding program constant</strong></p>
<p>‚ÄúHolding constant‚Äù applies to ALL coefficients in multiple regression:</p>
<ul>
<li>The education coefficient (3.49) = expected change in performance for +1 year of education, <strong>comparing people in the same program</strong></li>
<li>The program coefficient (5.33) = expected program difference, <strong>comparing people with the same education</strong></li>
</ul>
<p>Every coefficient is interpreted ‚Äúholding all other predictors constant.‚Äù</p>
</section>
<section id="part-5-centering" class="slide level2 section-header" data-background="linear-gradient(135deg, #742E00 0%, #8E3F00 50%, #A25400 100%)" data-transition="none">
<h2>Part 5: Centering</h2>
</section>
<section id="making-the-intercept-meaningful" class="slide level2 content-light">
<h2>Making the Intercept Meaningful</h2>
<p>The intercept (15.5) represents predicted performance for the <strong>reference group</strong> (old program) when education = 0 years. But nobody has 0 years of education!</p>
<p><strong>Solution: Grand Mean center the continuous predictor</strong> by subtracting the mean. This shifts the ‚Äúzero point‚Äù to a meaningful value. We say it is grand mean centering when we subtract the mean for the entire data set.</p>
</section>
<section id="grand-mean-centering-a-visual-explanation" class="slide level2" data-transition="none">
<h2>Grand Mean Centering: A Visual Explanation</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/centering-number-line-1.png" class="quarto-figure quarto-figure-center" width="864"></p>
</figure>
</div>
</div>
</div>
<p>After centering, the intercept = predicted performance for the <strong>reference group</strong> (old program) at <strong>grand mean</strong> education (15.8 years‚Äîa realistic person!)</p>
</section>
<section id="grand-mean-centering-a-visual-animation" class="slide level2" data-transition="none">
<h2>Grand Mean Centering: A Visual Animation</h2>
<style>
  #center-anim-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 65vh;
    width: 100%;
  }

  #center-anim-container {
    width: 100%;
    max-width: 1920px;
    aspect-ratio: 1920 / 360;
    padding: 0;
    margin: 0 auto;
  }

  #center-anim-container svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  .ca-title {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
    transition: fill 2s ease-in-out;
  }

  .ca-axis-label {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
  }

  .ca-tick-label {
    font-size: 24px;
    font-weight: bold;
    text-anchor: middle;
  }

  .ca-annotation {
    font-size: 36px;
    font-weight: bold;
    text-anchor: middle;
  }

  .ca-mean-label {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
  }

  .ca-hidden {
    opacity: 0;
    pointer-events: none;
  }

  .ca-fade-in {
    transition: opacity 0.5s ease-in-out;
  }

  .ca-data-point {
    transition: cx 2s ease-in-out, fill 2s ease-in-out;
  }

  .ca-mean-marker {
    transition: cx 2s ease-in-out, fill 2s ease-in-out;
  }
</style>
<div id="center-anim-wrapper">
<div id="center-anim-container">

</div>
</div>
<div class="fragment" data-fragment-index="1">

</div>
<div class="fragment" data-fragment-index="2">

</div>
<div class="fragment" data-fragment-index="3">

</div>
<div class="fragment" data-fragment-index="4">

</div>
<div class="fragment" data-fragment-index="5">

</div>
<div class="fragment" data-fragment-index="6">

</div>
<div class="fragment" data-fragment-index="7">

</div>
<div class="fragment" data-fragment-index="8">

</div>
<div class="fragment" data-fragment-index="9">

</div>
<script>
(function() {
  var eduVals = [12, 14, 13, 16, 15, 14, 17, 14, 16, 15,
                 15, 18, 16, 20, 17, 16, 19, 15, 18, 16];
  var actualMean = 15.8;
  var jitterOffsets = [
     0.1244418130,  0.1311226240, -0.0641581396,  0.0991342878,  0.0425236557,
     0.0057287847,  0.0709764944, -0.1096000208,  0.0470976871,  0.0615194352,
    -0.0126774671,  0.0657336755,  0.1304016741, -0.0733713527, -0.0113121532,
     0.1320043568,  0.1434679285, -0.1147537915, -0.0075008755,  0.0180998239
  ];

  var svgWidth = 1920, svgHeight = 360;
  var marginLeft = 100, marginRight = 100;
  var axisY = 230, pointBaseY = 150, jitterScale = 250;
  var axisMin = -6, axisMax = 22, axisRange = axisMax - axisMin;

  function valueToX(val) {
    return marginLeft + (val - axisMin) * ((svgWidth - marginLeft - marginRight) / axisRange);
  }

  var svgNS = "http://www.w3.org/2000/svg";
  var svg = null;

  function createLine(x1, y1, x2, y2, stroke, strokeWidth, id) {
    var line = document.createElementNS(svgNS, 'line');
    line.setAttribute('x1', x1); line.setAttribute('y1', y1);
    line.setAttribute('x2', x2); line.setAttribute('y2', y2);
    line.setAttribute('stroke', stroke || '#333');
    line.setAttribute('stroke-width', strokeWidth || 2);
    if (id) line.setAttribute('id', id);
    return line;
  }

  function createText(x, y, text, className, fill, id) {
    var textEl = document.createElementNS(svgNS, 'text');
    textEl.setAttribute('x', x); textEl.setAttribute('y', y);
    textEl.setAttribute('fill', fill || '#333');
    if (className) textEl.setAttribute('class', className);
    if (id) textEl.setAttribute('id', id);
    textEl.textContent = text;
    return textEl;
  }

  function createCircle(cx, cy, r, fill, className, id) {
    var circle = document.createElementNS(svgNS, 'circle');
    circle.setAttribute('cx', cx); circle.setAttribute('cy', cy);
    circle.setAttribute('r', r); circle.setAttribute('fill', fill);
    if (className) circle.setAttribute('class', className);
    if (id) circle.setAttribute('id', id);
    return circle;
  }

  function createRect(x, y, width, height, fill, rx, id) {
    var rect = document.createElementNS(svgNS, 'rect');
    rect.setAttribute('x', x); rect.setAttribute('y', y);
    rect.setAttribute('width', width); rect.setAttribute('height', height);
    rect.setAttribute('fill', fill); rect.setAttribute('rx', rx || 0);
    if (id) rect.setAttribute('id', id);
    return rect;
  }

  function createGroup(id, className) {
    var g = document.createElementNS(svgNS, 'g');
    if (id) g.setAttribute('id', id);
    if (className) g.setAttribute('class', className);
    return g;
  }

  function buildSVG() {
    var container = document.getElementById('center-anim-container');
    if (!container) {
      console.error('Animation container not found');
      return false;
    }

    svg = document.createElementNS(svgNS, 'svg');
    svg.setAttribute('viewBox', '0 0 1920 360');
    svg.setAttribute('id', 'center-anim-svg');
    container.appendChild(svg);

    var bgRect = createRect(40, 10, svgWidth - 80, svgHeight - 20, 'rgba(0, 0, 0, 0.70)', 20, 'ca-bg-rect');
    bgRect.setAttribute('class', 'ca-hidden ca-fade-in');
    svg.appendChild(bgRect);

    var axisGroup = createGroup('ca-axis-group', 'ca-hidden ca-fade-in');
    axisGroup.appendChild(createLine(valueToX(axisMin), axisY, valueToX(axisMax), axisY, '#ffffff', 3));
    for (var val = axisMin; val <= axisMax; val += 2) {
      var x = valueToX(val);
      axisGroup.appendChild(createLine(x, axisY - 8, x, axisY + 8, '#ffffff', 2));
      axisGroup.appendChild(createText(x, axisY + 30, val.toString(), 'ca-tick-label', '#ffffff'));
    }
    var axisLabel = createText(svgWidth / 2, axisY + 85, 'Years of Education', 'ca-axis-label', '#ffffff');
    axisLabel.setAttribute('id', 'ca-axis-label');
    axisGroup.appendChild(axisLabel);
    svg.appendChild(axisGroup);

    var title = createText(valueToX(actualMean), 40, 'ORIGINAL SCALE', 'ca-title ca-hidden ca-fade-in', '#ffffff');
    title.setAttribute('id', 'ca-main-title');
    svg.appendChild(title);

    var pointsGroup = createGroup('ca-points-group', 'ca-hidden ca-fade-in');
    for (var i = 0; i < eduVals.length; i++) {
      var px = valueToX(eduVals[i]);
      var py = pointBaseY + jitterOffsets[i] * jitterScale;
      pointsGroup.appendChild(createCircle(px, py, 10, '#ff4d4d', 'ca-data-point', 'ca-point-' + i));
    }
    svg.appendChild(pointsGroup);

    var meanX = valueToX(actualMean);
    var meanMarker = createCircle(meanX, axisY, 14, '#ff4d4d', 'ca-mean-marker ca-hidden ca-fade-in', 'ca-mean-marker');
    svg.appendChild(meanMarker);

    var meanLabel = createText(meanX, axisY + 70, 'Mean (15.8)', 'ca-mean-label ca-hidden ca-fade-in', '#ff4d4d');
    meanLabel.setAttribute('id', 'ca-mean-label');
    svg.appendChild(meanLabel);

    var annotationGroup = createGroup('ca-annotation-group', 'ca-hidden ca-fade-in');
    annotationGroup.appendChild(createText(svgWidth / 2, 75, 'To center: subtract the mean from each value', 'ca-annotation', '#ffffff'));
    var formulaText = createText(svgWidth / 2, 120, 'x - 15.8', 'ca-annotation', '#ff4d4d');
    formulaText.setAttribute('id', 'ca-formula-text');
    annotationGroup.appendChild(formulaText);
    svg.appendChild(annotationGroup);

    var centeredAxisLabel = createText(svgWidth / 2, axisY + 85, 'Deviation from Mean', 'ca-axis-label ca-hidden ca-fade-in', '#5cb8ff');
    centeredAxisLabel.setAttribute('id', 'ca-centered-axis-label');
    svg.appendChild(centeredAxisLabel);

    var zeroLabel = createText(valueToX(0), 70, 'The mean is now ZERO!', 'ca-mean-label ca-hidden ca-fade-in', '#5cb8ff');
    zeroLabel.setAttribute('id', 'ca-zero-label');
    svg.appendChild(zeroLabel);

    var zeroLine = createLine(valueToX(0), 85, valueToX(0), axisY + 10, '#5cb8ff', 2, 'ca-zero-line');
    zeroLine.setAttribute('class', 'ca-hidden ca-fade-in');
    zeroLine.setAttribute('stroke-dasharray', '5,5');
    svg.appendChild(zeroLine);

    var calloutGroup = createGroup('ca-callout-group', 'ca-hidden ca-fade-in');
    calloutGroup.appendChild(createText(svgWidth * 0.72, 55, 'Same people, same relative distances -', 'ca-annotation', '#5cb8ff'));
    calloutGroup.appendChild(createText(svgWidth * 0.72, 100, 'just a different zero point!', 'ca-annotation', '#5cb8ff'));
    svg.appendChild(calloutGroup);

    console.log('Animation SVG built successfully');
    return true;
  }

  function showEl(id) {
    var el = document.getElementById(id);
    if (el) el.classList.remove('ca-hidden');
  }

  function hideEl(id) {
    var el = document.getElementById(id);
    if (el) el.classList.add('ca-hidden');
  }

  function resetAnimation() {
    console.log('Resetting animation to initial state');

    // Hide all elements
    hideEl('ca-bg-rect');
    hideEl('ca-axis-group');
    hideEl('ca-main-title');
    hideEl('ca-points-group');
    hideEl('ca-mean-marker');
    hideEl('ca-mean-label');
    hideEl('ca-annotation-group');
    hideEl('ca-centered-axis-label');
    hideEl('ca-zero-label');
    hideEl('ca-zero-line');
    hideEl('ca-callout-group');

    // Show original axis label (it gets hidden during animation)
    showEl('ca-axis-label');

    // Reset title to original state
    var titleEl = document.getElementById('ca-main-title');
    if (titleEl) {
      titleEl.textContent = 'ORIGINAL SCALE';
      titleEl.setAttribute('fill', '#ffffff');
      titleEl.setAttribute('x', valueToX(actualMean));
    }

    // Reset data points to original positions and color
    for (var i = 0; i < eduVals.length; i++) {
      var point = document.getElementById('ca-point-' + i);
      if (point) {
        point.setAttribute('cx', valueToX(eduVals[i]));
        point.setAttribute('fill', '#ff4d4d');
      }
    }

    // Reset mean marker to original position and color
    var meanMarkerEl = document.getElementById('ca-mean-marker');
    if (meanMarkerEl) {
      meanMarkerEl.setAttribute('cx', valueToX(actualMean));
      meanMarkerEl.setAttribute('fill', '#ff4d4d');
    }

    // Reset mean label to original state
    var meanLabelEl = document.getElementById('ca-mean-label');
    if (meanLabelEl) {
      meanLabelEl.setAttribute('x', valueToX(actualMean));
      meanLabelEl.setAttribute('fill', '#ff4d4d');
      meanLabelEl.textContent = 'Mean (15.8)';
    }

    // Reset formula text color
    var formulaTextEl = document.getElementById('ca-formula-text');
    if (formulaTextEl) {
      formulaTextEl.setAttribute('fill', '#ff4d4d');
    }
  }

  function renderFrame(frame) {
    console.log('Rendering frame:', frame);
    switch (frame) {
      case 1:
        showEl('ca-bg-rect');
        showEl('ca-axis-group');
        break;
      case 2:
        showEl('ca-main-title');
        showEl('ca-points-group');
        break;
      case 3:
        showEl('ca-mean-marker');
        showEl('ca-mean-label');
        break;
      case 4:
        showEl('ca-annotation-group');
        break;
      case 5:
        var titleEl = document.getElementById('ca-main-title');
        if (titleEl) {
          titleEl.textContent = 'CENTERED SCALE';
          titleEl.setAttribute('fill', '#5cb8ff');
          titleEl.setAttribute('x', valueToX(0));
        }
        for (var i = 0; i < eduVals.length; i++) {
          var point = document.getElementById('ca-point-' + i);
          if (point) {
            point.setAttribute('cx', valueToX(eduVals[i] - actualMean));
            point.setAttribute('fill', '#5cb8ff');
          }
        }
        var meanMarkerEl = document.getElementById('ca-mean-marker');
        if (meanMarkerEl) {
          meanMarkerEl.setAttribute('cx', valueToX(0));
          meanMarkerEl.setAttribute('fill', '#5cb8ff');
        }
        var meanLabelEl = document.getElementById('ca-mean-label');
        if (meanLabelEl) {
          meanLabelEl.setAttribute('x', valueToX(0));
          meanLabelEl.setAttribute('fill', '#5cb8ff');
          meanLabelEl.textContent = 'Mean = 0';
        }
        var formulaTextEl = document.getElementById('ca-formula-text');
        if (formulaTextEl) {
          formulaTextEl.setAttribute('fill', '#5cb8ff');
        }
        break;
      case 6:
        hideEl('ca-axis-label');
        showEl('ca-centered-axis-label');
        hideEl('ca-annotation-group');
        break;
      case 7:
        showEl('ca-zero-label');
        showEl('ca-zero-line');
        hideEl('ca-mean-label');
        break;
      case 8:
        showEl('ca-callout-group');
        break;
      case 9:
        hideEl('ca-bg-rect');
        hideEl('ca-axis-group');
        hideEl('ca-main-title');
        hideEl('ca-points-group');
        hideEl('ca-mean-marker');
        hideEl('ca-mean-label');
        hideEl('ca-centered-axis-label');
        hideEl('ca-zero-label');
        hideEl('ca-zero-line');
        hideEl('ca-callout-group');
        break;
    }
  }

  function init() {
    console.log('Initializing centering animation...');

    if (!buildSVG()) {
      console.error('Failed to build SVG');
      return;
    }

    if (typeof Reveal !== 'undefined') {
      console.log('Reveal.js detected, attaching fragment listener');
      Reveal.on('fragmentshown', function(event) {
        var idx = event.fragment.getAttribute('data-fragment-index');
        console.log('Fragment shown, index:', idx);
        if (idx) renderFrame(parseInt(idx));
      });

      // Reset animation when entering this slide
      Reveal.on('slidechanged', function(event) {
        // Check if we're entering the animation slide
        var slideId = event.currentSlide.getAttribute('id');
        if (slideId === 'grand-mean-centering-a-visual-animation') {
          console.log('Entering animation slide, resetting...');
          resetAnimation();
        }
      });
    } else {
      console.warn('Reveal.js not found');
    }
  }

  // Initialize when Reveal is ready
  if (typeof Reveal !== 'undefined' && Reveal.isReady && Reveal.isReady()) {
    init();
  } else if (typeof Reveal !== 'undefined') {
    Reveal.on('ready', init);
  } else {
    // Fallback: wait for DOM and try again
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        if (typeof Reveal !== 'undefined') {
          if (Reveal.isReady && Reveal.isReady()) {
            init();
          } else {
            Reveal.on('ready', init);
          }
        }
      }, 100);
    });
  }
})();
</script>
</section>
<section id="uncentered-model-plot" class="slide level2 content-light" data-transition="none">
<h2>Uncentered Model: Plot</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/uncentered-plot-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Intercept interpretation:</strong> Expected performance for the <strong>old program</strong> (reference group) when education = 0 years (not meaningful!)</p>
</section>
<section id="grand-mean-centered-model-plot" class="slide level2 content-light" data-transition="none">
<h2>Grand Mean Centered Model: Plot</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/centered-plot-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Intercept interpretation:</strong> Expected performance for the <strong>old program</strong> (reference group) at the overall sample‚Äôs mean education level (15.8 years)‚Äîa realistic, interpretable value!</p>
</section>
<section id="grand-mean-centered-scatter-animation" class="slide level2" data-transition="none">
<h2>Grand Mean Centered Scatter Animation</h2>
<style>
  #gmc-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 75vh;
    width: 100%;
  }

  #gmc-container {
    width: 100%;
    max-width: 1920px;
    aspect-ratio: 1920 / 1080;
    padding: 0;
    margin: 0 auto;
  }

  #gmc-container svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  .gmc-title {
    font-size: 36px;
    font-weight: bold;
    text-anchor: middle;
    transition: fill 2s ease-in-out;
  }

  .gmc-axis-label {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
  }

  .gmc-axis-label-y {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
  }

  .gmc-tick-label {
    font-size: 20px;
    text-anchor: middle;
  }

  .gmc-annotation {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
  }

  .gmc-zero-label {
    font-size: 22px;
    font-style: italic;
    text-anchor: start;
  }

  .gmc-bracket-label {
    font-size: 22px;
    font-weight: bold;
    text-anchor: middle;
  }

  .gmc-legend-text {
    font-size: 22px;
    text-anchor: start;
  }

  .gmc-legend-title {
    font-size: 22px;
    font-weight: bold;
    text-anchor: start;
  }

  .gmc-hidden {
    opacity: 0;
    pointer-events: none;
  }

  .gmc-fade-in {
    transition: opacity 0.5s ease-in-out;
  }

  .gmc-data-point {
    transition: cx 2s ease-in-out;
  }

  .gmc-data-triangle {
    transition: transform 2s ease-in-out;
  }

  .gmc-reg-line {
    transition: d 2s ease-in-out;
  }

  #gmc-bracket-group {
    transition: transform 2s ease-in-out;
  }

  #gmc-reg-lines-group {
    transition: transform 2s ease-in-out;
  }

  .gmc-zero-line-group {
    transition: opacity 0.5s ease-in-out;
  }
</style>
<div id="gmc-wrapper">
<div id="gmc-container">

</div>
</div>
<div class="fragment" data-fragment-index="1">

</div>
<div class="fragment" data-fragment-index="2">

</div>
<div class="fragment" data-fragment-index="3">

</div>
<div class="fragment" data-fragment-index="4">

</div>
<div class="fragment" data-fragment-index="5">

</div>
<div class="fragment" data-fragment-index="6">

</div>
<div class="fragment" data-fragment-index="7">

</div>
<div class="fragment" data-fragment-index="8">

</div>
<div class="fragment" data-fragment-index="9">

</div>
<script>
(function() {
  // ============================================
  // DATA (exact values from R)
  // ============================================
  // Old Program (coral #F8766D, circles)
  var oldEdu = [12, 14, 13, 16, 15, 14, 17, 14, 16, 15];
  var oldPerf = [54.6, 67.5, 65.7, 64.4, 64.6, 63.7, 75.3, 66.0, 74.0, 69.8];

  // New Program (teal #00BFC4, triangles)
  var newEdu = [15, 18, 16, 20, 17, 16, 19, 15, 18, 16];
  var newPerf = [67.8, 84.2, 78.0, 90.6, 70.7, 81.8, 88.4, 73.0, 88.1, 80.2];

  var grandMeanEdu = 15.8;

  // Coefficient values from R:
  // lm(performance ~ program + education) and lm(performance ~ program + education_c)
  // both give programnew = 5.33 (grand mean centering doesn't change the program coefficient)
  var programCoef = 5.33;

  // Regression parameters from R: lm(performance ~ program + education)
  // Intercept = 15.5418, programnew = 5.3334, slope = 3.4944
  // At grand mean (15.8): y_old = 15.5418 + 3.4944 * 15.8 = 70.753
  var slope = 3.4944;
  var interceptOld = 15.5418;
  var interceptNew = interceptOld + programCoef;

  // Colors
  var coralColor = '#F8766D';
  var tealColor = '#00BFC4';
  var zeroLineColor = '#00FFFF';

  // ============================================
  // SVG COORDINATE MAPPING (1920x1080)
  // ============================================
  var svgWidth = 1920;
  var svgHeight = 1080;
  var marginLeft = 150;
  var marginRight = 200;
  var marginTop = 100;
  var marginBottom = 120;

  var plotWidth = svgWidth - marginLeft - marginRight;
  var plotHeight = svgHeight - marginTop - marginBottom;

  // Data ranges - must match the y-axis tick labels (50, 60, 70, 80, 90)
  var xMin = -5;
  var xMax = 20;
  var yMin = 50;
  var yMax = 90;

  // No offset - coordinate system matches axis labels directly
  var yDataOffset = 0;

  function xToSvg(val) {
    return marginLeft + ((val - xMin) / (xMax - xMin)) * plotWidth;
  }

  function yToSvg(val) {
    return marginTop + ((yMax - val) / (yMax - yMin)) * plotHeight;
  }

  // ============================================
  // SVG ELEMENT CREATION HELPERS
  // ============================================
  var svgNS = "http://www.w3.org/2000/svg";
  var svg = null;

  function createLine(x1, y1, x2, y2, stroke, strokeWidth, id) {
    var line = document.createElementNS(svgNS, 'line');
    line.setAttribute('x1', x1);
    line.setAttribute('y1', y1);
    line.setAttribute('x2', x2);
    line.setAttribute('y2', y2);
    line.setAttribute('stroke', stroke || '#333');
    line.setAttribute('stroke-width', strokeWidth || 2);
    if (id) line.setAttribute('id', id);
    return line;
  }

  function createText(x, y, text, className, fill, id) {
    var textEl = document.createElementNS(svgNS, 'text');
    textEl.setAttribute('x', x);
    textEl.setAttribute('y', y);
    textEl.setAttribute('fill', fill || '#333');
    if (className) textEl.setAttribute('class', className);
    if (id) textEl.setAttribute('id', id);
    textEl.textContent = text;
    return textEl;
  }

  function createCircle(cx, cy, r, fill, className, id) {
    var circle = document.createElementNS(svgNS, 'circle');
    circle.setAttribute('cx', cx);
    circle.setAttribute('cy', cy);
    circle.setAttribute('r', r);
    circle.setAttribute('fill', fill);
    if (className) circle.setAttribute('class', className);
    if (id) circle.setAttribute('id', id);
    return circle;
  }

  function createPolygon(points, fill, className, id) {
    var polygon = document.createElementNS(svgNS, 'polygon');
    polygon.setAttribute('points', points);
    polygon.setAttribute('fill', fill);
    if (className) polygon.setAttribute('class', className);
    if (id) polygon.setAttribute('id', id);
    return polygon;
  }

  function createRect(x, y, width, height, fill, rx, id) {
    var rect = document.createElementNS(svgNS, 'rect');
    rect.setAttribute('x', x);
    rect.setAttribute('y', y);
    rect.setAttribute('width', width);
    rect.setAttribute('height', height);
    rect.setAttribute('fill', fill);
    rect.setAttribute('rx', rx || 0);
    if (id) rect.setAttribute('id', id);
    return rect;
  }

  function createGroup(id, className) {
    var g = document.createElementNS(svgNS, 'g');
    if (id) g.setAttribute('id', id);
    if (className) g.setAttribute('class', className);
    return g;
  }

  function trianglePoints(cx, cy, size) {
    size = size || 10;
    var h = size * Math.sqrt(3) / 2;
    return cx + ',' + (cy - h) + ' ' + (cx - size) + ',' + (cy + h) + ' ' + (cx + size) + ',' + (cy + h);
  }

  // ============================================
  // BUILD SVG ELEMENTS
  // ============================================
  function buildSVG() {
    var container = document.getElementById('gmc-container');
    if (!container) {
      console.error('GMC animation container not found');
      return false;
    }

    // Create SVG dynamically
    svg = document.createElementNS(svgNS, 'svg');
    svg.setAttribute('viewBox', '0 0 1920 1080');
    svg.setAttribute('id', 'gmc-svg');
    container.appendChild(svg);

    // Background rounded rectangle
    var bgRect = createRect(40, 20, svgWidth - 80, svgHeight - 40, 'rgba(0, 0, 0, 0.75)', 20, 'gmc-bg-rect');
    bgRect.setAttribute('class', 'gmc-hidden gmc-fade-in');
    svg.appendChild(bgRect);

    // Title
    var title = createText(svgWidth / 2, 70, 'Grand Mean Centering', 'gmc-title gmc-hidden gmc-fade-in', '#ffffff', 'gmc-main-title');
    svg.appendChild(title);

    // Axes group
    var axisGroup = createGroup('gmc-axis-group', 'gmc-hidden gmc-fade-in');

    // X-axis line
    axisGroup.appendChild(createLine(xToSvg(xMin), yToSvg(yMin), xToSvg(xMax), yToSvg(yMin), '#ffffff', 2));

    // Y-axis line
    axisGroup.appendChild(createLine(xToSvg(xMin), yToSvg(yMin), xToSvg(xMin), yToSvg(yMax), '#ffffff', 2));

    // X-axis ticks and labels
    for (var val = -5; val <= 20; val += 5) {
      var x = xToSvg(val);
      axisGroup.appendChild(createLine(x, yToSvg(yMin), x, yToSvg(yMin) + 8, '#ffffff', 2));
      var label = createText(x, yToSvg(yMin) + 30, val.toString(), 'gmc-tick-label', '#ffffff');
      axisGroup.appendChild(label);
    }

    // Y-axis ticks and labels
    for (var val = 50; val <= 90; val += 10) {
      var y = yToSvg(val);
      axisGroup.appendChild(createLine(xToSvg(xMin) - 8, y, xToSvg(xMin), y, '#ffffff', 2));
      var label = createText(xToSvg(xMin) - 40, y + 6, val.toString(), 'gmc-tick-label', '#ffffff');
      label.setAttribute('text-anchor', 'end');
      axisGroup.appendChild(label);
    }

    // X-axis label
    var xAxisLabel = createText(svgWidth / 2, yToSvg(yMin) + 80, 'Years of Education (Uncentered)', 'gmc-axis-label', '#ffffff', 'gmc-x-axis-label');
    axisGroup.appendChild(xAxisLabel);

    // Y-axis label (rotated)
    var yAxisLabel = createText(0, 0, 'Performance Rating', 'gmc-axis-label-y', '#ffffff');
    yAxisLabel.setAttribute('transform', 'translate(60, ' + (svgHeight / 2) + ') rotate(-90)');
    axisGroup.appendChild(yAxisLabel);

    svg.appendChild(axisGroup);

    // Grid lines
    var gridGroup = createGroup('gmc-grid-group', 'gmc-hidden gmc-fade-in');
    for (var val = -5; val <= 20; val += 5) {
      if (val !== xMin) {
        var line = createLine(xToSvg(val), yToSvg(yMin), xToSvg(val), yToSvg(yMax), 'rgba(255,255,255,0.15)', 1);
        gridGroup.appendChild(line);
      }
    }
    for (var val = 60; val <= 90; val += 10) {
      var line = createLine(xToSvg(xMin), yToSvg(val), xToSvg(xMax), yToSvg(val), 'rgba(255,255,255,0.15)', 1);
      gridGroup.appendChild(line);
    }
    svg.appendChild(gridGroup);

    // Regression lines group
    var regLinesGroup = createGroup('gmc-reg-lines-group', 'gmc-hidden gmc-fade-in');

    var oldLineX1 = 12, oldLineX2 = 17;
    var oldLineY1 = interceptOld + slope * oldLineX1 + yDataOffset;
    var oldLineY2 = interceptOld + slope * oldLineX2 + yDataOffset;

    var newLineX1 = 15, newLineX2 = 20;
    var newLineY1 = interceptNew + slope * newLineX1 + yDataOffset;
    var newLineY2 = interceptNew + slope * newLineX2 + yDataOffset;

    var oldRegLine = createLine(xToSvg(oldLineX1), yToSvg(oldLineY1), xToSvg(oldLineX2), yToSvg(oldLineY2), coralColor, 3, 'gmc-old-reg-line');
    oldRegLine.setAttribute('class', 'gmc-reg-line');
    regLinesGroup.appendChild(oldRegLine);

    var newRegLine = createLine(xToSvg(newLineX1), yToSvg(newLineY1), xToSvg(newLineX2), yToSvg(newLineY2), tealColor, 3, 'gmc-new-reg-line');
    newRegLine.setAttribute('class', 'gmc-reg-line');
    regLinesGroup.appendChild(newRegLine);

    svg.appendChild(regLinesGroup);

    // Data points group
    var pointsGroup = createGroup('gmc-points-group', 'gmc-hidden gmc-fade-in');

    // Old Program points (circles)
    for (var i = 0; i < oldEdu.length; i++) {
      var x = xToSvg(oldEdu[i]);
      var y = yToSvg(oldPerf[i] + yDataOffset);
      var circle = createCircle(x, y, 10, coralColor, 'gmc-data-point', 'gmc-old-point-' + i);
      pointsGroup.appendChild(circle);
    }

    // New Program points (triangles)
    for (var i = 0; i < newEdu.length; i++) {
      var x = xToSvg(newEdu[i]);
      var y = yToSvg(newPerf[i] + yDataOffset);
      var triangle = createPolygon(trianglePoints(x, y, 10), tealColor, 'gmc-data-triangle', 'gmc-new-point-' + i);
      triangle.setAttribute('data-orig-x', x);
      triangle.setAttribute('data-y', y);
      pointsGroup.appendChild(triangle);
    }

    svg.appendChild(pointsGroup);

    // Legend
    var legendGroup = createGroup('gmc-legend-group', 'gmc-hidden gmc-fade-in');
    var legendX = svgWidth - 280;
    var legendY = 700;

    legendGroup.appendChild(createText(legendX, legendY, 'program', 'gmc-legend-title', '#ffffff'));
    legendGroup.appendChild(createCircle(legendX + 10, legendY + 35, 8, coralColor));
    legendGroup.appendChild(createText(legendX + 30, legendY + 40, 'Old Program', 'gmc-legend-text', '#ffffff'));
    legendGroup.appendChild(createPolygon(trianglePoints(legendX + 10, legendY + 65, 8), tealColor));
    legendGroup.appendChild(createText(legendX + 30, legendY + 70, 'New Program', 'gmc-legend-text', '#ffffff'));

    svg.appendChild(legendGroup);

    // Starting label
    var startLabel = createText(svgWidth / 2, 120, 'UNCENTERED: Intercept = performance when education = 0', 'gmc-annotation gmc-hidden gmc-fade-in', '#ffffff', 'gmc-start-label');
    startLabel.setAttribute('font-size', '28px');
    svg.appendChild(startLabel);

    // Cyan zero line group (initial)
    var grayZeroGroup = createGroup('gmc-gray-zero-group', 'gmc-hidden gmc-fade-in');
    var zeroX = xToSvg(0);
    var zeroLine = createLine(zeroX, yToSvg(yMax), zeroX, yToSvg(yMin), zeroLineColor, 3);
    zeroLine.setAttribute('stroke-dasharray', '8,4');
    grayZeroGroup.appendChild(zeroLine);

    var zeroLabel = createText(zeroX + 8, yToSvg(90), 'Zero', 'gmc-zero-label', zeroLineColor);
    grayZeroGroup.appendChild(zeroLabel);
    var zeroLabel2 = createText(zeroX + 8, yToSvg(90) + 20, '(unrealistic)', 'gmc-zero-label', zeroLineColor);
    grayZeroGroup.appendChild(zeroLabel2);

    svg.appendChild(grayZeroGroup);

    // Bracket annotation group
    var bracketGroup = createGroup('gmc-bracket-group', 'gmc-hidden gmc-fade-in');

    var bracketX = 16;
    var bracketSvgX = xToSvg(bracketX);
    // Use exact intercept values for bracket endpoints
    var yOldLine = 70.753;
    var yNewLine = 70.753 + 5.33;

    var bracketTopY = yToSvg(yNewLine);
    var bracketBottomY = yToSvg(yOldLine);

    var bracketColor = '#ffff00';
    var bracketWidth = 4;

    bracketGroup.appendChild(createLine(bracketSvgX, bracketTopY, bracketSvgX, bracketBottomY, bracketColor, bracketWidth));

    var capLength = 12;
    bracketGroup.appendChild(createLine(bracketSvgX - capLength, bracketTopY, bracketSvgX, bracketTopY, bracketColor, bracketWidth));
    bracketGroup.appendChild(createLine(bracketSvgX - capLength, bracketBottomY, bracketSvgX, bracketBottomY, bracketColor, bracketWidth));

    var labelBgWidth = 85;
    var labelBgHeight = 42;
    var labelBgX = bracketSvgX - capLength - labelBgWidth - 8;
    var labelBgY = (bracketTopY + bracketBottomY) / 2 - labelBgHeight / 2;

    var labelBg = createRect(labelBgX, labelBgY, labelBgWidth, labelBgHeight, 'rgba(0, 0, 0, 0.9)', 6);
    labelBg.setAttribute('stroke', bracketColor);
    labelBg.setAttribute('stroke-width', '3');
    bracketGroup.appendChild(labelBg);

    var bracketLabel = createText(labelBgX + labelBgWidth / 2, labelBgY + 30, '5.33', 'gmc-bracket-label', bracketColor);
    bracketLabel.setAttribute('text-anchor', 'middle');
    bracketLabel.setAttribute('font-size', '28px');
    bracketLabel.setAttribute('font-weight', 'bold');
    bracketGroup.appendChild(bracketLabel);

    bracketGroup.setAttribute('data-base-x', bracketSvgX);

    svg.appendChild(bracketGroup);

    // Centering annotation
    var centerAnnotation = createText(svgWidth / 2, 170, 'We will subtract the grand mean (15.8) from all education values', 'gmc-annotation gmc-hidden gmc-fade-in', '#ffff00', 'gmc-center-annotation');
    svg.appendChild(centerAnnotation);

    // Blue zero line group (final)
    var blueZeroGroup = createGroup('gmc-blue-zero-group', 'gmc-hidden gmc-fade-in');
    var blueZeroX = xToSvg(0);
    var blueZeroLine = createLine(blueZeroX, yToSvg(yMax), blueZeroX, yToSvg(yMin), zeroLineColor, 3);
    blueZeroLine.setAttribute('stroke-dasharray', '8,4');
    blueZeroGroup.appendChild(blueZeroLine);

    var blueZeroLabel = createText(blueZeroX + 8, yToSvg(90), 'Zero = Grand Mean', 'gmc-zero-label', zeroLineColor);
    blueZeroGroup.appendChild(blueZeroLabel);

    svg.appendChild(blueZeroGroup);

    // Centered X-axis label
    var centeredXLabel = createText(svgWidth / 2, yToSvg(yMin) + 80, 'Education (Grand Mean Centered)', 'gmc-axis-label gmc-hidden gmc-fade-in', zeroLineColor, 'gmc-centered-x-label');
    svg.appendChild(centeredXLabel);

    // Highlight text
    var highlightText = createText(svgWidth / 2, yToSvg(55), 'Zero now represents the average education level (15.8 years)', 'gmc-annotation gmc-hidden gmc-fade-in', zeroLineColor, 'gmc-highlight-text');
    svg.appendChild(highlightText);

    console.log('GMC animation SVG built successfully');
    return true;
  }

  // ============================================
  // SHOW/HIDE HELPERS
  // ============================================
  function showEl(id) {
    var el = document.getElementById(id);
    if (el) el.classList.remove('gmc-hidden');
  }

  function hideEl(id) {
    var el = document.getElementById(id);
    if (el) el.classList.add('gmc-hidden');
  }

  // ============================================
  // ANIMATION HELPER
  // ============================================
  function animateShift() {
    var shiftAmount = grandMeanEdu;
    // Use SVG coordinate shift (not CSS pixels)
    var shiftSvgUnits = (shiftAmount / (xMax - xMin)) * plotWidth;

    // Animate Old Program circles (already using SVG attributes - correct)
    for (var i = 0; i < oldEdu.length; i++) {
      var point = document.getElementById('gmc-old-point-' + i);
      var newX = xToSvg(oldEdu[i] - shiftAmount);
      point.setAttribute('cx', newX);
    }

    // Animate New Program triangles - update points attribute
    for (var i = 0; i < newEdu.length; i++) {
      var triangle = document.getElementById('gmc-new-point-' + i);
      var newX = xToSvg(newEdu[i] - shiftAmount);
      var y = yToSvg(newPerf[i] + yDataOffset);
      triangle.setAttribute('points', trianglePoints(newX, y, 10));
    }

    // Animate regression lines using SVG transform attribute
    var regLinesGroup = document.getElementById('gmc-reg-lines-group');
    regLinesGroup.setAttribute('transform', 'translate(-' + shiftSvgUnits + ', 0)');

    // Animate bracket using SVG transform attribute
    var bracketGroup = document.getElementById('gmc-bracket-group');
    bracketGroup.setAttribute('transform', 'translate(-' + shiftSvgUnits + ', 0)');
  }

  // ============================================
  // RESET ANIMATION
  // ============================================
  function resetAnimation() {
    console.log('GMC: Resetting animation to initial state');

    // Hide all animated elements
    hideEl('gmc-bg-rect');
    hideEl('gmc-main-title');
    hideEl('gmc-axis-group');
    hideEl('gmc-grid-group');
    hideEl('gmc-points-group');
    hideEl('gmc-reg-lines-group');
    hideEl('gmc-legend-group');
    hideEl('gmc-start-label');
    hideEl('gmc-gray-zero-group');
    hideEl('gmc-bracket-group');
    hideEl('gmc-center-annotation');
    hideEl('gmc-blue-zero-group');
    hideEl('gmc-centered-x-label');
    hideEl('gmc-highlight-text');

    // Reset title text and color
    var title = document.getElementById('gmc-main-title');
    if (title) {
      title.textContent = 'Grand Mean Centering';
      title.setAttribute('fill', '#ffffff');
    }

    // Reset x-axis label visibility
    var xAxisLabel = document.getElementById('gmc-x-axis-label');
    if (xAxisLabel) {
      xAxisLabel.style.opacity = '1';
    }

    // Reset point positions
    for (var i = 0; i < oldEdu.length; i++) {
      var point = document.getElementById('gmc-old-point-' + i);
      if (point) {
        point.setAttribute('cx', xToSvg(oldEdu[i]));
      }
    }

    // Reset triangle positions (update points attribute)
    for (var i = 0; i < newEdu.length; i++) {
      var triangle = document.getElementById('gmc-new-point-' + i);
      if (triangle) {
        var x = xToSvg(newEdu[i]);
        var y = yToSvg(newPerf[i] + yDataOffset);
        triangle.setAttribute('points', trianglePoints(x, y, 10));
      }
    }

    // Reset regression lines transform (SVG attribute)
    var regLinesGroup = document.getElementById('gmc-reg-lines-group');
    if (regLinesGroup) {
      regLinesGroup.removeAttribute('transform');
    }

    // Reset bracket transform (SVG attribute)
    var bracketGroup = document.getElementById('gmc-bracket-group');
    if (bracketGroup) {
      bracketGroup.removeAttribute('transform');
    }
  }

  // ============================================
  // RENDER FRAME
  // ============================================
  function renderFrame(frame) {
    console.log('GMC: Rendering frame:', frame);

    switch (frame) {
      case 1: // Title + background
        showEl('gmc-bg-rect');
        showEl('gmc-main-title');
        break;

      case 2: // Scatterplot
        showEl('gmc-axis-group');
        showEl('gmc-grid-group');
        showEl('gmc-points-group');
        showEl('gmc-reg-lines-group');
        showEl('gmc-legend-group');
        break;

      case 3: // Starting label + zero line
        showEl('gmc-start-label');
        showEl('gmc-gray-zero-group');
        break;

      case 4: // Show bracket
        showEl('gmc-bracket-group');
        break;

      case 5: // Centering annotation
        showEl('gmc-center-annotation');
        break;

      case 6: // ANIMATE - shift everything left
        hideEl('gmc-center-annotation');
        hideEl('gmc-gray-zero-group');
        hideEl('gmc-start-label');
        showEl('gmc-blue-zero-group');
        animateShift();

        var title = document.getElementById('gmc-main-title');
        if (title) {
          title.textContent = 'GRAND MEAN CENTERED: Intercept = performance at overall mean education';
          title.setAttribute('fill', zeroLineColor);
        }
        break;

      case 7: // Show centered state
        hideEl('gmc-start-label');
        var xAxisLabel = document.getElementById('gmc-x-axis-label');
        if (xAxisLabel) xAxisLabel.style.opacity = '0';
        showEl('gmc-centered-x-label');
        showEl('gmc-blue-zero-group');
        break;

      case 8: // Highlight text
        showEl('gmc-highlight-text');
        break;

      case 9: // Fade out
        hideEl('gmc-bg-rect');
        hideEl('gmc-main-title');
        hideEl('gmc-axis-group');
        hideEl('gmc-grid-group');
        hideEl('gmc-points-group');
        hideEl('gmc-reg-lines-group');
        hideEl('gmc-legend-group');
        hideEl('gmc-bracket-group');
        hideEl('gmc-blue-zero-group');
        hideEl('gmc-centered-x-label');
        hideEl('gmc-highlight-text');
        break;
    }
  }

  // ============================================
  // INITIALIZATION
  // ============================================
  function init() {
    console.log('GMC: Initializing animation...');

    if (!buildSVG()) {
      console.error('GMC: Failed to build SVG');
      return;
    }

    if (typeof Reveal !== 'undefined') {
      console.log('GMC: Reveal.js detected, attaching fragment listener');

      Reveal.on('fragmentshown', function(event) {
        var currentSlide = Reveal.getCurrentSlide();
        var slideId = currentSlide ? currentSlide.getAttribute('id') : null;
        if (slideId !== 'grand-mean-centered-scatter-animation') {
          return;
        }
        var idx = event.fragment.getAttribute('data-fragment-index');
        console.log('GMC: Fragment shown, index:', idx);
        if (idx) renderFrame(parseInt(idx));
      });

      Reveal.on('slidechanged', function(event) {
        var slideId = event.currentSlide.getAttribute('id');
        if (slideId === 'grand-mean-centered-scatter-animation') {
          console.log('GMC: Entering animation slide, resetting...');
          resetAnimation();
        }
      });
    } else {
      console.warn('GMC: Reveal.js not found');
    }
  }

  // Initialize when Reveal is ready
  if (typeof Reveal !== 'undefined' && Reveal.isReady && Reveal.isReady()) {
    init();
  } else if (typeof Reveal !== 'undefined') {
    Reveal.on('ready', init);
  } else {
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        if (typeof Reveal !== 'undefined') {
          if (Reveal.isReady && Reveal.isReady()) {
            init();
          } else {
            Reveal.on('ready', init);
          }
        }
      }, 100);
    });
  }
})();
</script>
</section>
<section id="comparing-the-two-centering-models" class="slide level2 smaller" data-transition="none">
<h2>Comparing the Two Centering Models</h2>
<p><strong>Uncentered Model:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">lm</span>(performance <span class="sc">~</span> program <span class="sc">+</span> education, <span class="at">data =</span> onboard_data) <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">15.542</td>
<td style="text-align: right;">9.015</td>
<td style="text-align: right;">1.724</td>
<td style="text-align: right;">0.103</td>
<td style="text-align: right;">-3.478</td>
<td style="text-align: right;">34.561</td>
</tr>
<tr class="even">
<td style="text-align: left;">programnew</td>
<td style="text-align: right;">5.333</td>
<td style="text-align: right;">2.369</td>
<td style="text-align: right;">2.251</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">10.331</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education</td>
<td style="text-align: right;">3.494</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">5.721</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.206</td>
<td style="text-align: right;">4.783</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Grand Mean Centered Model:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="fu">lm</span>(performance <span class="sc">~</span> program <span class="sc">+</span> education_c, <span class="at">data =</span> onboard_centered) <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">70.753</td>
<td style="text-align: right;">1.506</td>
<td style="text-align: right;">46.975</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">67.576</td>
<td style="text-align: right;">73.931</td>
</tr>
<tr class="even">
<td style="text-align: left;">programnew</td>
<td style="text-align: right;">5.333</td>
<td style="text-align: right;">2.369</td>
<td style="text-align: right;">2.251</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">10.331</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education_c</td>
<td style="text-align: right;">3.494</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">5.721</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.206</td>
<td style="text-align: right;">4.783</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>What changed?</strong> Only the intercept! The program and education coefficients are identical.</p>
<ul>
<li><strong>Intercept:</strong> Changed from 15.5 to 70.8. Now represents predicted performance for the <strong>old program</strong> (reference group) at <em>grand mean</em> education (15.8 years) rather than at 0 years.</li>
<li><strong>Slopes:</strong> Unchanged‚Äîcentering shifts the zero point but doesn‚Äôt change the relationships between variables.</li>
</ul>
</section>
<section id="what-is-group-mean-centering" class="slide level2" data-transition="none">
<h2>What is Group Mean Centering?</h2>
<p>We‚Äôve seen <strong>grand mean centering</strong>: subtracting the overall mean from each score.</p>
<p><strong>Group mean centering</strong> takes this further: subtract each group‚Äôs own mean from scores within that group.</p>
<table class="caption-top">
<colgroup>
<col style="width: 29%">
<col style="width: 32%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Centering Type</th>
<th>What We Subtract</th>
<th>Intercept Represents</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>None (raw)</td>
<td>Nothing</td>
<td>Performance for reference group when education = 0</td>
</tr>
<tr class="even">
<td>Grand mean</td>
<td>Overall mean education</td>
<td>Performance for reference group at overall mean education</td>
</tr>
<tr class="odd">
<td>Group mean</td>
<td>Each group‚Äôs mean education</td>
<td>Performance for reference group at reference group‚Äôs mean education</td>
</tr>
</tbody>
</table>
<p><strong>Why does this matter?</strong></p>
<ul>
<li>Grand mean centering keeps between-group differences in the predictor</li>
<li>Group mean centering removes between-group differences, leaving only within-group variation</li>
<li>This becomes crucial for multilevel modeling (coming soon!)</li>
</ul>
</section>
<section id="group-centering-a-visual-explanation" class="slide level2" data-transition="none">
<h2>Group Centering: A Visual Explanation</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/group-centering-visual-1.png" class="quarto-figure quarto-figure-center" width="886" height="620"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="group-centering-a-visual-animation" class="slide level2" data-transition="none">
<h2>Group Centering: A Visual Animation</h2>
<style>
  #gc-anim-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 85vh;
    width: 100%;
  }

  #gc-anim-container {
    width: 100%;
    max-width: 1920px;
    aspect-ratio: 1920 / 600;
    padding: 0;
    margin: 0 auto;
    visibility: hidden;
  }

  #gc-anim-container svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  .gc-title {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
    transition: fill 2s ease-in-out;
  }

  .gc-axis-label {
    font-size: 24px;
    font-weight: bold;
    text-anchor: middle;
  }

  .gc-tick-label {
    font-size: 20px;
    font-weight: bold;
    text-anchor: middle;
  }

  .gc-annotation {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
  }

  .gc-mean-label {
    font-size: 22px;
    font-weight: bold;
    text-anchor: middle;
  }

  .gc-group-label {
    font-size: 24px;
    font-weight: bold;
    text-anchor: start;
  }

  .gc-callout {
    font-size: 22px;
    font-weight: bold;
    text-anchor: middle;
  }

  .gc-hidden {
    opacity: 0;
    pointer-events: none;
  }

  .gc-fade-in {
    transition: opacity 0.5s ease-in-out;
  }

  .gc-data-point {
    transition: cx 2s ease-in-out, cy 2s ease-in-out, fill 2s ease-in-out;
  }

  .gc-mean-marker {
    transition: cx 2s ease-in-out, cy 2s ease-in-out, fill 2s ease-in-out;
  }

  .gc-axis-fade {
    transition: opacity 0.5s ease-in-out;
  }
</style>
<div id="gc-anim-wrapper">
<div id="gc-anim-container">

</div>
</div>
<div class="fragment" data-fragment-index="1">

</div>
<div class="fragment" data-fragment-index="2">

</div>
<div class="fragment" data-fragment-index="3">

</div>
<div class="fragment" data-fragment-index="4">

</div>
<div class="fragment" data-fragment-index="5">

</div>
<div class="fragment" data-fragment-index="6">

</div>
<div class="fragment" data-fragment-index="7">

</div>
<div class="fragment" data-fragment-index="8">

</div>
<div class="fragment" data-fragment-index="9">

</div>
<div class="fragment" data-fragment-index="10">

</div>
<div class="fragment" data-fragment-index="11">

</div>
<div class="fragment" data-fragment-index="12">

</div>
<script>
(function() {
  // ============================================
  // DATA
  // ============================================
  var eduVals = [12, 14, 13, 16, 15, 14, 17, 14, 16, 15,
                 15, 18, 16, 20, 17, 16, 19, 15, 18, 16];

  var oldIndices = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
  var newIndices = [10, 11, 12, 13, 14, 15, 16, 17, 18, 19];

  var oldMean = 14.6;
  var newMean = 17.0;

  var jitterOffsets = [
     0.1244418130,  0.1311226240, -0.0641581396,  0.0991342878,  0.0425236557,
     0.0057287847,  0.0709764944, -0.1096000208,  0.0470976871,  0.0615194352,
    -0.0126774671,  0.0657336755,  0.1304016741, -0.0733713527, -0.0113121532,
     0.1320043568,  0.1434679285, -0.1147537915, -0.0075008755,  0.0180998239
  ];

  // Colors (same as original grand mean animation)
  var oldColor = '#ff4d4d';
  var newColor = '#5cb8ff';
  var orangeColor = '#ff7f00';

  // ============================================
  // SVG COORDINATE MAPPING
  // Same axis range as original: -6 to 22 (zero is visible!)
  // ============================================
  var svgWidth = 1920, svgHeight = 600;
  var marginLeft = 100, marginRight = 100;

  var originalAxisY = 150;
  var originalPointsBaseY = 80;
  var oldCenteredAxisY = 350;
  var oldCenteredPointsBaseY = 280;
  var newCenteredAxisY = 520;
  var newCenteredPointsBaseY = 450;

  var jitterScale = 200;

  // SAME axis range as original animation: -6 to 22
  var axisMin = -6;
  var axisMax = 22;
  var axisRange = axisMax - axisMin; // 28

  function valueToX(val) {
    return marginLeft + (val - axisMin) * ((svgWidth - marginLeft - marginRight) / axisRange);
  }

  var svgNS = "http://www.w3.org/2000/svg";
  var svg = null;

  function createLine(x1, y1, x2, y2, stroke, strokeWidth, id) {
    var line = document.createElementNS(svgNS, 'line');
    line.setAttribute('x1', x1); line.setAttribute('y1', y1);
    line.setAttribute('x2', x2); line.setAttribute('y2', y2);
    line.setAttribute('stroke', stroke || '#333');
    line.setAttribute('stroke-width', strokeWidth || 2);
    if (id) line.setAttribute('id', id);
    return line;
  }

  function createText(x, y, text, className, fill, id) {
    var textEl = document.createElementNS(svgNS, 'text');
    textEl.setAttribute('x', x); textEl.setAttribute('y', y);
    textEl.setAttribute('fill', fill || '#333');
    if (className) textEl.setAttribute('class', className);
    if (id) textEl.setAttribute('id', id);
    textEl.textContent = text;
    return textEl;
  }

  function createCircle(cx, cy, r, fill, className, id) {
    var circle = document.createElementNS(svgNS, 'circle');
    circle.setAttribute('cx', cx); circle.setAttribute('cy', cy);
    circle.setAttribute('r', r); circle.setAttribute('fill', fill);
    if (className) circle.setAttribute('class', className);
    if (id) circle.setAttribute('id', id);
    return circle;
  }

  function createRect(x, y, width, height, fill, rx, id) {
    var rect = document.createElementNS(svgNS, 'rect');
    rect.setAttribute('x', x); rect.setAttribute('y', y);
    rect.setAttribute('width', width); rect.setAttribute('height', height);
    rect.setAttribute('fill', fill); rect.setAttribute('rx', rx || 0);
    if (id) rect.setAttribute('id', id);
    return rect;
  }

  function createGroup(id, className) {
    var g = document.createElementNS(svgNS, 'g');
    if (id) g.setAttribute('id', id);
    if (className) g.setAttribute('class', className);
    return g;
  }

  function buildSVG() {
    var container = document.getElementById('gc-anim-container');
    if (!container) {
      console.error('Group centering animation container not found');
      return false;
    }

    svg = document.createElementNS(svgNS, 'svg');
    svg.setAttribute('viewBox', '0 0 1920 600');
    svg.setAttribute('id', 'gc-anim-svg');
    container.appendChild(svg);

    // Background
    var bgRect = createRect(40, 10, svgWidth - 80, svgHeight - 20, 'rgba(0, 0, 0, 0.70)', 20, 'gc-bg-rect');
    bgRect.setAttribute('class', 'gc-hidden gc-fade-in');
    svg.appendChild(bgRect);

    // Original axis group (-6 to 22)
    var origAxisGroup = createGroup('gc-orig-axis-group', 'gc-hidden gc-fade-in gc-axis-fade');
    origAxisGroup.appendChild(createLine(valueToX(axisMin), originalAxisY,
                                         valueToX(axisMax), originalAxisY, '#ffffff', 3));
    for (var val = axisMin; val <= axisMax; val += 2) {
      var x = valueToX(val);
      origAxisGroup.appendChild(createLine(x, originalAxisY - 8, x, originalAxisY + 8, '#ffffff', 2));
      origAxisGroup.appendChild(createText(x, originalAxisY + 30, val.toString(), 'gc-tick-label', '#ffffff'));
    }
    var origAxisLabel = createText(svgWidth / 2, originalAxisY + 60, 'Years of Education', 'gc-axis-label', '#ffffff');
    origAxisLabel.setAttribute('id', 'gc-orig-axis-label');
    origAxisGroup.appendChild(origAxisLabel);
    svg.appendChild(origAxisGroup);

    // Title
    var title = createText(svgWidth / 2, 40, 'ORIGINAL SCALE', 'gc-title gc-hidden gc-fade-in', '#ffffff');
    title.setAttribute('id', 'gc-main-title');
    svg.appendChild(title);

    // Old program points
    var oldPointsGroup = createGroup('gc-old-points-group', 'gc-hidden gc-fade-in');
    for (var i = 0; i < oldIndices.length; i++) {
      var idx = oldIndices[i];
      var px = valueToX(eduVals[idx]);
      var py = originalPointsBaseY + jitterOffsets[idx] * jitterScale;
      oldPointsGroup.appendChild(createCircle(px, py, 10, oldColor, 'gc-data-point', 'gc-old-point-' + idx));
    }
    svg.appendChild(oldPointsGroup);

    // New program points
    var newPointsGroup = createGroup('gc-new-points-group', 'gc-hidden gc-fade-in');
    for (var i = 0; i < newIndices.length; i++) {
      var idx = newIndices[i];
      var px = valueToX(eduVals[idx]);
      var py = originalPointsBaseY + jitterOffsets[idx] * jitterScale;
      newPointsGroup.appendChild(createCircle(px, py, 10, newColor, 'gc-data-point', 'gc-new-point-' + idx));
    }
    svg.appendChild(newPointsGroup);

    // Old mean marker
    var oldMeanX = valueToX(oldMean);
    var oldMeanMarker = createCircle(oldMeanX, originalAxisY, 14, oldColor, 'gc-mean-marker gc-hidden gc-fade-in', 'gc-old-mean-marker');
    svg.appendChild(oldMeanMarker);
    var oldMeanLabel = createText(oldMeanX, originalAxisY + 70, 'Old Program Mean (' + oldMean + ')', 'gc-mean-label gc-hidden gc-fade-in', oldColor);
    oldMeanLabel.setAttribute('id', 'gc-old-mean-label');
    svg.appendChild(oldMeanLabel);

    // New mean marker
    var newMeanX = valueToX(newMean);
    var newMeanMarker = createCircle(newMeanX, originalAxisY, 14, newColor, 'gc-mean-marker gc-hidden gc-fade-in', 'gc-new-mean-marker');
    svg.appendChild(newMeanMarker);
    var newMeanLabel = createText(newMeanX, originalAxisY + 95, 'New Program Mean (' + newMean + ')', 'gc-mean-label gc-hidden gc-fade-in', newColor);
    newMeanLabel.setAttribute('id', 'gc-new-mean-label');
    svg.appendChild(newMeanLabel);

    // Annotation group
    var annotationGroup = createGroup('gc-annotation-group', 'gc-hidden gc-fade-in');
    annotationGroup.appendChild(createText(svgWidth / 2, originalAxisY + 100, "Group Mean Centering: subtract each group's own mean", 'gc-annotation', '#ffffff'));
    annotationGroup.appendChild(createText(svgWidth / 2 - 250, originalAxisY + 140, 'Old Program: x - ' + oldMean, 'gc-annotation', oldColor));
    annotationGroup.appendChild(createText(svgWidth / 2 + 250, originalAxisY + 140, 'New Program: x - ' + newMean, 'gc-annotation', newColor));
    svg.appendChild(annotationGroup);

    // Old centered axis group (-6 to 6 range)
    var oldCenteredAxisGroup = createGroup('gc-old-centered-axis-group', 'gc-hidden gc-fade-in');
    oldCenteredAxisGroup.appendChild(createLine(valueToX(-6), oldCenteredAxisY,
                                                valueToX(6), oldCenteredAxisY, oldColor, 3));
    for (var val = -6; val <= 6; val += 2) {
      var x = valueToX(val);
      oldCenteredAxisGroup.appendChild(createLine(x, oldCenteredAxisY - 8, x, oldCenteredAxisY + 8, oldColor, 2));
      var label = val === 0 ? '0' : (val > 0 ? '+' + val : val.toString());
      oldCenteredAxisGroup.appendChild(createText(x, oldCenteredAxisY + 30, label, 'gc-tick-label', oldColor));
    }
    oldCenteredAxisGroup.appendChild(createText(valueToX(6) + 30, oldCenteredAxisY + 5, 'Old Program', 'gc-group-label', oldColor));
    oldCenteredAxisGroup.appendChild(createCircle(valueToX(0), oldCenteredAxisY, 14, oldColor, '', 'gc-old-zero-marker'));
    svg.appendChild(oldCenteredAxisGroup);

    // New centered axis group (-6 to 6 range)
    var newCenteredAxisGroup = createGroup('gc-new-centered-axis-group', 'gc-hidden gc-fade-in');
    newCenteredAxisGroup.appendChild(createLine(valueToX(-6), newCenteredAxisY,
                                                valueToX(6), newCenteredAxisY, newColor, 3));
    for (var val = -6; val <= 6; val += 2) {
      var x = valueToX(val);
      newCenteredAxisGroup.appendChild(createLine(x, newCenteredAxisY - 8, x, newCenteredAxisY + 8, newColor, 2));
      var label = val === 0 ? '0' : (val > 0 ? '+' + val : val.toString());
      newCenteredAxisGroup.appendChild(createText(x, newCenteredAxisY + 30, label, 'gc-tick-label', newColor));
    }
    newCenteredAxisGroup.appendChild(createText(valueToX(6) + 30, newCenteredAxisY + 5, 'New Program', 'gc-group-label', newColor));
    newCenteredAxisGroup.appendChild(createCircle(valueToX(0), newCenteredAxisY, 14, newColor, '', 'gc-new-zero-marker'));
    svg.appendChild(newCenteredAxisGroup);

    // Both means label (above the data points)
    var bothMeansLabelY = oldCenteredPointsBaseY - 50;
    var bothMeansLabel = createText(valueToX(0), bothMeansLabelY, 'Both means = 0', 'gc-mean-label gc-hidden gc-fade-in', '#ffffff');

    // Alignment line (white, extends from label to below new axis)
    var alignmentLine = createLine(valueToX(0), bothMeansLabelY + 10,
                                   valueToX(0), newCenteredAxisY + 40, '#ffffff', 3, 'gc-alignment-line');
    alignmentLine.setAttribute('class', 'gc-hidden gc-fade-in');
    alignmentLine.setAttribute('stroke-dasharray', '10,5');
    svg.appendChild(alignmentLine);
    bothMeansLabel.setAttribute('id', 'gc-both-means-label');
    svg.appendChild(bothMeansLabel);

    // Callout boxes (both centered between numberline end and right edge)
    var boxWidth = 420;
    var boxHeight = 70;
    var boxCenterX = (valueToX(6) + (svgWidth - marginRight)) / 2;
    var boxLeftX = boxCenterX - boxWidth / 2;

    // Summary box (upper)
    var summaryBoxY = oldCenteredAxisY - 40;
    var summaryGroup = createGroup('gc-summary-group', 'gc-hidden gc-fade-in');
    var summaryRect = createRect(boxLeftX, summaryBoxY, boxWidth, boxHeight, 'rgba(255, 255, 255, 0.9)', 10);
    var summaryText1 = createText(boxCenterX, summaryBoxY + 28, 'After group mean centering,', 'gc-callout', '#333');
    summaryText1.setAttribute('text-anchor', 'middle');
    var summaryText2 = createText(boxCenterX, summaryBoxY + 52, 'both groups have mean = 0', 'gc-callout', '#333');
    summaryText2.setAttribute('text-anchor', 'middle');
    summaryGroup.appendChild(summaryRect);
    summaryGroup.appendChild(summaryText1);
    summaryGroup.appendChild(summaryText2);
    svg.appendChild(summaryGroup);

    // Insight box (lower)
    var insightBoxY = newCenteredAxisY - 40;
    var insightGroup = createGroup('gc-insight-group', 'gc-hidden gc-fade-in');
    var insightRect = createRect(boxLeftX, insightBoxY, boxWidth, boxHeight, 'rgba(255, 255, 255, 0.9)', 10);
    var insightText1 = createText(boxCenterX, insightBoxY + 28, 'Within each group, points show', 'gc-callout', '#333');
    insightText1.setAttribute('text-anchor', 'middle');
    var insightText2 = createText(boxCenterX, insightBoxY + 52, "deviation from that group's mean", 'gc-callout', '#333');
    insightText2.setAttribute('text-anchor', 'middle');
    insightGroup.appendChild(insightRect);
    insightGroup.appendChild(insightText1);
    insightGroup.appendChild(insightText2);
    svg.appendChild(insightGroup);

    console.log('Group centering animation SVG built successfully');
    return true;
  }

  function showEl(id) {
    var el = document.getElementById(id);
    if (el) el.classList.remove('gc-hidden');
  }

  function hideEl(id) {
    var el = document.getElementById(id);
    if (el) el.classList.add('gc-hidden');
  }

  function resetAnimation() {
    console.log('Resetting group centering animation');

    // Hide all elements
    hideEl('gc-bg-rect');
    hideEl('gc-orig-axis-group');
    hideEl('gc-main-title');
    hideEl('gc-old-points-group');
    hideEl('gc-new-points-group');
    hideEl('gc-old-mean-marker');
    hideEl('gc-old-mean-label');
    hideEl('gc-new-mean-marker');
    hideEl('gc-new-mean-label');
    hideEl('gc-annotation-group');
    hideEl('gc-old-centered-axis-group');
    hideEl('gc-new-centered-axis-group');
    hideEl('gc-alignment-line');
    hideEl('gc-both-means-label');
    hideEl('gc-summary-group');
    hideEl('gc-insight-group');

    // Reset title
    var titleEl = document.getElementById('gc-main-title');
    if (titleEl) {
      titleEl.textContent = 'ORIGINAL SCALE';
      titleEl.setAttribute('fill', '#ffffff');
    }

    // Reset old program points
    for (var i = 0; i < oldIndices.length; i++) {
      var idx = oldIndices[i];
      var point = document.getElementById('gc-old-point-' + idx);
      if (point) {
        point.setAttribute('cx', valueToX(eduVals[idx]));
        point.setAttribute('cy', originalPointsBaseY + jitterOffsets[idx] * jitterScale);
      }
    }

    // Reset new program points
    for (var i = 0; i < newIndices.length; i++) {
      var idx = newIndices[i];
      var point = document.getElementById('gc-new-point-' + idx);
      if (point) {
        point.setAttribute('cx', valueToX(eduVals[idx]));
        point.setAttribute('cy', originalPointsBaseY + jitterOffsets[idx] * jitterScale);
      }
    }

    // Reset old mean marker and label
    var oldMeanMarkerEl = document.getElementById('gc-old-mean-marker');
    if (oldMeanMarkerEl) {
      oldMeanMarkerEl.setAttribute('cx', valueToX(oldMean));
      oldMeanMarkerEl.setAttribute('cy', originalAxisY);
    }
    var oldMeanLabelEl = document.getElementById('gc-old-mean-label');
    if (oldMeanLabelEl) {
      oldMeanLabelEl.setAttribute('x', valueToX(oldMean));
      oldMeanLabelEl.textContent = 'Old Program Mean (' + oldMean + ')';
    }

    // Reset new mean marker and label
    var newMeanMarkerEl = document.getElementById('gc-new-mean-marker');
    if (newMeanMarkerEl) {
      newMeanMarkerEl.setAttribute('cx', valueToX(newMean));
      newMeanMarkerEl.setAttribute('cy', originalAxisY);
    }
    var newMeanLabelEl = document.getElementById('gc-new-mean-label');
    if (newMeanLabelEl) {
      newMeanLabelEl.setAttribute('x', valueToX(newMean));
      newMeanLabelEl.textContent = 'New Program Mean (' + newMean + ')';
    }
  }

  function renderFrame(frame) {
    console.log('Rendering group centering frame:', frame);
    switch (frame) {
      case 1: // Background + original axis
        showEl('gc-bg-rect');
        showEl('gc-orig-axis-group');
        break;

      case 2: // Title + both groups' points
        showEl('gc-main-title');
        showEl('gc-old-points-group');
        showEl('gc-new-points-group');
        break;

      case 3: // Old mean marker
        showEl('gc-old-mean-marker');
        showEl('gc-old-mean-label');
        break;

      case 4: // New mean marker
        showEl('gc-new-mean-marker');
        showEl('gc-new-mean-label');
        break;

      case 5: // Centering instructions
        showEl('gc-annotation-group');
        break;

      case 6: // Old points slide to center
        var titleEl = document.getElementById('gc-main-title');
        if (titleEl) {
          titleEl.textContent = 'GROUP MEAN CENTERING - OLD PROGRAM';
          titleEl.setAttribute('fill', oldColor);
        }
        for (var i = 0; i < oldIndices.length; i++) {
          var idx = oldIndices[i];
          var point = document.getElementById('gc-old-point-' + idx);
          if (point) {
            var centeredVal = eduVals[idx] - oldMean;
            point.setAttribute('cx', valueToX(centeredVal));
          }
        }
        var oldMeanMarkerEl = document.getElementById('gc-old-mean-marker');
        if (oldMeanMarkerEl) {
          oldMeanMarkerEl.setAttribute('cx', valueToX(0));
        }
        var oldMeanLabelEl = document.getElementById('gc-old-mean-label');
        if (oldMeanLabelEl) {
          oldMeanLabelEl.setAttribute('x', valueToX(0));
          oldMeanLabelEl.textContent = 'Mean = 0';
        }
        break;

      case 7: // Old centered axis + points drop
        showEl('gc-old-centered-axis-group');
        hideEl('gc-annotation-group');
        for (var i = 0; i < oldIndices.length; i++) {
          var idx = oldIndices[i];
          var point = document.getElementById('gc-old-point-' + idx);
          if (point) {
            point.setAttribute('cy', oldCenteredPointsBaseY + jitterOffsets[idx] * jitterScale);
          }
        }
        hideEl('gc-old-mean-marker');
        hideEl('gc-old-mean-label');
        break;

      case 8: // New points slide to center
        var titleEl = document.getElementById('gc-main-title');
        if (titleEl) {
          titleEl.textContent = 'GROUP MEAN CENTERING - NEW PROGRAM';
          titleEl.setAttribute('fill', newColor);
        }
        for (var i = 0; i < newIndices.length; i++) {
          var idx = newIndices[i];
          var point = document.getElementById('gc-new-point-' + idx);
          if (point) {
            var centeredVal = eduVals[idx] - newMean;
            point.setAttribute('cx', valueToX(centeredVal));
          }
        }
        var newMeanMarkerEl = document.getElementById('gc-new-mean-marker');
        if (newMeanMarkerEl) {
          newMeanMarkerEl.setAttribute('cx', valueToX(0));
        }
        var newMeanLabelEl = document.getElementById('gc-new-mean-label');
        if (newMeanLabelEl) {
          newMeanLabelEl.setAttribute('x', valueToX(0));
          newMeanLabelEl.textContent = 'Mean = 0';
        }
        break;

      case 9: // New centered axis + points drop + hide original
        showEl('gc-new-centered-axis-group');
        for (var i = 0; i < newIndices.length; i++) {
          var idx = newIndices[i];
          var point = document.getElementById('gc-new-point-' + idx);
          if (point) {
            point.setAttribute('cy', newCenteredPointsBaseY + jitterOffsets[idx] * jitterScale);
          }
        }
        hideEl('gc-new-mean-marker');
        hideEl('gc-new-mean-label');
        hideEl('gc-orig-axis-group');
        break;

      case 10: // Alignment line + summary
        var titleEl = document.getElementById('gc-main-title');
        if (titleEl) {
          titleEl.textContent = 'GROUP MEAN CENTERED';
          titleEl.setAttribute('fill', '#ffffff');
        }
        showEl('gc-alignment-line');
        showEl('gc-both-means-label');
        showEl('gc-summary-group');
        break;

      case 11: // Key insight
        showEl('gc-insight-group');
        break;

      case 12: // Fade out
        hideEl('gc-bg-rect');
        hideEl('gc-orig-axis-group');
        hideEl('gc-main-title');
        hideEl('gc-old-points-group');
        hideEl('gc-new-points-group');
        hideEl('gc-old-centered-axis-group');
        hideEl('gc-new-centered-axis-group');
        hideEl('gc-alignment-line');
        hideEl('gc-both-means-label');
        hideEl('gc-summary-group');
        hideEl('gc-insight-group');
        break;
    }
  }

  function init() {
    console.log('Initializing group centering animation...');

    if (!buildSVG()) {
      console.error('Failed to build group centering SVG');
      return;
    }

    // Make container visible now that SVG is built with hidden elements
    var container = document.getElementById('gc-anim-container');
    if (container) {
      container.style.visibility = 'visible';
    }

    if (typeof Reveal !== 'undefined') {
      console.log('Reveal.js detected, attaching fragment listener for group centering');
      Reveal.on('fragmentshown', function(event) {
        // Only respond to fragments on our slide
        var currentSlide = Reveal.getCurrentSlide();
        var slideId = currentSlide ? currentSlide.getAttribute('id') : null;
        if (slideId !== 'group-centering-a-visual-animation') {
          return;
        }
        var idx = event.fragment.getAttribute('data-fragment-index');
        console.log('Group centering fragment shown, index:', idx);
        if (idx) renderFrame(parseInt(idx));
      });

      Reveal.on('slidechanged', function(event) {
        var slideId = event.currentSlide.getAttribute('id');
        if (slideId === 'group-centering-a-visual-animation') {
          console.log('Entering group centering animation slide, resetting...');
          resetAnimation();
        }
      });
    } else {
      console.warn('Reveal.js not found');
    }
  }

  if (typeof Reveal !== 'undefined' && Reveal.isReady && Reveal.isReady()) {
    init();
  } else if (typeof Reveal !== 'undefined') {
    Reveal.on('ready', init);
  } else {
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        if (typeof Reveal !== 'undefined') {
          if (Reveal.isReady && Reveal.isReady()) {
            init();
          } else {
            Reveal.on('ready', init);
          }
        }
      }, 100);
    });
  }
})();
</script>
</section>
<section id="uncentered-model-review" class="slide level2" data-transition="none">
<h2>Uncentered Model (Review)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/uncentered-plot-review-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Intercept interpretation:</strong> Expected performance for the <strong>old program</strong> (reference group) when education = 0 years (not meaningful!)</p>
</section>
<section id="grand-mean-centered-model-review" class="slide level2" data-transition="none">
<h2>Grand Mean Centered Model (Review)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/grand-mean-centered-plot-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Intercept interpretation:</strong> Expected performance for the <strong>old program</strong> (reference group) at the grand mean education (15.8 years)</p>
</section>
<section id="group-mean-centered-model-new" class="slide level2" data-transition="none">
<h2>Group Mean Centered Model (New)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/group-mean-centered-plot-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Program coefficient (13.72):</strong> This is the <strong>unadjusted</strong> difference between groups‚Äîthe same value we got from <code>lm(performance ~ program)</code> without education in the model (13.72).</p>
<p><strong>Why?</strong> Group mean centering compares groups at their <em>own</em> mean education levels, not at a <em>common</em> education level. This removes the statistical control for education differences between groups.</p>
</section>
<section id="group-mean-centered-scatter-animation" class="slide level2" data-transition="none">
<h2>Group Mean Centered Scatter Animation</h2>
<style>
  #grmc-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 75vh;
    width: 100%;
  }

  #grmc-container {
    width: 100%;
    max-width: 1920px;
    aspect-ratio: 1920 / 1080;
    padding: 0;
    margin: 0 auto;
  }

  #grmc-container svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  .grmc-title {
    font-size: 36px;
    font-weight: bold;
    text-anchor: middle;
    transition: fill 2s ease-in-out;
  }

  .grmc-axis-label {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
  }

  .grmc-axis-label-y {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
  }

  .grmc-tick-label {
    font-size: 20px;
    text-anchor: middle;
  }

  .grmc-annotation {
    font-size: 28px;
    font-weight: bold;
    text-anchor: middle;
  }

  .grmc-zero-label {
    font-size: 22px;
    font-style: italic;
    text-anchor: start;
  }

  .grmc-bracket-label {
    font-size: 22px;
    font-weight: bold;
    text-anchor: middle;
  }

  .grmc-legend-text {
    font-size: 22px;
    text-anchor: start;
  }

  .grmc-legend-title {
    font-size: 22px;
    font-weight: bold;
    text-anchor: start;
  }

  .grmc-group-mean-label {
    font-size: 20px;
    font-weight: bold;
  }

  .grmc-hidden {
    opacity: 0;
    pointer-events: none;
  }

  .grmc-fade-in {
    transition: opacity 0.5s ease-in-out;
  }

  .grmc-data-point-old {
    transition: cx 2s ease-in-out;
  }

  .grmc-data-point-new {
    transition: cx 2s ease-in-out;
  }

  .grmc-data-triangle-old {
    transition: transform 2s ease-in-out;
  }

  .grmc-data-triangle-new {
    transition: transform 2s ease-in-out;
  }

  .grmc-reg-line {
    transition: d 2s ease-in-out;
  }

  #grmc-bracket-group {
    transition: transform 2s ease-in-out;
  }

  #grmc-old-reg-line-group {
    transition: transform 2s ease-in-out;
  }

  #grmc-new-reg-line-group {
    transition: transform 2s ease-in-out;
  }

  .grmc-zero-line-group {
    transition: opacity 0.5s ease-in-out;
  }
</style>
<div id="grmc-wrapper">
<div id="grmc-container">

</div>
</div>
<div class="fragment" data-fragment-index="1">

</div>
<div class="fragment" data-fragment-index="2">

</div>
<div class="fragment" data-fragment-index="3">

</div>
<div class="fragment" data-fragment-index="4">

</div>
<div class="fragment" data-fragment-index="5">

</div>
<div class="fragment" data-fragment-index="6">

</div>
<div class="fragment" data-fragment-index="7">

</div>
<div class="fragment" data-fragment-index="8">

</div>
<div class="fragment" data-fragment-index="9">

</div>
<div class="fragment" data-fragment-index="10">

</div>
<div class="fragment" data-fragment-index="11">

</div>
<div class="fragment" data-fragment-index="12">

</div>
<script>
(function() {
  // ============================================
  // DATA (exact values from R)
  // ============================================
  // Old Program (coral #F8766D, circles)
  var oldEdu = [12, 14, 13, 16, 15, 14, 17, 14, 16, 15];
  var oldPerf = [54.6, 67.5, 65.7, 64.4, 64.6, 63.7, 75.3, 66.0, 74.0, 69.8];

  // New Program (teal #00BFC4, triangles)
  var newEdu = [15, 18, 16, 20, 17, 16, 19, 15, 18, 16];
  var newPerf = [67.8, 84.2, 78.0, 90.6, 70.7, 81.8, 88.4, 73.0, 88.1, 80.2];

  // Group means for centering
  var oldMeanEdu = 14.6;
  var newMeanEdu = 17.0;

  // Coefficient values from R:
  // lm(performance ~ program + education) gives programnew = 5.33
  // lm(performance ~ program + education_gc) gives programnew = 13.72
  var programCoefUncentered = 5.33;
  var programCoefCentered = 13.72;

  // Regression parameters from R: lm(performance ~ program + education)
  // Intercept = 15.5418, programnew = 5.3334, slope = 3.4944
  var slope = 3.4944;
  var interceptOld = 15.5418;
  var interceptNew = interceptOld + programCoefUncentered;

  // Colors
  var coralColor = '#F8766D';
  var tealColor = '#00BFC4';
  var orangeAccent = '#ff7f00';

  // ============================================
  // SVG COORDINATE MAPPING (1920x1080)
  // ============================================
  var svgWidth = 1920;
  var svgHeight = 1080;
  var marginLeft = 150;
  var marginRight = 200;
  var marginTop = 100;
  var marginBottom = 120;

  var plotWidth = svgWidth - marginLeft - marginRight;
  var plotHeight = svgHeight - marginTop - marginBottom;

  // Data ranges
  var xMin = -5;
  var xMax = 20;
  var yMin = 50;
  var yMax = 90;

  function xToSvg(val) {
    return marginLeft + ((val - xMin) / (xMax - xMin)) * plotWidth;
  }

  function yToSvg(val) {
    return marginTop + ((yMax - val) / (yMax - yMin)) * plotHeight;
  }

  // ============================================
  // SVG ELEMENT CREATION HELPERS
  // ============================================
  var svgNS = "http://www.w3.org/2000/svg";
  var svg = null;

  function createLine(x1, y1, x2, y2, stroke, strokeWidth, id) {
    var line = document.createElementNS(svgNS, 'line');
    line.setAttribute('x1', x1);
    line.setAttribute('y1', y1);
    line.setAttribute('x2', x2);
    line.setAttribute('y2', y2);
    line.setAttribute('stroke', stroke || '#333');
    line.setAttribute('stroke-width', strokeWidth || 2);
    if (id) line.setAttribute('id', id);
    return line;
  }

  function createText(x, y, text, className, fill, id) {
    var textEl = document.createElementNS(svgNS, 'text');
    textEl.setAttribute('x', x);
    textEl.setAttribute('y', y);
    textEl.setAttribute('fill', fill || '#333');
    if (className) textEl.setAttribute('class', className);
    if (id) textEl.setAttribute('id', id);
    textEl.textContent = text;
    return textEl;
  }

  function createCircle(cx, cy, r, fill, className, id) {
    var circle = document.createElementNS(svgNS, 'circle');
    circle.setAttribute('cx', cx);
    circle.setAttribute('cy', cy);
    circle.setAttribute('r', r);
    circle.setAttribute('fill', fill);
    if (className) circle.setAttribute('class', className);
    if (id) circle.setAttribute('id', id);
    return circle;
  }

  function createPolygon(points, fill, className, id) {
    var polygon = document.createElementNS(svgNS, 'polygon');
    polygon.setAttribute('points', points);
    polygon.setAttribute('fill', fill);
    if (className) polygon.setAttribute('class', className);
    if (id) polygon.setAttribute('id', id);
    return polygon;
  }

  function createRect(x, y, width, height, fill, rx, id) {
    var rect = document.createElementNS(svgNS, 'rect');
    rect.setAttribute('x', x);
    rect.setAttribute('y', y);
    rect.setAttribute('width', width);
    rect.setAttribute('height', height);
    rect.setAttribute('fill', fill);
    rect.setAttribute('rx', rx || 0);
    if (id) rect.setAttribute('id', id);
    return rect;
  }

  function createGroup(id, className) {
    var g = document.createElementNS(svgNS, 'g');
    if (id) g.setAttribute('id', id);
    if (className) g.setAttribute('class', className);
    return g;
  }

  function trianglePoints(cx, cy, size) {
    size = size || 10;
    var h = size * Math.sqrt(3) / 2;
    return cx + ',' + (cy - h) + ' ' + (cx - size) + ',' + (cy + h) + ' ' + (cx + size) + ',' + (cy + h);
  }

  // ============================================
  // BUILD SVG ELEMENTS
  // ============================================
  function buildSVG() {
    var container = document.getElementById('grmc-container');
    if (!container) {
      console.error('GRMC animation container not found');
      return false;
    }

    // Create SVG dynamically
    svg = document.createElementNS(svgNS, 'svg');
    svg.setAttribute('viewBox', '0 0 1920 1080');
    svg.setAttribute('id', 'grmc-svg');
    container.appendChild(svg);

    // Background rounded rectangle
    var bgRect = createRect(40, 20, svgWidth - 80, svgHeight - 40, 'rgba(0, 0, 0, 0.75)', 20, 'grmc-bg-rect');
    bgRect.setAttribute('class', 'grmc-hidden grmc-fade-in');
    svg.appendChild(bgRect);

    // Title
    var title = createText(svgWidth / 2, 70, 'Group Mean Centering', 'grmc-title grmc-hidden grmc-fade-in', '#ffffff', 'grmc-main-title');
    svg.appendChild(title);

    // Axes group
    var axisGroup = createGroup('grmc-axis-group', 'grmc-hidden grmc-fade-in');

    // X-axis line
    axisGroup.appendChild(createLine(xToSvg(xMin), yToSvg(yMin), xToSvg(xMax), yToSvg(yMin), '#ffffff', 2));

    // Y-axis line
    axisGroup.appendChild(createLine(xToSvg(xMin), yToSvg(yMin), xToSvg(xMin), yToSvg(yMax), '#ffffff', 2));

    // X-axis ticks and labels
    for (var val = -5; val <= 20; val += 5) {
      var x = xToSvg(val);
      axisGroup.appendChild(createLine(x, yToSvg(yMin), x, yToSvg(yMin) + 8, '#ffffff', 2));
      var label = createText(x, yToSvg(yMin) + 30, val.toString(), 'grmc-tick-label', '#ffffff');
      axisGroup.appendChild(label);
    }

    // Y-axis ticks and labels
    for (var val = 50; val <= 90; val += 10) {
      var y = yToSvg(val);
      axisGroup.appendChild(createLine(xToSvg(xMin) - 8, y, xToSvg(xMin), y, '#ffffff', 2));
      var label = createText(xToSvg(xMin) - 40, y + 6, val.toString(), 'grmc-tick-label', '#ffffff');
      label.setAttribute('text-anchor', 'end');
      axisGroup.appendChild(label);
    }

    // X-axis label
    var xAxisLabel = createText(svgWidth / 2, yToSvg(yMin) + 80, 'Years of Education (Uncentered)', 'grmc-axis-label', '#ffffff', 'grmc-x-axis-label');
    axisGroup.appendChild(xAxisLabel);

    // Y-axis label (rotated)
    var yAxisLabel = createText(0, 0, 'Performance Rating', 'grmc-axis-label-y', '#ffffff');
    yAxisLabel.setAttribute('transform', 'translate(60, ' + (svgHeight / 2) + ') rotate(-90)');
    axisGroup.appendChild(yAxisLabel);

    svg.appendChild(axisGroup);

    // Grid lines
    var gridGroup = createGroup('grmc-grid-group', 'grmc-hidden grmc-fade-in');
    for (var val = -5; val <= 20; val += 5) {
      if (val !== xMin) {
        var line = createLine(xToSvg(val), yToSvg(yMin), xToSvg(val), yToSvg(yMax), 'rgba(255,255,255,0.15)', 1);
        gridGroup.appendChild(line);
      }
    }
    for (var val = 60; val <= 90; val += 10) {
      var line = createLine(xToSvg(xMin), yToSvg(val), xToSvg(xMax), yToSvg(val), 'rgba(255,255,255,0.15)', 1);
      gridGroup.appendChild(line);
    }
    svg.appendChild(gridGroup);

    // Old Program regression line group (separate for independent animation)
    var oldRegLineGroup = createGroup('grmc-old-reg-line-group', 'grmc-hidden grmc-fade-in');

    var oldLineX1 = 12, oldLineX2 = 17;
    var oldLineY1 = interceptOld + slope * oldLineX1;
    var oldLineY2 = interceptOld + slope * oldLineX2;

    var oldRegLine = createLine(xToSvg(oldLineX1), yToSvg(oldLineY1), xToSvg(oldLineX2), yToSvg(oldLineY2), coralColor, 3, 'grmc-old-reg-line');
    oldRegLine.setAttribute('class', 'grmc-reg-line');
    oldRegLineGroup.appendChild(oldRegLine);
    svg.appendChild(oldRegLineGroup);

    // New Program regression line group (separate for independent animation)
    var newRegLineGroup = createGroup('grmc-new-reg-line-group', 'grmc-hidden grmc-fade-in');

    var newLineX1 = 15, newLineX2 = 20;
    var newLineY1 = interceptNew + slope * newLineX1;
    var newLineY2 = interceptNew + slope * newLineX2;

    var newRegLine = createLine(xToSvg(newLineX1), yToSvg(newLineY1), xToSvg(newLineX2), yToSvg(newLineY2), tealColor, 3, 'grmc-new-reg-line');
    newRegLine.setAttribute('class', 'grmc-reg-line');
    newRegLineGroup.appendChild(newRegLine);
    svg.appendChild(newRegLineGroup);

    // Old Program points group
    var oldPointsGroup = createGroup('grmc-old-points-group', 'grmc-hidden grmc-fade-in');

    for (var i = 0; i < oldEdu.length; i++) {
      var x = xToSvg(oldEdu[i]);
      var y = yToSvg(oldPerf[i]);
      var circle = createCircle(x, y, 10, coralColor, 'grmc-data-point-old', 'grmc-old-point-' + i);
      oldPointsGroup.appendChild(circle);
    }

    svg.appendChild(oldPointsGroup);

    // New Program points group
    var newPointsGroup = createGroup('grmc-new-points-group', 'grmc-hidden grmc-fade-in');

    for (var i = 0; i < newEdu.length; i++) {
      var x = xToSvg(newEdu[i]);
      var y = yToSvg(newPerf[i]);
      var triangle = createPolygon(trianglePoints(x, y, 10), tealColor, 'grmc-data-triangle-new', 'grmc-new-point-' + i);
      triangle.setAttribute('data-orig-x', x);
      triangle.setAttribute('data-y', y);
      newPointsGroup.appendChild(triangle);
    }

    svg.appendChild(newPointsGroup);

    // Legend
    var legendGroup = createGroup('grmc-legend-group', 'grmc-hidden grmc-fade-in');
    var legendX = svgWidth - 280;
    var legendY = 700;

    legendGroup.appendChild(createText(legendX, legendY, 'program', 'grmc-legend-title', '#ffffff'));
    legendGroup.appendChild(createCircle(legendX + 10, legendY + 35, 8, coralColor));
    legendGroup.appendChild(createText(legendX + 30, legendY + 40, 'Old Program', 'grmc-legend-text', '#ffffff'));
    legendGroup.appendChild(createPolygon(trianglePoints(legendX + 10, legendY + 65, 8), tealColor));
    legendGroup.appendChild(createText(legendX + 30, legendY + 70, 'New Program', 'grmc-legend-text', '#ffffff'));

    svg.appendChild(legendGroup);

    // Starting label
    var startLabel = createText(svgWidth / 2, yToSvg(55), 'UNCENTERED: Intercept = performance when education = 0', 'grmc-annotation grmc-hidden grmc-fade-in', '#ffffff', 'grmc-start-label');
    startLabel.setAttribute('font-size', '28px');
    svg.appendChild(startLabel);

    // Orange zero line group (initial)
    var grayZeroGroup = createGroup('grmc-gray-zero-group', 'grmc-hidden grmc-fade-in');
    var zeroX = xToSvg(0);
    var zeroLine = createLine(zeroX, yToSvg(yMax), zeroX, yToSvg(yMin), orangeAccent, 3);
    zeroLine.setAttribute('stroke-dasharray', '8,4');
    grayZeroGroup.appendChild(zeroLine);

    var zeroLabel = createText(zeroX + 8, yToSvg(90), 'Zero', 'grmc-zero-label', orangeAccent);
    grayZeroGroup.appendChild(zeroLabel);
    var zeroLabel2 = createText(zeroX + 8, yToSvg(90) + 20, '(unrealistic)', 'grmc-zero-label', orangeAccent);
    grayZeroGroup.appendChild(zeroLabel2);

    svg.appendChild(grayZeroGroup);

    // Bracket annotation group
    var bracketGroup = createGroup('grmc-bracket-group', 'grmc-hidden grmc-fade-in');

    var bracketX = 16;
    var bracketSvgX = xToSvg(bracketX);
    var capLength = 12;
    // Position vertical line so horizontal caps END at the regression lines (bracketSvgX)
    var vertLineX = bracketSvgX - capLength;
    var yOldLine = interceptOld + slope * bracketX;
    var yNewLine = interceptNew + slope * bracketX;

    var bracketTopY = yToSvg(yNewLine);
    var bracketBottomY = yToSvg(yOldLine);

    var bracketColor = '#ffff00';
    var bracketWidth = 4;

    bracketGroup.appendChild(createLine(vertLineX, bracketTopY, vertLineX, bracketBottomY, bracketColor, bracketWidth, 'grmc-bracket-vertical'));

    bracketGroup.appendChild(createLine(vertLineX, bracketTopY, bracketSvgX, bracketTopY, bracketColor, bracketWidth, 'grmc-bracket-cap-top'));
    bracketGroup.appendChild(createLine(vertLineX, bracketBottomY, bracketSvgX, bracketBottomY, bracketColor, bracketWidth, 'grmc-bracket-cap-bottom'));

    var labelBgWidth = 85;
    var labelBgHeight = 42;
    var labelBgX = bracketSvgX + 8;
    var labelBgY = (bracketTopY + bracketBottomY) / 2 - labelBgHeight / 2;

    var labelBg = createRect(labelBgX, labelBgY, labelBgWidth, labelBgHeight, 'rgba(0, 0, 0, 0.9)', 6, 'grmc-bracket-label-bg');
    labelBg.setAttribute('stroke', bracketColor);
    labelBg.setAttribute('stroke-width', '3');
    bracketGroup.appendChild(labelBg);

    var bracketLabel = createText(labelBgX + labelBgWidth / 2, labelBgY + 30, '5.33', 'grmc-bracket-label', bracketColor, 'grmc-bracket-label-text');
    bracketLabel.setAttribute('text-anchor', 'middle');
    bracketLabel.setAttribute('font-size', '28px');
    bracketLabel.setAttribute('font-weight', 'bold');
    bracketGroup.appendChild(bracketLabel);

    bracketGroup.setAttribute('data-base-x', bracketSvgX);

    svg.appendChild(bracketGroup);

    // Centering annotation
    var centerAnnotation = createText(svgWidth / 2, 170, "We will subtract each group's own mean from its education values", 'grmc-annotation grmc-hidden grmc-fade-in', '#ffff00', 'grmc-center-annotation');
    svg.appendChild(centerAnnotation);

    // Group means annotation
    var groupMeansGroup = createGroup('grmc-group-means-group', 'grmc-hidden grmc-fade-in');

    var oldMeanX = xToSvg(oldMeanEdu);
    var oldMeanLine = createLine(oldMeanX, yToSvg(yMin) - 5, oldMeanX, yToSvg(yMin) - 35, coralColor, 3);
    groupMeansGroup.appendChild(oldMeanLine);
    var oldMeanLabel = createText(oldMeanX, yToSvg(yMin) - 45, 'Old: ' + oldMeanEdu, 'grmc-group-mean-label', coralColor);
    oldMeanLabel.setAttribute('text-anchor', 'middle');
    groupMeansGroup.appendChild(oldMeanLabel);

    var newMeanX = xToSvg(newMeanEdu);
    var newMeanLine = createLine(newMeanX, yToSvg(yMin) - 5, newMeanX, yToSvg(yMin) - 35, tealColor, 3);
    groupMeansGroup.appendChild(newMeanLine);
    var newMeanLabel = createText(newMeanX, yToSvg(yMin) - 45, 'New: ' + newMeanEdu, 'grmc-group-mean-label', tealColor);
    newMeanLabel.setAttribute('text-anchor', 'middle');
    groupMeansGroup.appendChild(newMeanLabel);

    svg.appendChild(groupMeansGroup);

    // Orange zero line group (final)
    var orangeZeroGroup = createGroup('grmc-orange-zero-group', 'grmc-hidden grmc-fade-in');
    var orangeZeroX = xToSvg(0);
    var orangeZeroLine = createLine(orangeZeroX, yToSvg(yMax), orangeZeroX, yToSvg(yMin), orangeAccent, 3);
    orangeZeroLine.setAttribute('stroke-dasharray', '8,4');
    orangeZeroGroup.appendChild(orangeZeroLine);

    var orangeZeroLabel = createText(orangeZeroX + 8, yToSvg(90), "Zero = Each Group's Mean", 'grmc-zero-label', orangeAccent);
    orangeZeroGroup.appendChild(orangeZeroLabel);

    svg.appendChild(orangeZeroGroup);

    // Centered X-axis label
    var centeredXLabel = createText(svgWidth / 2, yToSvg(yMin) + 80, 'Education (Group Mean Centered)', 'grmc-axis-label grmc-hidden grmc-fade-in', orangeAccent, 'grmc-centered-x-label');
    svg.appendChild(centeredXLabel);

    // Highlight text
    var highlightText = createText(svgWidth / 2, yToSvg(55), "Zero now represents each group's average education level", 'grmc-annotation grmc-hidden grmc-fade-in', orangeAccent, 'grmc-highlight-text');
    svg.appendChild(highlightText);

    console.log('GRMC animation SVG built successfully');
    return true;
  }

  // ============================================
  // SHOW/HIDE HELPERS
  // ============================================
  function showEl(id) {
    var el = document.getElementById(id);
    if (el) el.classList.remove('grmc-hidden');
  }

  function hideEl(id) {
    var el = document.getElementById(id);
    if (el) el.classList.add('grmc-hidden');
  }

  // ============================================
  // ANIMATION HELPERS
  // ============================================
  function animateOldProgramShift() {
    var shiftAmount = oldMeanEdu;
    // Use SVG coordinate shift (not CSS pixels)
    var shiftSvgUnits = (shiftAmount / (xMax - xMin)) * plotWidth;

    // Animate Old Program circles (using SVG attribute - correct)
    for (var i = 0; i < oldEdu.length; i++) {
      var point = document.getElementById('grmc-old-point-' + i);
      var newX = xToSvg(oldEdu[i] - shiftAmount);
      point.setAttribute('cx', newX);
    }

    // Animate Old Program regression line using SVG transform attribute
    var oldRegLineGroup = document.getElementById('grmc-old-reg-line-group');
    oldRegLineGroup.setAttribute('transform', 'translate(-' + shiftSvgUnits + ', 0)');
  }

  function animateNewProgramShift() {
    var shiftAmount = newMeanEdu;
    // Use SVG coordinate shift (not CSS pixels)
    var shiftSvgUnits = (shiftAmount / (xMax - xMin)) * plotWidth;

    // Animate New Program triangles - update points attribute
    for (var i = 0; i < newEdu.length; i++) {
      var triangle = document.getElementById('grmc-new-point-' + i);
      var newX = xToSvg(newEdu[i] - shiftAmount);
      var y = yToSvg(newPerf[i]);
      triangle.setAttribute('points', trianglePoints(newX, y, 10));
    }

    // Animate New Program regression line using SVG transform attribute
    var newRegLineGroup = document.getElementById('grmc-new-reg-line-group');
    newRegLineGroup.setAttribute('transform', 'translate(-' + shiftSvgUnits + ', 0)');
  }

  function animateBracketToZero() {
    var yOldAtZero = interceptOld + slope * oldMeanEdu;
    var yNewAtZero = interceptNew + slope * newMeanEdu;

    var zeroSvgX = xToSvg(0);
    var capLength = 12;
    // Position vertical line so that horizontal caps END at x=0
    var vertLineX = zeroSvgX - capLength;
    var bracketTopY = yToSvg(yNewAtZero);
    var bracketBottomY = yToSvg(yOldAtZero);

    // Update vertical line
    var vertLine = document.getElementById('grmc-bracket-vertical');
    vertLine.setAttribute('x1', vertLineX);
    vertLine.setAttribute('x2', vertLineX);
    vertLine.setAttribute('y1', bracketTopY);
    vertLine.setAttribute('y2', bracketBottomY);

    // Update caps (extend right from vertical line to x=0)
    var capTop = document.getElementById('grmc-bracket-cap-top');
    capTop.setAttribute('x1', vertLineX);
    capTop.setAttribute('x2', zeroSvgX);
    capTop.setAttribute('y1', bracketTopY);
    capTop.setAttribute('y2', bracketTopY);

    var capBottom = document.getElementById('grmc-bracket-cap-bottom');
    capBottom.setAttribute('x1', vertLineX);
    capBottom.setAttribute('x2', zeroSvgX);
    capBottom.setAttribute('y1', bracketBottomY);
    capBottom.setAttribute('y2', bracketBottomY);

    // Update label background position
    var labelBgWidth = 85;
    var labelBgHeight = 42;
    var labelBgX = zeroSvgX + 8;
    var labelBgY = (bracketTopY + bracketBottomY) / 2 - labelBgHeight / 2;

    var labelBg = document.getElementById('grmc-bracket-label-bg');
    labelBg.setAttribute('x', labelBgX);
    labelBg.setAttribute('y', labelBgY);

    // Update label text position and value
    var labelText = document.getElementById('grmc-bracket-label-text');
    labelText.setAttribute('x', labelBgX + labelBgWidth / 2);
    labelText.setAttribute('y', labelBgY + 30);
    labelText.textContent = '13.72';
  }

  // ============================================
  // RESET ANIMATION
  // ============================================
  function resetAnimation() {
    console.log('GRMC: Resetting animation to initial state');

    // Hide all animated elements
    hideEl('grmc-bg-rect');
    hideEl('grmc-main-title');
    hideEl('grmc-axis-group');
    hideEl('grmc-grid-group');
    hideEl('grmc-old-points-group');
    hideEl('grmc-new-points-group');
    hideEl('grmc-old-reg-line-group');
    hideEl('grmc-new-reg-line-group');
    hideEl('grmc-legend-group');
    hideEl('grmc-start-label');
    hideEl('grmc-gray-zero-group');
    hideEl('grmc-bracket-group');
    hideEl('grmc-center-annotation');
    hideEl('grmc-group-means-group');
    hideEl('grmc-orange-zero-group');
    hideEl('grmc-centered-x-label');
    hideEl('grmc-highlight-text');

    // Reset title text and color
    var title = document.getElementById('grmc-main-title');
    if (title) {
      title.textContent = 'Group Mean Centering';
      title.setAttribute('fill', '#ffffff');
    }

    // Reset x-axis label visibility
    var xAxisLabel = document.getElementById('grmc-x-axis-label');
    if (xAxisLabel) {
      xAxisLabel.style.opacity = '1';
    }

    // Reset Old Program point positions
    for (var i = 0; i < oldEdu.length; i++) {
      var point = document.getElementById('grmc-old-point-' + i);
      if (point) {
        point.setAttribute('cx', xToSvg(oldEdu[i]));
      }
    }

    // Reset New Program triangle positions (update points attribute)
    for (var i = 0; i < newEdu.length; i++) {
      var triangle = document.getElementById('grmc-new-point-' + i);
      if (triangle) {
        var x = xToSvg(newEdu[i]);
        var y = yToSvg(newPerf[i]);
        triangle.setAttribute('points', trianglePoints(x, y, 10));
      }
    }

    // Reset Old regression line transform (SVG attribute)
    var oldRegLineGroup = document.getElementById('grmc-old-reg-line-group');
    if (oldRegLineGroup) {
      oldRegLineGroup.removeAttribute('transform');
    }

    // Reset New regression line transform (SVG attribute)
    var newRegLineGroup = document.getElementById('grmc-new-reg-line-group');
    if (newRegLineGroup) {
      newRegLineGroup.removeAttribute('transform');
    }

    // Reset bracket position and value
    var bracketX = 16;
    var bracketSvgX = xToSvg(bracketX);
    var capLength = 12;
    // Position vertical line so horizontal caps END at the regression lines (bracketSvgX)
    var vertLineX = bracketSvgX - capLength;
    var yOldLine = interceptOld + slope * bracketX;
    var yNewLine = interceptNew + slope * bracketX;
    var bracketTopY = yToSvg(yNewLine);
    var bracketBottomY = yToSvg(yOldLine);

    var vertLine = document.getElementById('grmc-bracket-vertical');
    if (vertLine) {
      vertLine.setAttribute('x1', vertLineX);
      vertLine.setAttribute('x2', vertLineX);
      vertLine.setAttribute('y1', bracketTopY);
      vertLine.setAttribute('y2', bracketBottomY);
    }

    var capTop = document.getElementById('grmc-bracket-cap-top');
    if (capTop) {
      capTop.setAttribute('x1', vertLineX);
      capTop.setAttribute('x2', bracketSvgX);
      capTop.setAttribute('y1', bracketTopY);
      capTop.setAttribute('y2', bracketTopY);
    }

    var capBottom = document.getElementById('grmc-bracket-cap-bottom');
    if (capBottom) {
      capBottom.setAttribute('x1', vertLineX);
      capBottom.setAttribute('x2', bracketSvgX);
      capBottom.setAttribute('y1', bracketBottomY);
      capBottom.setAttribute('y2', bracketBottomY);
    }

    var labelBgWidth = 85;
    var labelBgHeight = 42;
    var labelBgX = bracketSvgX + 8;
    var labelBgY = (bracketTopY + bracketBottomY) / 2 - labelBgHeight / 2;

    var labelBg = document.getElementById('grmc-bracket-label-bg');
    if (labelBg) {
      labelBg.setAttribute('x', labelBgX);
      labelBg.setAttribute('y', labelBgY);
    }

    var labelText = document.getElementById('grmc-bracket-label-text');
    if (labelText) {
      labelText.setAttribute('x', labelBgX + labelBgWidth / 2);
      labelText.setAttribute('y', labelBgY + 30);
      labelText.textContent = '5.33';
    }
  }

  // ============================================
  // RENDER FRAME
  // ============================================
  function renderFrame(frame) {
    console.log('GRMC: Rendering frame:', frame);

    switch (frame) {
      case 1: // Title + background
        showEl('grmc-bg-rect');
        showEl('grmc-main-title');
        break;

      case 2: // Scatterplot (axes, points, lines, legend)
        showEl('grmc-axis-group');
        showEl('grmc-grid-group');
        showEl('grmc-old-points-group');
        showEl('grmc-new-points-group');
        showEl('grmc-old-reg-line-group');
        showEl('grmc-new-reg-line-group');
        showEl('grmc-legend-group');
        break;

      case 3: // Zero line
        showEl('grmc-gray-zero-group');
        break;

      case 4: // Show bracket at x=16
        showEl('grmc-bracket-group');
        break;

      case 5: // Centering annotation
        showEl('grmc-center-annotation');
        break;

      case 6: // Show group means
        showEl('grmc-group-means-group');
        break;

      case 7: // ANIMATE - shift Old Program left by 14.6
        animateOldProgramShift();
        break;

      case 8: // Pause for comprehension
        // Just a pause - no new elements
        break;

      case 9: // ANIMATE - shift New Program left by 17.0
        hideEl('grmc-center-annotation');
        hideEl('grmc-group-means-group');
        animateNewProgramShift();
        break;

      case 10: // Update bracket - move to x=0, change value to 13.72
        animateBracketToZero();
        break;

      case 11: // Final state - orange title, updated labels
        hideEl('grmc-start-label');
        hideEl('grmc-gray-zero-group');
        var xAxisLabel = document.getElementById('grmc-x-axis-label');
        if (xAxisLabel) xAxisLabel.style.opacity = '0';

        showEl('grmc-orange-zero-group');
        showEl('grmc-centered-x-label');

        var title = document.getElementById('grmc-main-title');
        if (title) {
          title.textContent = "GROUP MEAN CENTERED: Intercept = performance at each group's mean education";
          title.setAttribute('fill', orangeAccent);
        }

        showEl('grmc-highlight-text');
        break;

      case 12: // Fade out
        hideEl('grmc-bg-rect');
        hideEl('grmc-main-title');
        hideEl('grmc-axis-group');
        hideEl('grmc-grid-group');
        hideEl('grmc-old-points-group');
        hideEl('grmc-new-points-group');
        hideEl('grmc-old-reg-line-group');
        hideEl('grmc-new-reg-line-group');
        hideEl('grmc-legend-group');
        hideEl('grmc-bracket-group');
        hideEl('grmc-orange-zero-group');
        hideEl('grmc-centered-x-label');
        hideEl('grmc-highlight-text');
        break;
    }
  }

  // ============================================
  // INITIALIZATION
  // ============================================
  function init() {
    console.log('GRMC: Initializing animation...');

    if (!buildSVG()) {
      console.error('GRMC: Failed to build SVG');
      return;
    }

    if (typeof Reveal !== 'undefined') {
      console.log('GRMC: Reveal.js detected, attaching fragment listener');

      Reveal.on('fragmentshown', function(event) {
        var currentSlide = Reveal.getCurrentSlide();
        var slideId = currentSlide ? currentSlide.getAttribute('id') : null;
        if (slideId !== 'group-mean-centered-scatter-animation') {
          return;
        }
        var idx = event.fragment.getAttribute('data-fragment-index');
        console.log('GRMC: Fragment shown, index:', idx);
        if (idx) renderFrame(parseInt(idx));
      });

      Reveal.on('slidechanged', function(event) {
        var slideId = event.currentSlide.getAttribute('id');
        if (slideId === 'group-mean-centered-scatter-animation') {
          console.log('GRMC: Entering animation slide, resetting...');
          resetAnimation();
        }
      });
    } else {
      console.warn('GRMC: Reveal.js not found');
    }
  }

  // Initialize when Reveal is ready
  if (typeof Reveal !== 'undefined' && Reveal.isReady && Reveal.isReady()) {
    init();
  } else if (typeof Reveal !== 'undefined') {
    Reveal.on('ready', init);
  } else {
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        if (typeof Reveal !== 'undefined') {
          if (Reveal.isReady && Reveal.isReady()) {
            init();
          } else {
            Reveal.on('ready', init);
          }
        }
      }, 100);
    });
  }
})();
</script>
</section>
<section id="comparing-uncentered-and-group-mean-centered-models" class="slide level2 smaller" data-transition="none">
<h2>Comparing Uncentered and Group Mean Centered Models</h2>
<p><strong>Uncentered Model:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="fu">lm</span>(performance <span class="sc">~</span> program <span class="sc">+</span> education, <span class="at">data =</span> onboard_data) <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" style="margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">15.542</td>
<td style="text-align: right;">9.015</td>
<td style="text-align: right;">1.724</td>
<td style="text-align: right;">0.103</td>
<td style="text-align: right;">-3.478</td>
<td style="text-align: right;">34.561</td>
</tr>
<tr class="even">
<td style="text-align: left;">programnew</td>
<td style="text-align: right;">5.333</td>
<td style="text-align: right;">2.369</td>
<td style="text-align: right;">2.251</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">10.331</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education</td>
<td style="text-align: right;">3.494</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">5.721</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.206</td>
<td style="text-align: right;">4.783</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Group Mean Centered Model:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="fu">lm</span>(performance <span class="sc">~</span> program <span class="sc">+</span> education_gc, <span class="at">data =</span> onboard_group_centered) <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" style="margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">66.560</td>
<td style="text-align: right;">1.316</td>
<td style="text-align: right;">50.586</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">63.784</td>
<td style="text-align: right;">69.336</td>
</tr>
<tr class="even">
<td style="text-align: left;">programnew</td>
<td style="text-align: right;">13.720</td>
<td style="text-align: right;">1.861</td>
<td style="text-align: right;">7.373</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9.794</td>
<td style="text-align: right;">17.646</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education (group centered)</td>
<td style="text-align: right;">3.494</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">5.721</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.206</td>
<td style="text-align: right;">4.783</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Key differences:</strong></p>
<ul>
<li><strong>Program coefficient:</strong> Uncentered ‚Üí adjusted for education; Group mean ‚Üí NOT adjusted (direction of change depends on the data)</li>
<li><strong>Interpretation:</strong> Uncentered compares groups at the <em>same</em> education level; Group mean compares groups at their <em>own</em> average education levels</li>
<li><strong>Education slope:</strong> Identical in both models‚Äîcentering doesn‚Äôt change slopes</li>
</ul>
</section>
<section id="interpreting-the-intercept" class="slide level2" data-transition="none">
<h2>Interpreting the Intercept</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Coefficient</th>
<th>Uncentered</th>
<th>Grand Mean</th>
<th>Group Mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>15.54</td>
<td>70.75</td>
<td>66.56</td>
</tr>
<tr class="even">
<td>Program (new vs old)</td>
<td>5.33</td>
<td>5.33</td>
<td>13.72</td>
</tr>
<tr class="odd">
<td>Education slope</td>
<td>3.49</td>
<td>3.49</td>
<td>3.49</td>
</tr>
</tbody>
</table>
<p><strong>What does the intercept mean in each model?</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 17%">
<col style="width: 42%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Intercept Value</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Uncentered</td>
<td>15.54</td>
<td>Predicted performance for old-program employees with <strong>0 years of education</strong> (unrealistic!)</td>
</tr>
<tr class="even">
<td>Grand Mean</td>
<td>70.75</td>
<td>Predicted performance for old-program employees with <strong>average education for the overall sample</strong> (15.8 years)</td>
</tr>
<tr class="odd">
<td>Group Mean</td>
<td>66.56</td>
<td>Predicted performance for old-program employees with <strong>average education for their group</strong> (14.6 years)</td>
</tr>
</tbody>
</table>
<p><strong>Key insight:</strong> The intercept value changes because ‚Äúzero‚Äù on the education scale means something different in each model. Grand mean and group mean centering give interpretable intercepts.</p>
</section>
<section id="interpreting-the-program-coefficient" class="slide level2" data-transition="none">
<h2>Interpreting the Program Coefficient</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Coefficient</th>
<th>Uncentered</th>
<th>Grand Mean</th>
<th>Group Mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>15.54</td>
<td>70.75</td>
<td>66.56</td>
</tr>
<tr class="even">
<td>Program (new vs old)</td>
<td>5.33</td>
<td>5.33</td>
<td>13.72</td>
</tr>
<tr class="odd">
<td>Education slope</td>
<td>3.49</td>
<td>3.49</td>
<td>3.49</td>
</tr>
</tbody>
</table>
<p><strong>What does the program coefficient mean in each model?</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 18%">
<col style="width: 37%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Program Coef</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Uncentered</td>
<td>5.33</td>
<td>Difference between programs for employees with the <strong>same education level</strong> (adjusted)</td>
</tr>
<tr class="even">
<td>Grand Mean</td>
<td>5.33</td>
<td>Difference between programs for employees with the <strong>same education level</strong> (adjusted)‚Äîidentical to uncentered!</td>
</tr>
<tr class="odd">
<td>Group Mean</td>
<td>13.72</td>
<td>Difference between programs comparing employees at their <strong>own group‚Äôs average education</strong> (unadjusted!)</td>
</tr>
</tbody>
</table>
<p><strong>Critical insight:</strong> Group mean centering changes the program coefficient because it compares groups at <em>different</em> education levels (each group‚Äôs own mean). This is equivalent to the unadjusted analysis‚Äîit does NOT control for education!</p>
</section>
<section id="interpreting-the-education-slope" class="slide level2" data-transition="none">
<h2>Interpreting the Education Slope</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Coefficient</th>
<th>Uncentered</th>
<th>Grand Mean</th>
<th>Group Mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>15.54</td>
<td>70.75</td>
<td>66.56</td>
</tr>
<tr class="even">
<td>Program (new vs old)</td>
<td>5.33</td>
<td>5.33</td>
<td>13.72</td>
</tr>
<tr class="odd">
<td>Education slope</td>
<td>3.49</td>
<td>3.49</td>
<td>3.49</td>
</tr>
</tbody>
</table>
<p><strong>What does the education slope mean in each model?</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 17%">
<col style="width: 42%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Education Slope</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Uncentered</td>
<td>3.49</td>
<td>For each additional year of education, performance increases by 3.49 points, holding program constant</td>
</tr>
<tr class="even">
<td>Grand Mean</td>
<td>3.49</td>
<td>For each additional year of education, performance increases by 3.49 points, holding program constant</td>
</tr>
<tr class="odd">
<td>Group Mean</td>
<td>3.49</td>
<td>For each additional year of education, performance increases by 3.49 points, holding program constant</td>
</tr>
</tbody>
</table>
<p><strong>Key insight:</strong> The education slope is <strong>identical</strong> across all three models (3.49). Centering shifts where ‚Äúzero‚Äù is on the x-axis, but it does not change the steepness of the line. The relationship between education and performance remains the same.</p>
</section>
<section id="choosing-between-centering-methods" class="slide level2 size-85" data-transition="none">
<h2>Choosing Between Centering Methods</h2>
<p><strong>When to use Grand Mean Centering:</strong></p>
<ul>
<li>You want a meaningful intercept (reference group performance at average education)</li>
<li>You want to keep between-group differences in the predictor</li>
<li>You‚Äôre asking: ‚ÄúWhat‚Äôs the program effect for people with the <em>same</em> education?‚Äù</li>
<li>Standard regression and ANCOVA contexts</li>
</ul>
<p><strong>When to use Group Mean Centering:</strong></p>
<ul>
<li>You want to separate within-group from between-group effects</li>
<li>You‚Äôre preparing for <strong>multilevel modeling</strong> (students within schools, employees within companies)</li>
<li>You‚Äôre asking: ‚ÄúWhat‚Äôs the program effect comparing people at their group‚Äôs typical X level?‚Äù (Note: this compares groups at <em>different</em> absolute X values)</li>
<li>You want to examine within-group relationships separately from between-group differences</li>
</ul>
<p><strong>Decision Guide:</strong></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Your Question</th>
<th>Centering Choice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Effect of group, holding X constant?</td>
<td>Grand mean</td>
</tr>
<tr class="even">
<td>Simple ANCOVA interpretation?</td>
<td>Grand mean</td>
</tr>
<tr class="odd">
<td>Pure within-group effect of X?</td>
<td>Group mean</td>
</tr>
<tr class="even">
<td>Preparing for multilevel models?</td>
<td>Group mean</td>
</tr>
</tbody>
</table>
<p><strong>Rule of thumb:</strong> If you want to compare groups at the <em>same</em> X value (standard ANCOVA), use grand mean centering. If you want to compare groups at their <em>respective</em> mean X values (common in multilevel modeling), use group mean centering.</p>
</section>
<section id="when-group-mean-centering-is-appropriate" class="slide level2">
<h2>When group mean centering IS appropriate</h2>
<p>Group mean centering is useful when you want to compare individuals to their own group‚Äôs average rather than the overall average:</p>
<ul>
<li><p><strong>Students nested in schools:</strong> Does a student who has higher SES <em>relative to their school</em> perform better? (Separates within-school SES effects from between-school differences)</p></li>
<li><p><strong>Employees nested in departments:</strong> Does an employee with more experience <em>than their departmental average</em> receive higher ratings? (Controls for department-level experience norms)</p></li>
<li><p><strong>Patients nested in clinics:</strong> Does a patient with higher symptom severity <em>compared to others at their clinic</em> respond differently to treatment? (Accounts for clinic-level severity differences)</p></li>
<li><p><strong>Athletes on different teams:</strong> Does a player with higher training hours <em>relative to their team</em> show better performance? (Separates individual effort from team training culture)</p></li>
</ul>
<p><strong>Bottom line:</strong> For ANCOVA-style questions (‚ÄúDoes X work, controlling for Y?‚Äù), use grand mean centering. Group mean centering answers a different question: ‚ÄúDoes deviation from one‚Äôs group predict outcomes?‚Äù</p>
</section>
<section id="key-takeaways-centering" class="slide level2" data-transition="none">
<h2>Key Takeaways: Centering</h2>
<table class="caption-top">
<colgroup>
<col style="width: 18%">
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>Uncentered</th>
<th>Grand Mean</th>
<th>Group Mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Intercept</strong></td>
<td>Ref. group at edu = 0</td>
<td>Ref. group at overall mean</td>
<td>Ref. group at ref. group‚Äôs mean</td>
</tr>
<tr class="even">
<td><strong>Education slope</strong></td>
<td>Same</td>
<td>Same</td>
<td>Same</td>
</tr>
<tr class="odd">
<td><strong>Program coefficient</strong></td>
<td>Between-group diff at edu=0</td>
<td>Between-group diff at overall mean edu</td>
<td>Between-group diff (each group at own mean)</td>
</tr>
<tr class="even">
<td><strong>Use case</strong></td>
<td>Rarely meaningful</td>
<td>General interpretation</td>
<td>Multilevel models</td>
</tr>
</tbody>
</table>
<p><strong>The slopes are the same</strong>‚Äîcentering only changes the intercept interpretation!</p>
<p><strong>Coming soon:</strong> In multilevel modeling, group mean centering separates within-group from between-group effects.</p>
</section>
<section id="quick-reset" class="slide level2 content-minimal">
<h2>üßò Quick Reset</h2>
<p>We‚Äôve covered a lot of material on centering. Take a moment:</p>
<ul>
<li><strong>Stand up and stretch</strong> for 30 seconds</li>
<li><strong>Look away from your screen</strong> briefly</li>
</ul>
<div class="fragment">
<p>What‚Äôs coming next is one of the most important demonstrations in this course.</p>
<p>You‚Äôre about to see a ‚Äúhighly significant‚Äù finding <strong>completely vanish</strong>.</p>
</div>
</section>
<section id="critical-concept-ahead" class="slide level2 content-minimal">
<h2>‚ö†Ô∏è Critical Concept Ahead</h2>
<p>The next section demonstrates something that <strong>fundamentally changes how you interpret research findings</strong>.</p>
<p>You will see a ‚Äúhighly significant‚Äù result (p &lt; .001) <strong>completely disappear</strong> when we add one variable.</p>
<p>This is one of the most important lessons in the entire course. Stay with me.</p>
</section>
<section id="part-6-confoundinga-dramatic-example" class="slide level2 section-header" data-background="linear-gradient(135deg, #00591C 0%, #006F2D 50%, #008245 100%)">
<h2>Part 6: Confounding‚ÄîA Dramatic Example</h2>
<p><strong>Transition:</strong> In Part 4, we saw <strong>Partial Confounding</strong>‚Äîwhere the effect got smaller but stayed significant.</p>
<p>Now, we are going to see <strong>Total Confounding</strong>‚Äîwhere the effect completely disappears. This is the same mechanism (adjustment), just a more extreme case.</p>
</section>
<section id="what-is-confounding" class="slide level2 content-light">
<h2>What Is Confounding?</h2>
<p><strong>Confounding</strong> occurs when a third variable:</p>
<ol type="1">
<li>Is related to your predictor (X), AND</li>
<li>Is related to your outcome (Y)</li>
</ol>
<p>This creates a ‚Äúfalse‚Äù or ‚Äúinflated‚Äù relationship between X and Y.</p>
<p><strong>Plain English:</strong> Confounding is when something else explains the relationship you‚Äôre seeing, making you think X causes Y when really it‚Äôs the third variable doing the work.</p>
</section>
<section id="a-classic-example-ice-cream-and-drowning" class="slide level2 content-light">
<h2>A Classic Example: Ice Cream and Drowning</h2>
<p><strong>Observation:</strong> Ice cream sales are correlated with drowning deaths.</p>
<p><strong>Conclusion:</strong> Ice cream causes drowning? Ban ice cream!</p>
<p><strong>Reality:</strong> Both are caused by a <strong>confound</strong>‚Äîhot weather.</p>
<ul>
<li>Hot weather ‚Üí more ice cream sales</li>
<li>Hot weather ‚Üí more swimming ‚Üí more drowning</li>
</ul>
<p>Ice cream doesn‚Äôt cause drowning. The <em>apparent</em> relationship is confounded by temperature.</p>
</section>
<section id="real-world-example-simpsons-paradox" class="slide level2 content-light">
<h2>Real-World Example: Simpson‚Äôs Paradox</h2>
<p><strong>The Berkeley Admissions Case (1973):</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 18%">
<col style="width: 81%">
</colgroup>
<thead>
<tr class="header">
<th>Overall</th>
<th>Men admitted at higher rate than women</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>By department</td>
<td>Women admitted at equal or higher rates in several departments</td>
</tr>
</tbody>
</table>
<p>How? Women applied to more competitive departments. The ‚Äúgender effect‚Äù disappeared when department was held constant.</p>
<p>This is exactly what we‚Äôre doing with regression: revealing true effects by accounting for confounds.</p>
<p><em>Reference: Bickel, Hammel, &amp; O‚ÄôConnell (1975). Science.</em></p>
</section>
<section id="the-berkeley-data-actual-numbers" class="slide level2">
<h2>The Berkeley Data: Actual Numbers</h2>
<p><strong>Bickel, Hammel, &amp; O‚ÄôConnell (1975). <em>Science</em>, 187, 398-404.</strong></p>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th>Men</th>
<th>Women</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Overall admission rate</strong></td>
<td>44%</td>
<td>35%</td>
</tr>
<tr class="even">
<td><strong>Conclusion?</strong></td>
<td>Discrimination against women?</td>
<td></td>
</tr>
</tbody>
</table>
<p>But when examined <strong>by department</strong>:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Department</th>
<th>Men admitted</th>
<th>Women admitted</th>
<th>Women‚Äôs rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>62%</td>
<td>82%</td>
<td><strong>Higher</strong></td>
</tr>
<tr class="even">
<td>B</td>
<td>63%</td>
<td>68%</td>
<td><strong>Higher</strong></td>
</tr>
<tr class="odd">
<td>C</td>
<td>37%</td>
<td>34%</td>
<td>Similar</td>
</tr>
<tr class="even">
<td>D</td>
<td>33%</td>
<td>35%</td>
<td>Similar</td>
</tr>
</tbody>
</table>
<p><strong>What happened?</strong> Women applied to more competitive departments (lower overall admission rates). The ‚Äúgender effect‚Äù was confounded by department choice.</p>
<p><em>This is exactly what our regression adjustment does‚Äîcompares within departments.</em></p>
</section>
<section id="confounding-in-clinical-research" class="slide level2">
<h2>Confounding in Clinical Research</h2>
<p><strong>A hypothetical clinical psychology example:</strong></p>
<p>Imagine a study finds that therapy clients who <strong>missed more sessions</strong> had <strong>worse outcomes</strong>. Conclusion: Attendance causes better outcomes‚Äîpush clients to attend!</p>
<p><strong>But what if researchers controlled for baseline severity‚Ä¶</strong></p>
<p>The effect might largely disappear. What could be happening?</p>
<ul>
<li>Clients with more severe symptoms might miss more sessions (too depressed to come)</li>
<li>Clients with more severe symptoms might have worse outcomes (harder to treat)</li>
<li>Severity would be confounding the attendance ‚Üí outcome relationship</li>
</ul>
<p><strong>This is exactly what our regression adjustment does‚Äîit asks: among clients with the same baseline severity, does attendance still predict outcomes?</strong></p>
</section>
<section id="why-this-matters-for-your-research" class="slide level2 content-light">
<h2>Why This Matters for Your Research</h2>
<p>Confounding can lead to:</p>
<table class="caption-top">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>False positives</strong></td>
<td>Concluding a treatment works when it doesn‚Äôt</td>
</tr>
<tr class="even">
<td><strong>Inflated effects</strong></td>
<td>Thinking an effect is larger than it really is</td>
</tr>
<tr class="odd">
<td><strong>Wrong recommendations</strong></td>
<td>Adopting an ineffective intervention</td>
</tr>
<tr class="even">
<td><strong>Wasted resources</strong></td>
<td>Investing in something that doesn‚Äôt help</td>
</tr>
</tbody>
</table>
<p><strong>Multiple regression helps:</strong> By ‚Äúholding constant‚Äù the confounding variable, we can get closer to the true effect.</p>
</section>
<section id="when-the-effect-disappears" class="slide level2 content-minimal">
<h2>When the Effect Disappears</h2>
<p>Sometimes, adjusting for a covariate makes an effect <strong>completely disappear</strong>.</p>
<p>Let‚Äôs see a dramatic example‚Ä¶</p>
</section>
<section id="section-3" class="slide level2" data-background-image="images/ai-image-5.png" data-background-size="cover">
<h2></h2>
<div class="overlay-text-bottom">
<p><strong>Scenario:</strong> Which training method produces better skills?</p>
</div>
</section>
<section id="training-methods-a-dramatic-example" class="slide level2 content-light">
<h2>Training Methods: A Dramatic Example</h2>
<p>A company wants to determine which of two training methods produces better employee skills. They randomly assigned 10 employees to either Method A or Method B, then measured skill test scores.</p>
<p><strong>The initial finding:</strong></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Observation</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Method B average</td>
<td><strong>26 points higher</strong> than Method A</td>
</tr>
<tr class="even">
<td>p-value</td>
<td>&lt; .001 (highly significant!)</td>
</tr>
</tbody>
</table>
<p><strong>The CEO is ready to switch all 2,000 new hires to Method B.</strong></p>
<div class="fragment">
<p>But wait‚Ä¶ Method B participants also had <strong>6 more years of experience</strong> on average.</p>
<p><strong>Is Method B actually better? Or are we just seeing an experience effect?</strong></p>
</div>
</section>
<section id="training-data" class="slide level2">
<h2>Training Data</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a>training_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/training_methods.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">employee_id</th>
<th style="text-align: left;">method</th>
<th style="text-align: right;">experience</th>
<th style="text-align: right;">test_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Aaron</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brenda</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chad</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">62</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diana</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Evan</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="even">
<td style="text-align: left;">Faye</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Grant</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Helen</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">88</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Isaac</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jenna</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">96</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Notice: Method A employees (Aaron through Evan) have 2-6 years experience, Method B employees (Faye through Jenna) have 8-12 years. The groups don‚Äôt overlap!</p>
<p><strong>Note:</strong> This is an extreme example to make the point crystal clear. In real data, groups usually overlap somewhat on the covariate‚Äîbut even partial differences can cause confounding.</p>
</section>
<section id="unadjusted-analysis" class="slide level2">
<h2>Unadjusted Analysis</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a>training_data <span class="ot">&lt;-</span> training_data <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">fct_relevel</span>(<span class="fu">as.factor</span>(method), <span class="st">"A"</span>))</span>
<span id="cb29-3"><a href=""></a></span>
<span id="cb29-4"><a href=""></a>lm_unadjusted <span class="ot">&lt;-</span> <span class="fu">lm</span>(test_score <span class="sc">~</span> method, <span class="at">data =</span> training_data)</span>
<span id="cb29-5"><a href=""></a><span class="fu">tidy</span>(lm_unadjusted)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">62.4</td>
<td style="text-align: right;">3.091925</td>
<td style="text-align: right;">20.181602</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">methodB</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">4.372642</td>
<td style="text-align: right;">5.946062</td>
<td style="text-align: right;">0.0003435</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Method B scores 26 points higher! p &lt; .001‚Äîvery significant!</p>
</section>
<section id="augment-the-unadjusted-training-model" class="slide level2">
<h2>Augment the Unadjusted Training Model</h2>
<p>Make predicted scores for each person/group</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a><span class="co"># Create augmented data with predictions and residuals</span></span>
<span id="cb30-2"><a href=""></a>training_unadj_augmented <span class="ot">&lt;-</span> <span class="fu">augment</span>(lm_unadjusted, <span class="at">data =</span> training_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell augment">
<div class="cell-output-display">
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">employee_id</th>
<th style="text-align: left;">method</th>
<th style="text-align: right;">experience</th>
<th style="text-align: right;">test_score</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Aaron</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">62.4</td>
<td style="text-align: right;">-8.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">6.482945</td>
<td style="text-align: right;">0.2306485</td>
<td style="text-align: right;">-1.3583771</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brenda</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">62.4</td>
<td style="text-align: right;">-6.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">6.878538</td>
<td style="text-align: right;">0.1338912</td>
<td style="text-align: right;">-1.0349540</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chad</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">62.4</td>
<td style="text-align: right;">-0.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">7.389181</td>
<td style="text-align: right;">0.0005230</td>
<td style="text-align: right;">-0.0646846</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diana</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">62.4</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">7.002040</td>
<td style="text-align: right;">0.1025105</td>
<td style="text-align: right;">0.9055847</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Evan</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">62.4</td>
<td style="text-align: right;">9.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">6.178303</td>
<td style="text-align: right;">0.3012552</td>
<td style="text-align: right;">1.5524309</td>
</tr>
<tr class="even">
<td style="text-align: left;">Faye</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">88.4</td>
<td style="text-align: right;">-8.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">6.482945</td>
<td style="text-align: right;">0.2306485</td>
<td style="text-align: right;">-1.3583771</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Grant</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">88.4</td>
<td style="text-align: right;">-2.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">7.321202</td>
<td style="text-align: right;">0.0188285</td>
<td style="text-align: right;">-0.3881077</td>
</tr>
<tr class="even">
<td style="text-align: left;">Helen</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">88.4</td>
<td style="text-align: right;">-0.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">7.389181</td>
<td style="text-align: right;">0.0005230</td>
<td style="text-align: right;">-0.0646846</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Isaac</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">88.4</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">7.232862</td>
<td style="text-align: right;">0.0423640</td>
<td style="text-align: right;">0.5821616</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jenna</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">88.4</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">6.656898</td>
<td style="text-align: right;">0.1888075</td>
<td style="text-align: right;">1.2290078</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="visualizing-the-unadjusted-training-model-code" class="slide level2" data-transition="none">
<h2>Visualizing the Unadjusted Training Model: Code</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="co"># Plot data points and predicted values</span></span>
<span id="cb31-2"><a href=""></a><span class="fu">ggplot</span>(training_unadj_augmented, <span class="fu">aes</span>(<span class="at">x =</span> method,</span>
<span id="cb31-3"><a href=""></a>                                      <span class="at">y =</span> test_score,</span>
<span id="cb31-4"><a href=""></a>                                      <span class="at">group =</span> method)) <span class="sc">+</span></span>
<span id="cb31-5"><a href=""></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href=""></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .fitted, <span class="at">ymax =</span> .fitted),</span>
<span id="cb31-7"><a href=""></a>                <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href=""></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Training Method"</span>, <span class="at">y =</span> <span class="st">"Test Score"</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href=""></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="plot-unadjusted-training-model" class="slide level2" data-transition="none">
<h2>Plot Unadjusted Training Model</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/training-unadj-augment-plot-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The lines show ≈∑ for each group‚ÄîMethod B looks 26 points higher!</p>
</section>
<section id="prediction-challenge" class="slide level2 content-light">
<h2>Prediction Challenge</h2>
<p>The unadjusted coefficient is 26 points (p &lt; .001). Method B participants have 6 more years of experience on average.</p>
<blockquote>
<p><strong>Before I show you the adjusted result, make a prediction:</strong></p>
</blockquote>
<p>üí¨ <strong>In the chat:</strong> Will the Method B coefficient go UP, DOWN, or STAY THE SAME when we add experience? And roughly by how much?</p>
<p>Take 30 seconds to commit to a prediction. I‚Äôll ask a few people to share their reasoning.</p>
</section>
<section id="adjusted-analysis" class="slide level2 size-85">
<h2>Adjusted Analysis</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a>lm_adjusted <span class="ot">&lt;-</span> <span class="fu">lm</span>(test_score <span class="sc">~</span> method <span class="sc">+</span> experience, <span class="at">data =</span> training_data)</span>
<span id="cb32-2"><a href=""></a><span class="fu">tidy</span>(lm_adjusted)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">45.2</td>
<td style="text-align: right;">1.341641</td>
<td style="text-align: right;">33.6900909</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">methodB</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">1.989975</td>
<td style="text-align: right;">0.1005038</td>
<td style="text-align: right;">0.9227624</td>
</tr>
<tr class="odd">
<td style="text-align: left;">experience</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">0.300000</td>
<td style="text-align: right;">14.3333333</td>
<td style="text-align: right;">0.0000019</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <strong>intercept</strong> (45.2) represents the predicted test score for employees trained with <strong>Method A</strong> (the reference group) who have zero years of experience.</p>
<p>The coefficient for <strong>experience</strong> (4.3) indicates that each additional year of <strong>experience</strong> was associated with a 4.3-point increase in test score, <em>holding method constant</em>. That is, for two people trained with the same method, a one-year difference in experience corresponds to a 4.3-point difference in predicted test score.</p>
<p>The coefficient for <strong>methodB</strong> (0.2) indicates that employees trained with <strong>Method B</strong> scored 0.2 points higher than those trained with Method A, <em>holding experience constant</em>. That is, for two people with the same experience level, the difference in predicted test score across the two methods is 0.2.</p>
<div class="fragment">
<p><strong>Notably, the adjusted method effect (0.2) is dramatically different from the unadjusted effect (26)‚Äîthe apparent advantage of Method B was entirely due to experience differences between groups!</strong></p>
</div>
</section>
<section id="comparing-unadjusted-and-adjusted-models-1" class="slide level2">
<h2>Comparing Unadjusted and Adjusted Models</h2>
<p><strong>Unadjusted</strong> (method only)</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">62.4</td>
<td style="text-align: right;">3.091925</td>
<td style="text-align: right;">20.181602</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">methodB</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">4.372642</td>
<td style="text-align: right;">5.946062</td>
<td style="text-align: right;">0.0003435</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Adjusted</strong> (method + experience)</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">45.2</td>
<td style="text-align: right;">1.341641</td>
<td style="text-align: right;">33.6900909</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">methodB</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">1.989975</td>
<td style="text-align: right;">0.1005038</td>
<td style="text-align: right;">0.9227624</td>
</tr>
<tr class="odd">
<td style="text-align: left;">experience</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">0.300000</td>
<td style="text-align: right;">14.3333333</td>
<td style="text-align: right;">0.0000019</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="augment-the-adjusted-training-model" class="slide level2">
<h2>Augment the Adjusted Training Model</h2>
<p>Make predicted scores for each person</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a><span class="co"># Create augmented data with predictions and residuals</span></span>
<span id="cb33-2"><a href=""></a>training_adj_augmented <span class="ot">&lt;-</span> <span class="fu">augment</span>(lm_adjusted, <span class="at">data =</span> training_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell augment">
<div class="cell-output-display">
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">employee_id</th>
<th style="text-align: left;">method</th>
<th style="text-align: right;">experience</th>
<th style="text-align: right;">test_score</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Aaron</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">53.8</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">1.445299</td>
<td style="text-align: right;">0.0082305</td>
<td style="text-align: right;">0.1924501</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brenda</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">58.1</td>
<td style="text-align: right;">-2.1</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">1.058301</td>
<td style="text-align: right;">0.3629630</td>
<td style="text-align: right;">-1.8073922</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chad</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">62.4</td>
<td style="text-align: right;">-0.4</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">1.437591</td>
<td style="text-align: right;">0.0092593</td>
<td style="text-align: right;">-0.3333333</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diana</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">66.7</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">1.313181</td>
<td style="text-align: right;">0.1390947</td>
<td style="text-align: right;">1.1188619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Evan</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">71.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">1.349897</td>
<td style="text-align: right;">0.2057613</td>
<td style="text-align: right;">0.9622504</td>
</tr>
<tr class="even">
<td style="text-align: left;">Faye</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">79.8</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">1.445299</td>
<td style="text-align: right;">0.0082305</td>
<td style="text-align: right;">0.1924501</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Grant</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">84.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">1.139201</td>
<td style="text-align: right;">0.2971193</td>
<td style="text-align: right;">1.6352596</td>
</tr>
<tr class="even">
<td style="text-align: left;">Helen</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">88.4</td>
<td style="text-align: right;">-0.4</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">1.437591</td>
<td style="text-align: right;">0.0092593</td>
<td style="text-align: right;">-0.3333333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Isaac</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">92.7</td>
<td style="text-align: right;">-0.7</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">1.411067</td>
<td style="text-align: right;">0.0403292</td>
<td style="text-align: right;">-0.6024641</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jenna</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">97.0</td>
<td style="text-align: right;">-1.0</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">1.349897</td>
<td style="text-align: right;">0.2057613</td>
<td style="text-align: right;">-0.9622504</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="visualizing-the-adjusted-training-model-code" class="slide level2" data-transition="none">
<h2>Visualizing the Adjusted Training Model: Code</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href=""></a><span class="co"># Plot data points and predicted values (parallel lines)</span></span>
<span id="cb34-2"><a href=""></a><span class="fu">ggplot</span>(training_adj_augmented, <span class="fu">aes</span>(<span class="at">x =</span> experience,</span>
<span id="cb34-3"><a href=""></a>                                    <span class="at">y =</span> test_score,</span>
<span id="cb34-4"><a href=""></a>                                    <span class="at">color =</span> method,</span>
<span id="cb34-5"><a href=""></a>                                    <span class="at">shape =</span> method)) <span class="sc">+</span></span>
<span id="cb34-6"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb34-8"><a href=""></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years of Experience"</span>, <span class="at">y =</span> <span class="st">"Test Score"</span>) <span class="sc">+</span></span>
<span id="cb34-9"><a href=""></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="plot-adjusted-training-model-1" class="slide level2" data-transition="none">
<h2>Plot Adjusted Training Model 1</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/training-adj-augment-plot-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The lines overlap‚Äîthere‚Äôs no vertical gap! The method effect disappears when we account for experience.</p>
</section>
<section id="plot-adjusted-training-model-2" class="slide level2 smaller" data-transition="none">
<h2>Plot Adjusted Training Model 2</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/training-adj-augment-plot-2-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
<h3 id="the-danger-of-extrapolation">The Danger of Extrapolation</h3>
<p>Notice that our groups don‚Äôt overlap at all! Method A employees <em>never</em> have more than 6 years of experience.</p>
<p>The model is <strong>guessing</strong> (extrapolating) what Method A employees would score if they had 10 years of experience based on the linear trend.</p>
<p><strong>Key Lesson:</strong> In real research, if groups have totally different backgrounds (no ‚Äúcommon support‚Äù), mathematical adjustment is risky. We are trusting the line extends perfectly straight into unknown territory.</p>
<ul>
<li><strong>Lack of Common Support:</strong> When there is no overlap in the predictor (Experience) between groups, the adjusted comparison is purely theoretical. We are relying entirely on the assumption that the lines remain parallel in the empty space.</li>
</ul>
</section>
<section id="plot-adjusted-training-model-3d" class="slide level2" data-transition="none">
<h2>Plot Adjusted Training Model (3D)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-bc37637b6038b705d7dc" style="width:768px;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-bc37637b6038b705d7dc">{"x":{"visdat":{"85c19ab1589":["function () ","plotlyVisDat"],"85c13f12da54":["function () ","data"],"85c16ebbe125":["function () ","data"],"85c170ba7cee":["function () ","data"],"85c163602713":["function () ","data"]},"cur_data":"85c163602713","attrs":{"85c13f12da54":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","marker":{"size":6,"color":"#F8766D"},"name":"A","inherit":true},"85c16ebbe125":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"lines","line":{"width":4,"color":"#F8766D"},"showlegend":false,"inherit":true},"85c170ba7cee":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","marker":{"size":6,"color":"#00BFC4","symbol":"diamond"},"name":"B","inherit":true},"85c163602713":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"lines","line":{"width":4,"color":"#00BFC4"},"showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Experience"},"yaxis":{"title":"Method","tickvals":[0,1],"ticktext":["A","B"]},"zaxis":{"title":"Test Score"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2,3,4,5,6],"y":[0,0,0,0,0],"z":[54,56,62,68,72],"type":"scatter3d","mode":"markers","marker":{"color":"#F8766D","size":6,"line":{"color":"rgba(31,119,180,1)"}},"name":"A","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[2,3,4,5,6],"y":[0,0,0,0,0],"z":[53.800000000000026,58.100000000000023,62.40000000000002,66.700000000000017,71.000000000000014],"type":"scatter3d","mode":"lines","line":{"color":"#F8766D","width":4},"showlegend":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[8,9,10,11,12],"y":[1,1,1,1,1],"z":[80,86,88,92,96],"type":"scatter3d","mode":"markers","marker":{"color":"#00BFC4","size":6,"symbol":"diamond","line":{"color":"rgba(44,160,44,1)"}},"name":"B","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[8,9,10,11,12],"y":[1,1,1,1,1],"z":[79.800000000000011,84.100000000000009,88.400000000000006,92.700000000000003,97],"type":"scatter3d","mode":"lines","line":{"color":"#00BFC4","width":4},"showlegend":false,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The two parallel lines from the 2D plot are now shown in 3D space. Notice how the lines overlap vertically‚Äîthere‚Äôs essentially no gap between methods when experience is accounted for.</p>
</section>
<section id="the-dramatic-comparison" class="slide level2">
<h2>The Dramatic Comparison</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 30%">
<col style="width: 26%">
<col style="width: 10%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Analysis</th>
<th style="text-align: right;">Method B Coefficient</th>
<th style="text-align: left;">p-value</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Unadjusted</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: left;">&lt; .001</td>
<td style="text-align: left;">Method B is much better!</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adjusted for experience</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">= .92</td>
<td style="text-align: left;">No meaningful difference</td>
</tr>
</tbody>
</table>
</div>
</div>
<blockquote>
<p><strong>The apparent effect completely disappears!</strong></p>
</blockquote>
</section>
<section id="why-this-happened-aaron-vs.-jenna" class="slide level2">
<h2>Why This Happened: Aaron vs.&nbsp;Jenna</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Employee</th>
<th>Method</th>
<th>Experience</th>
<th>Test Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Aaron</td>
<td>A</td>
<td>2 years</td>
<td>54</td>
</tr>
<tr class="even">
<td>Jenna</td>
<td>B</td>
<td>12 years</td>
<td>96</td>
</tr>
<tr class="odd">
<td><strong>Difference</strong></td>
<td></td>
<td><strong>10 years!</strong></td>
<td><strong>42 points</strong></td>
</tr>
</tbody>
</table>
<p>Is Jenna‚Äôs higher score due to Method B‚Äîor her 10 extra years of experience?</p>
<p><strong>The adjusted analysis says:</strong> There‚Äôs approximately zero difference between methods when we account for experience.</p>
</section>
<section id="confounding-summary" class="slide level2 content-light">
<h2>‚úì Confounding: Summary</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>What Happened</th>
<th>Training Methods Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Unadjusted result</td>
<td>Method B scored 26 points higher (p &lt; .001)</td>
</tr>
<tr class="even">
<td>Hidden difference</td>
<td>Method B had 6 more years experience</td>
</tr>
<tr class="odd">
<td>Adjusted result</td>
<td>Method B scored 0.4 points higher (p = .92)</td>
</tr>
<tr class="even">
<td>Conclusion</td>
<td>Experience was the real cause, not the method</td>
</tr>
</tbody>
</table>
<p><strong>The ‚Äúeffect‚Äù was an illusion created by the confound.</strong></p>
<p>üëÄ <strong>Take a moment:</strong> Look at those two numbers. A ‚Äúhighly significant‚Äù result (p &lt; .001) became completely non-significant (p = .92).</p>
<p>This is why understanding confounding matters for your research.</p>
</section>
<section id="additional-statistics-training-models-1" class="slide level2">
<h2>Additional Statistics: Training Models 1</h2>
<p><strong>R¬≤ from glance() for both models:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="fu">glance</span>(lm_unadjusted)  <span class="co"># Unadjusted model</span></span>
<span id="cb35-2"><a href=""></a><span class="fu">glance</span>(lm_adjusted)    <span class="co"># Adjusted model</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Unadjusted</td>
<td style="text-align: right;">0.8154796</td>
<td style="text-align: right;">0.7924146</td>
<td style="text-align: right;">0.0003435</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adjusted</td>
<td style="text-align: right;">0.9939201</td>
<td style="text-align: right;">0.9921830</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="additional-statistics-training-models-2" class="slide level2">
<h2>Additional Statistics: Training Models 2</h2>
<p><strong>95% Confidence Intervals for R¬≤ using MBESS: Unadjusted</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="fu">library</span>(MBESS)</span>
<span id="cb36-2"><a href=""></a></span>
<span id="cb36-3"><a href=""></a><span class="co"># For unadjusted model: df.1 = number of predictors, df.2 = residual df</span></span>
<span id="cb36-4"><a href=""></a><span class="fu">ci.R2</span>(<span class="at">R2 =</span> <span class="fu">glance</span>(lm_unadjusted)<span class="sc">$</span>r.squared,</span>
<span id="cb36-5"><a href=""></a>      <span class="at">df.1 =</span> <span class="dv">1</span>,   <span class="co"># 1 predictor (method)</span></span>
<span id="cb36-6"><a href=""></a>      <span class="at">df.2 =</span> <span class="fu">glance</span>(lm_unadjusted)<span class="sc">$</span>df.residual,</span>
<span id="cb36-7"><a href=""></a>      <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb36-8"><a href=""></a>      <span class="at">Random.Predictors =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Lower.Conf.Limit.R2
[1] 0.37061

$Prob.Less.Lower
[1] 0.025

$Upper.Conf.Limit.R2
[1] 0.8975077

$Prob.Greater.Upper
[1] 0.025</code></pre>
</div>
</div>
</section>
<section id="additional-statistics-training-models-3" class="slide level2">
<h2>Additional Statistics: Training Models 3</h2>
<p><strong>95% Confidence Intervals for R¬≤ using MBESS: Adjusted</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a><span class="co"># For adjusted model: 2 predictors (method + experience)</span></span>
<span id="cb38-2"><a href=""></a><span class="fu">ci.R2</span>(<span class="at">R2 =</span> <span class="fu">glance</span>(lm_adjusted)<span class="sc">$</span>r.squared,</span>
<span id="cb38-3"><a href=""></a>      <span class="at">df.1 =</span> <span class="dv">2</span>,   <span class="co"># 2 predictors</span></span>
<span id="cb38-4"><a href=""></a>      <span class="at">df.2 =</span> <span class="fu">glance</span>(lm_adjusted)<span class="sc">$</span>df.residual,</span>
<span id="cb38-5"><a href=""></a>      <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb38-6"><a href=""></a>      <span class="at">Random.Predictors =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Lower.Conf.Limit.R2
[1] 0.9644109

$Prob.Less.Lower
[1] 0.025

$Upper.Conf.Limit.R2
[1] 0.9962074

$Prob.Greater.Upper
[1] 0.025</code></pre>
</div>
</div>
</section>
<section id="additional-statistics-training-models-4" class="slide level2">
<h2>Additional Statistics: Training Models 4</h2>
<p><strong>Cohen‚Äôs d for unadjusted comparison:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a><span class="fu">library</span>(effsize)</span>
<span id="cb40-2"><a href=""></a><span class="fu">cohen.d</span>(test_score <span class="sc">~</span> method, <span class="at">data =</span> training_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cohen's d

d estimate: -3.76062 (large)
95 percent confidence interval:
    lower     upper 
-6.186984 -1.334255 </code></pre>
</div>
</div>
</section>
<section id="additional-statistics-training-models-5" class="slide level2">
<h2>Additional Statistics: Training Models 5</h2>
<p><strong>Partial Eta Squared for both models:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="fu">library</span>(effectsize)</span>
<span id="cb42-2"><a href=""></a><span class="co"># Unadjusted model (method only)</span></span>
<span id="cb42-3"><a href=""></a><span class="fu">eta_squared</span>(lm_unadjusted, <span class="at">partial =</span> <span class="cn">TRUE</span>, <span class="at">ci =</span> <span class="fl">0.90</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Eta2 |       90% CI
-------------------------------
method    | 0.82 | [0.61, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a><span class="co"># Adjusted model (method + experience)</span></span>
<span id="cb44-2"><a href=""></a><span class="fu">eta_squared</span>(lm_adjusted, <span class="at">partial =</span> <span class="cn">TRUE</span>, <span class="at">ci =</span> <span class="fl">0.90</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter  | Eta2 (partial) |       90% CI
------------------------------------------
method     |           0.99 | [0.98, 1.00]
experience |           0.97 | [0.92, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
</section>
<section id="additional-statistics-training-models-6" class="slide level2 smaller">
<h2>Additional Statistics: Training Models 6</h2>
<p><strong>Descriptive Statistics by Method:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a>training_data <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href=""></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href=""></a>  <span class="fu">summarize</span>(<span class="at">mean_test_score =</span> <span class="fu">mean</span>(test_score),</span>
<span id="cb46-4"><a href=""></a>            <span class="at">sd_test_score =</span> <span class="fu">sd</span>(test_score),</span>
<span id="cb46-5"><a href=""></a>            <span class="at">mean_experience =</span> <span class="fu">mean</span>(experience),</span>
<span id="cb46-6"><a href=""></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">method</th>
<th style="text-align: right;">mean_test_score</th>
<th style="text-align: right;">sd_test_score</th>
<th style="text-align: right;">mean_experience</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">62.4</td>
<td style="text-align: right;">7.668116</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">88.4</td>
<td style="text-align: right;">6.066300</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="results-paragraph-training-methods-1" class="slide level2 results-paragraph">
<h2>Results Paragraph: Training Methods 1</h2>
<p>We examined whether Training Method B improved test scores compared to Method A (<em>N</em> = 10; Method A <em>n</em> = 5, Method B <em>n</em> = 5). We conducted two analyses: an unadjusted analysis comparing methods directly, and an adjusted analysis accounting for employees‚Äô years of experience.</p>
</section>
<section id="results-paragraph-training-methods-2" class="slide level2 results-paragraph">
<h2>Results Paragraph: Training Methods 2</h2>
<p><strong>The Confound: Experience</strong></p>
<p>Before interpreting the method comparison, we must consider a potential confound. Method B participants had substantially more experience (<em>M</em> = 10 years) compared to Method A participants (<em>M</em> = 4 years). Because experience likely improves test performance‚Äîand more experienced employees were concentrated in Method B‚Äîany direct comparison of test scores would be biased in favor of Method B.</p>
</section>
<section id="results-paragraph-training-methods-3" class="slide level2 results-paragraph">
<h2>Results Paragraph: Training Methods 3</h2>
<p><strong>Unadjusted Analysis</strong></p>
<p>We first compared methods without controlling for experience. The regression coefficient (<em>b</em>) represents the difference in mean test scores between Method B and Method A (the reference group). Method A participants had a mean test score of 62.4 (<em>SD</em> = 7.67), while Method B participants had a mean of 88.4 (<em>SD</em> = 6.07).</p>
<p>The coefficient for method was <em>b</em> = 26, 95% CI [15.92, 36.08], <em>p</em> &lt; .001, indicating that Method B participants scored 26 points higher than Method A participants, <em>d</em> = 3.76, <span class="math inline">\(\eta^2_p\)</span> = 0.82, 90% CI [0.9, 0.61]; see Table 1. The model explained 81.5% of variance in test scores, <em>R</em>¬≤ = 0.82, 95% CI [0.37, 0.9].</p>
<p>Based on this unadjusted analysis alone, we would conclude that Method B is dramatically more effective than Method A.</p>
</section>
<section id="results-paragraph-training-methods-4" class="slide level2 results-paragraph">
<h2>Results Paragraph: Training Methods 4</h2>
<p><strong>Adjusted Analysis</strong></p>
<p>To account for the confound, we added experience to the model. In this adjusted analysis, the coefficient for method represents the difference in mean test scores between Method B and Method A <em>for employees with the same years of experience</em>.</p>
<p>After controlling for experience, the coefficient for method was <em>b</em> = 0.2, 95% CI [-4.51, 4.91], <em>p</em> = .923, <span class="math inline">\(\eta^2_p\)</span> = 0.99, 90% CI [0.9, 0.98]; see Table 2. This indicates that Method B participants scored only 0.2 points higher than Method A participants <em>who had the same experience level</em>‚Äîa difference that was not statistically significant. The adjusted model explained 99.4% of variance, <em>R</em>¬≤ = 0.99, 95% CI [0.96, 1].</p>
</section>
<section id="results-paragraph-training-methods-5" class="slide level2 results-paragraph">
<h2>Results Paragraph: Training Methods 5</h2>
<p><strong>Comparing Unadjusted and Adjusted Analyses</strong></p>
<p>The unadjusted and adjusted analyses tell strikingly different stories. In the unadjusted analysis, the method coefficient was <em>b</em> = 26, 95% CI [15.92, 36.08], suggesting Method B was associated with dramatically higher test scores. After adjusting for experience, the coefficient dropped to <em>b</em> = 0.2, 95% CI [-4.51, 4.91]‚Äîa change of 25.8 points.</p>
<p>This change occurred because Method B employees had substantially more experience (10 vs.&nbsp;4 years). The unadjusted comparison confounded the method effect with the experience effect. When we statistically held experience constant, the estimated method effect was essentially zero, <span class="math inline">\(\eta^2_p\)</span> = 0.99, 90% CI [0.9, 0.98].</p>
</section>
<section id="results-paragraph-training-methods-6" class="slide level2 results-paragraph">
<h2>Results Paragraph: Training Methods 6</h2>
<p><strong>Conclusion.</strong> After controlling for experience, Method B showed no detectable advantage over Method A. The apparent superiority of Method B in the unadjusted analysis appears to be explained by experience differences between groups rather than the training method itself. However, because employees were not randomly assigned to training methods, we cannot rule out other unmeasured factors that may differ between groups.</p>
</section>
<section id="polling-question-6-confounding" class="slide level2 content-light">
<h2>Polling Question 6: Confounding</h2>
<blockquote>
<p>Why did the Method B coefficient change from 26 to 0?</p>
</blockquote>
<ul>
<li><ol type="A">
<li>There was a calculation error</li>
</ol></li>
<li><ol start="2" type="A">
<li>The groups differed on experience, which was the real cause of the outcome difference</li>
</ol></li>
<li><ol start="3" type="A">
<li>Method B actually made performance worse</li>
</ol></li>
<li><ol start="4" type="A">
<li>The sample size was too small</li>
</ol></li>
</ul>
</section>
<section id="polling-question-6-answer" class="slide level2 content-light">
<h2>Polling Question 6: Answer</h2>
<p><strong>Correct answer: B) The groups differed on experience, which was the real cause of the outcome difference</strong></p>
<p>This reinforces the confounding lesson:</p>
<ul>
<li>The unadjusted coefficient (26) mixed the method effect with the experience effect</li>
<li>When we ‚Äúheld experience constant,‚Äù only the method effect remained</li>
<li>That remaining effect was essentially zero (0.4, p = .92)</li>
<li><strong>Conclusion:</strong> Experience was doing all the work; the training method didn‚Äôt matter</li>
</ul>
</section>
<section id="part-7-confounding-and-solutions" class="slide level2 section-header" data-background="linear-gradient(135deg, #005389 0%, #0067A1 50%, #0078AF 100%)">
<h2>Part 7: Confounding and Solutions</h2>
</section>
<section id="how-confounding-works" class="slide level2 size-85" data-transition="none">
<h2>How Confounding Works</h2>
<p>Remember the <strong>confounder</strong> diagram from our multiple regression lecture?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/confounding-diagram-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>X</strong> = Training Method (predictor) | <strong>C</strong> = Experience (confounder) | <strong>Y</strong> = Test Score (outcome)</p>
<p>The red arrows show the <strong>back door path</strong>: Experience caused both the training assignment AND test scores‚Äîmaking it <em>look</em> like Method B worked better.</p>
<p><strong>Controlling for Experience closes this back door</strong>, revealing the true direct effect (which was zero!).</p>
</section>
<section id="common-question-is-this-mediation" class="slide level2">
<h2>Common Question: Is this Mediation?</h2>
<p><strong>Student Question:</strong> ‚ÄúExperience predicts the program choice AND the outcome. Is experience a <strong>mediator</strong>? Did the program <em>cause</em> them to get more experience?‚Äù</p>
<p><strong>Answer:</strong> No.</p>
<ul>
<li><strong>Mediator:</strong> The treatment causes the intermediate variable (Program <span class="math inline">\(\rightarrow\)</span> Experience <span class="math inline">\(\rightarrow\)</span> Outcome).</li>
<li><strong>Confounder:</strong> The variable existed <em>before</em> the treatment selection.</li>
</ul>
<p><em>In this example, Method B employees had 12 years of experience <strong>before</strong> they ever started the training. Therefore, it is a confounder.</em></p>
</section>
<section id="challenge-spot-the-confound" class="slide level2">
<h2>Challenge: Spot the Confound</h2>
<p><strong>Scenario:</strong> A study finds that coffee drinkers have higher rates of heart disease than non-coffee drinkers. The researchers conclude coffee causes heart disease.</p>
<ol type="1">
<li><p>What‚Äôs a potential confounding variable? (Hint: What else might differ between coffee drinkers and non-drinkers?)</p></li>
<li><p>Draw a simple diagram like the one we just saw:</p>
<ul>
<li>Box 1: Coffee drinking</li>
<li>Box 2: Heart disease</li>
<li>Box 3: Your confound</li>
<li>Draw arrows showing the relationships</li>
</ul></li>
<li><p>If we ‚Äúheld constant‚Äù your confound, what might happen to the coffee ‚Üí heart disease relationship?</p></li>
</ol>
</section>
<section id="the-hidden-threat-unmeasured-confounds" class="slide level2">
<h2>The Hidden Threat: Unmeasured Confounds</h2>
<p>We adjusted for <strong>experience</strong> and the effect disappeared. Problem solved?</p>
<p>Not quite. Without random assignment, there‚Äôs always a lurking question:</p>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>What else might differ between groups?</strong></p>
</div>
<div class="callout-content">
<p>In our training study, Method B employees had more experience. But what if they also differed in:</p>
<ul>
<li><strong>Motivation</strong> (maybe more motivated employees chose Method B)</li>
<li><strong>Prior training</strong> (maybe they had better foundational skills)</li>
<li><strong>Manager quality</strong> (maybe better managers recommended Method B)</li>
</ul>
<p>We didn‚Äôt measure these variables‚Äîso we can‚Äôt adjust for them.</p>
</div>
</div>
</div>
<p><strong>The uncomfortable truth:</strong> With observational data, we can only control for confounds we <em>thought to measure</em>. Unknown confounds remain hidden, silently biasing our results.</p>
<p>This is why <strong>random assignment</strong> is considered the gold standard: unlike statistical adjustment, it has the <em>potential</em> to balance even unmeasured confounds. But as we‚Äôll see shortly, this theoretical advantage has important limitations in practice.</p>
</section>
<section id="how-randomization-is-supposed-to-help-1" class="slide level2 content-light" data-transition="none">
<h2>How Randomization Is <em>Supposed</em> to Help 1</h2>
<p>In a <strong>randomized experiment</strong>, we flip a coin to assign people to groups.</p>
<p>The <em>idea</em> is:</p>
<ul>
<li>Experienced people are equally likely to be in Method A or B</li>
<li>Education levels are balanced across groups</li>
<li>ALL potential confounders (even ones we didn‚Äôt measure) are balanced</li>
</ul>
</section>
<section id="how-randomization-is-supposed-to-help-2" class="slide level2 content-light" data-transition="none">
<h2>How Randomization Is <em>Supposed</em> to Help 2</h2>
<p><strong>In theory:</strong> The unadjusted comparison IS the fair comparison, because randomization ‚Äúcloses the back doors‚Äù for us.</p>
<p>This is why randomized controlled trials (RCTs) are considered the gold standard for causal inference. But there are complications with randomization.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/randomization-balance-visual-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="but-waitdoes-randomization-really-work" class="slide level2 content-light">
<h2>But Wait‚ÄîDoes Randomization Really Work?</h2>
<p><strong>Common Assumption:</strong> Random assignment removes the effects of confounding variables</p>
<div class="fragment">
<p><strong>The Reality:</strong> Randomization guarantees balance <em>in expectation</em> (across infinite replications), not for any single study. It may be true on average over infinite studies, but it‚Äôs unlikely to be true in <em>your</em> study.</p>
</div>
<div class="fragment">
<p><strong>Key Finding:</strong> Nguyen et al.&nbsp;(2017) reanalyzed two large clinical trials and found that simple randomization only reliably balanced covariates when N ‚â• 1,000 <em>total</em> (approximately 500 per group)</p>
</div>
<div class="fragment">
<blockquote>
<p>‚ÄúConclusions drawn from completely randomized trials enrolling a few participants may not be reliable.‚Äù</p>
<p>‚Äî Nguyen et al.&nbsp;(2017), <em>Journal of Clinical Epidemiology</em></p>
</blockquote>
</div>
</section>
<section id="the-mathematics-of-chance-imbalance" class="slide level2">
<h2>The Mathematics of Chance Imbalance</h2>
<p>When you randomly assign <em>n</em> participants to each of two groups, the standardized mean difference (SMD) on any covariate has:</p>
<ul>
<li><strong>Expected value:</strong> 0</li>
<li><strong>Standard error:</strong> <span class="math inline">\(SE = \sqrt{\frac{2}{n}}\)</span></li>
</ul>
<div class="fragment">
<table class="caption-top">
<thead>
<tr class="header">
<th>n per group</th>
<th>Total N</th>
<th>SE of SMD</th>
<th>95% CI for SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>30</td>
<td>60</td>
<td>0.258</td>
<td>¬±0.506</td>
</tr>
<tr class="even">
<td>50</td>
<td>100</td>
<td>0.200</td>
<td>¬±0.392</td>
</tr>
<tr class="odd">
<td>100</td>
<td>200</td>
<td>0.141</td>
<td>¬±0.277</td>
</tr>
<tr class="even">
<td>500</td>
<td>1000</td>
<td>0.063</td>
<td>¬±0.124</td>
</tr>
<tr class="odd">
<td>1000</td>
<td>2000</td>
<td>0.045</td>
<td>¬±0.088</td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<p><strong>Interpretation:</strong> With n = 30 per group, an SMD of ¬±0.5 (a ‚Äúmedium‚Äù effect) can occur purely by chance</p>
</div>
<div class="fragment">
<p><strong>And it gets worse‚Ä¶</strong> This is for just <em>one</em> covariate. Real studies have many.</p>
</div>
</section>
<section id="the-multiple-covariate-problem" class="slide level2">
<h2>The Multiple Covariate Problem</h2>
<p>That last table showed chance imbalance for a <em>single</em> covariate. But real studies measure many potential confounds.</p>
<p><strong>Critical insight:</strong> The probability of balancing <em>all</em> covariates drops rapidly</p>
<p><span class="math display">\[P(\text{all covariates balanced}) \approx P(\text{one balanced})^k\]</span></p>
<p>where <em>k</em> = the number of covariates you need to balance</p>
<div class="fragment">
<p><strong>Probability that ALL k covariates are balanced (|SMD| &lt; 0.10):</strong></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>n per group</th>
<th>Total N</th>
<th>k = 5</th>
<th>k = 10</th>
<th>k = 15</th>
<th>k = 20</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>30</td>
<td>60</td>
<td>0.3%</td>
<td>&lt;0.1%</td>
<td>&lt;0.1%</td>
<td>&lt;0.1%</td>
</tr>
<tr class="even">
<td>50</td>
<td>100</td>
<td>0.8%</td>
<td>&lt;0.1%</td>
<td>&lt;0.1%</td>
<td>&lt;0.1%</td>
</tr>
<tr class="odd">
<td>100</td>
<td>200</td>
<td>3.8%</td>
<td>0.1%</td>
<td>&lt;0.1%</td>
<td>&lt;0.1%</td>
</tr>
<tr class="even">
<td>250</td>
<td>500</td>
<td>21.8%</td>
<td>4.8%</td>
<td>1.0%</td>
<td>0.2%</td>
</tr>
<tr class="odd">
<td>500</td>
<td>1000</td>
<td>54.5%</td>
<td>29.7%</td>
<td>16.2%</td>
<td>8.8%</td>
</tr>
<tr class="even">
<td>1000</td>
<td>2000</td>
<td>88.1%</td>
<td>77.6%</td>
<td>68.4%</td>
<td>60.3%</td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<p><strong>Example:</strong> With 10 covariates and n = 100 per group, there‚Äôs only a 0.1% chance that ALL covariates are balanced</p>
</div>
</section>
<section id="the-multiple-covariate-problem-visualized" class="slide level2" data-transition="none">
<h2>The Multiple Covariate Problem: Visualized</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/covariate-heatmap-1.png" class="quarto-figure quarto-figure-center" width="864"></p>
</figure>
</div>
</div>
</div>
<p>The ‚Äúsea of red‚Äù shows why simple randomization fails in typical psychology studies: with multiple covariates and modest sample sizes, achieving balance on ALL variables is nearly impossible by chance alone.</p>
</section>
<section id="practical-solutions-design-phase" class="slide level2 content-light">
<h2>Practical Solutions: Design Phase</h2>
<p><strong>Restricted randomization</strong> = any procedure that constrains random assignment to improve covariate balance while preserving the benefits of randomization</p>
<div class="fragment">
<p><strong>Common methods:</strong></p>
<ul>
<li><strong>Block randomization:</strong> Create blocks based on key covariates (e.g., gender), then randomize <em>within</em> blocks</li>
<li><strong>Stratified randomization:</strong> Extend blocking to multiple covariates simultaneously</li>
<li><strong>Minimization:</strong> Sequentially assign participants to the group that minimizes overall imbalance</li>
<li><strong>Rerandomization:</strong> Generate a random assignment, check balance, and re-randomize if a balance criterion is not met</li>
</ul>
</div>
</section>
<section id="practical-solutions-analysis-phase" class="slide level2 content-light">
<h2>Practical Solutions: Analysis Phase</h2>
<p><strong>Include potential confounds as covariates in your analysis model (ANCOVA)</strong></p>
<div class="fragment">
<p><strong>Important limitations:</strong></p>
<ul>
<li>Less ideal than achieving balance at the design phase</li>
<li>Assumes homogeneity of regression slopes</li>
<li>Should be pre-registered to avoid analytic flexibility</li>
</ul>
</div>
</section>
<section id="key-takeaways-randomization-and-confounding" class="slide level2 content-light">
<h2>Key Takeaways: Randomization and Confounding</h2>
<div title="For Your Thesis/Dissertation Research">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>For Your Thesis/Dissertation Research</strong></p>
</div>
<div class="callout-content">
<ol type="1">
<li><p><strong>Simple randomization is not enough</strong> for typical psychology studies (small <em>n</em>, multiple potential confounds)</p></li>
<li><p><strong>At the design phase:</strong> Use restricted randomization (blocking, stratification, minimization) to ensure balance on key covariates</p></li>
<li><p><strong>At the analysis phase:</strong> Pre-register planned covariate adjustments (ANCOVA) for variables you couldn‚Äôt balance by design</p></li>
<li><p><strong>For observational studies:</strong> Covariate adjustment is essential, but remember you can only control for confounds you measured</p></li>
</ol>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><strong>The bottom line:</strong> Whether your study is experimental or observational, thinking carefully about confounding variables‚Äîand planning how to address them‚Äîshould be standard practice, not an afterthought.</p>
</div>
</section>
<section id="references-randomization-and-balance" class="slide level2 content-light smaller">
<h2>References: Randomization and Balance</h2>
<p>Kang, M., Ragan, B. G., &amp; Park, J. H. (2008). Issues in outcomes research: An overview of randomization techniques for clinical trials. <em>Journal of Athletic Training, 43</em>(2), 215‚Äì221.</p>
<p>Morgan, K. L., &amp; Rubin, D. B. (2012). Rerandomization to improve covariate balance in experiments. <em>Annals of Statistics, 40</em>(2), 1263‚Äì1282.</p>
<p>Nguyen, T. L., Collins, G. S., Lamy, A., Devereaux, P. J., Daur√®s, J. P., Landais, P., &amp; Le Manach, Y. (2017). Simple randomization did not protect against bias in smaller trials. <em>Journal of Clinical Epidemiology, 84</em>, 105‚Äì113.</p>
</section>
<section id="key-takeaway" class="slide level2">
<h2>Key Takeaway</h2>
<blockquote>
<p><strong>Including relevant covariates can DRAMATICALLY change conclusions about group differences.</strong></p>
</blockquote>
<p>This is why we:</p>
<ol type="1">
<li>Think carefully about potential confounds BEFORE analyzing data</li>
<li>Report both unadjusted and adjusted analyses</li>
<li>Interpret coefficients correctly (‚Äúholding constant‚Äù)</li>
<li>Are cautious about causal claims from observational data</li>
</ol>
<p><strong>Important caveat:</strong> Statistical adjustment doesn‚Äôt prove causation. There may be unmeasured confounders we haven‚Äôt accounted for. The adjusted effect estimates what the difference <em>would be</em> if groups were equal on the covariate‚Äîit doesn‚Äôt guarantee that‚Äôs the true causal effect.</p>
</section>
<section id="part-8-a-clinical-example" class="slide level2 section-header" data-background="linear-gradient(135deg, #5E1A99 0%, #7231B2 50%, #814FBC 100%)">
<h2>Part 8: A Clinical Example</h2>
</section>
<section id="section-4" class="slide level2" data-background-image="images/ai-image-therapy-triptych.webp" data-background-size="cover">
<h2></h2>
<div class="overlay-text-bottom">
<p><strong>Scenario:</strong> Is our new therapy app as effective as traditional therapy?</p>
</div>
</section>
<section id="the-telehealth-question" class="slide level2 content-light">
<h2>The Telehealth Question</h2>
<p>A clinic wants to know: <strong>Is our new therapy app as effective as traditional therapy for anxiety?</strong></p>
<p>They compare three delivery formats for GAD treatment:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Format</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>In-person</td>
<td>Traditional face-to-face therapy</td>
</tr>
<tr class="even">
<td>Telehealth</td>
<td>Synchronous video sessions</td>
</tr>
<tr class="odd">
<td>App</td>
<td>Self-guided with minimal therapist contact</td>
</tr>
</tbody>
</table>
<p><strong>Outcome:</strong> Post-treatment GAD-7 scores (lower = less anxiety)</p>
</section>
<section id="part-9-summary" class="slide level2 section-header" data-background="linear-gradient(135deg, #8B006E 0%, #A40085 50%, #B32F94 100%)">
<h2>Part 9: Summary</h2>
</section>
<section id="the-big-picture-how-it-all-connects" class="slide level2" data-transition="none">
<h2>The Big Picture: How It All Connects</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg-cat-part2_files/figure-revealjs/concept-map-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="key-takeaways" class="slide level2">
<h2>Key Takeaways</h2>
<table class="caption-top">
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th>#</th>
<th>Takeaway</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>≈∑ is an estimate of the mean y for people with those predictor values</td>
</tr>
<tr class="even">
<td>2</td>
<td>Categorical predictors require contrast coding (treatment coding uses 0s and 1s)</td>
</tr>
<tr class="odd">
<td>3</td>
<td>The intercept = predicted ≈∑ when all predictors = 0 (for categorical: the reference group mean)</td>
</tr>
<tr class="even">
<td>4</td>
<td>Think horizontally to understand predicted scores</td>
</tr>
<tr class="odd">
<td>5</td>
<td>‚ÄúHolding constant‚Äù fundamentally changes what the coefficient means</td>
</tr>
<tr class="even">
<td>6</td>
<td>Coefficients can change dramatically when covariates are added (confounding)</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Use APA 7 format and write accessible results sections</td>
</tr>
</tbody>
</table>
</section>
<section id="assumptions-note" class="slide level2">
<h2>Assumptions Note</h2>
<p>What we assumed today:</p>
<ul>
<li>Parallel regression lines (no interaction between predictors)</li>
<li>Linearity (relationship between continuous predictor and outcome is linear)</li>
<li>Other standard regression assumptions (normality of residuals, etc.)</li>
<li>Adequate sample size for stable estimates</li>
</ul>
<p>We‚Äôll cover regression diagnostics and what to do when assumptions are violated in a future lecture.</p>
</section>
<section id="final-thought" class="slide level2 content-minimal">
<h2>Final Thought</h2>
<p>Remember our opening question about the onboarding program?</p>
<blockquote>
<p>The new-program group scored higher. Case closed?</p>
</blockquote>
<p><strong>Now you can answer:</strong> ‚ÄúNot so fast‚Äîwhat else differs between the groups?‚Äù</p>
<p>That question‚Äîand the tools to answer it‚Äîis what you learned today.</p>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="reg-cat-part2_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="reg-cat-part2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="reg-cat-part2_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="reg-cat-part2_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="reg-cat-part2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="reg-cat-part2_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="reg-cat-part2_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="reg-cat-part2_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="reg-cat-part2_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="reg-cat-part2_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
multiplex: {
  secret: null,
  id: '350487c243bd086167828e2f3e09a7baa9fe1073c803d07501db9dcd3c7e3bab',
  url: 'https://multiplex.up.railway.app/'
},
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1024,

        height: 768,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ],
        dependencies: [
          { src: 'https://multiplex.up.railway.app/socket.io/socket.io.js', async: true },
          { src: 'https://multiplex.up.railway.app/client.js', async: true }
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>